;function CustomSearch($searchInput,params){this.$input=$searchInput;this.searchUrl=params.searchUrl;this.logUrl=params.logUrl;this.rootDomain=params.rootDomain;this.minSearchChars=2;this.defaultTitle=params.searchTitle;this.maxResults=12;this.userQuery="";this.sugesstion=null;this.redirectUrl=null;this.type=null;this.$button=$(params.searchButton);this.$containerSearch=this.$input.closest(params.containerSearch);this.isActive=false;this.autocompleXHR=null;this.container=params.container;this.ga=this.container.get("ga");this.transformers=[];this.setTitle();this.initAutoComplete();this.attachListeners();var self=this;this.addTransformer(function(data){return self.restrictMaxResults(data)})}CustomSearch.prototype.addTransformer=function(callback){this.transformers.push(callback)};CustomSearch.prototype.saveSearchQuery=function(){jQuery.ajax(this.logUrl,{type:"GET",dataType:"jsonp",data:{query:this.userQuery,sugesstion:this.sugesstion,url:this.redirectUrl}})};CustomSearch.prototype.setTitle=function(){this.$input.val(this.defaultTitle)};CustomSearch.prototype.attachListeners=function(){this.enterPressedListener();this.searchButtonListener();this.searchFocusListener()};CustomSearch.prototype.enterPressedListener=function(){this.$input.on("keydown",this.keyDownResolver.bind(this))};CustomSearch.prototype.keyDownResolver=function(event){if(event.which==13){this.doSearch()}};CustomSearch.prototype.doSearch=function(){this.userQuery=this.$input.val();this.saveSearchQuery();this.search(this.userQuery)};CustomSearch.prototype.searchFocusListener=function(){this.$input.on({focusin:this.openSearchInput.bind(this),focusout:this.closeSearchInput.bind(this)})};CustomSearch.prototype.searchButtonListener=function(){this.$button.on("click",this.resolveSearchButtonAction.bind(this))};CustomSearch.prototype.resolveSearchButtonAction=function(){if(!this.userQuery){this.$input.focus()}if(this.userQuery){this.doSearch()}};CustomSearch.prototype.getAutocompleteData=function(request,response){if(this.autocompleXHR){this.autocompleXHR.abort()}this.autocompleXHR=jQuery.getJSON(this.searchUrl,{query:request.term}).always(function(dataOrXhr,statusText,xhrOrError){var data=statusText==="success"?dataOrXhr:[];this.autocompleXHR=null;response(this.transformResponseData(data))}.bind(this))};CustomSearch.prototype.transformResponseData=function(data){for(var key in this.transformers){if(this.transformers.hasOwnProperty(key)){data=this.transformers[key](data)}}return data};CustomSearch.prototype.restrictMaxResults=function(data){return data.slice(0,this.maxResults)};CustomSearch.prototype.initAutoComplete=function(){this.$input.autocomplete({source:this.getAutocompleteData.bind(this),minLength:this.minSearchChars,appendTo:"#typedAcSearch",select:this.onAutocompleteSelect.bind(this),response:this.onAutocompleteResponse.bind(this)});var autocomplete=this.$input.autocomplete("instance");var originalRenderItem=autocomplete._renderItem.bind(autocomplete);autocomplete._renderItem=function(ui,item){var $li=originalRenderItem(ui,item);if(item.addClass){$li.addClass(item.addClass)}if(item.trackeventCategory){$li.attr("data-trackevent-category",item.trackeventCategory)}if(item.trackeventAction){$li.attr("data-trackevent-action",item.trackeventAction)}if(item.valueHtml){$li.append(item.valueHtml)}return $li}};CustomSearch.prototype.onAutocompleteSelect=function(event,ui){this.sugesstion=ui.item.value;this.redirectUrl=ui.item.url;this.userQuery=this.$input.val();this.type=ui.item.type;this.saveSearchQuery();this.$input.val(ui.item.value);if(this.redirectUrl!=""&&this.redirectUrl!=null&&(this.type==="model"||this.type==="bike"||this.type==="showroom")){return this.redirect(this.redirectUrl)}if(ui.item.redirectTo){return this.redirect(ui.item.redirectTo)}this.search(ui.item.value)};CustomSearch.prototype.onAutocompleteChange=function(event){this.userQuery=event.target.value};CustomSearch.prototype.onAutocompleteResponse=function(event){this.userQuery=event.target.value};CustomSearch.prototype.openSearchInput=function(){this.$input.val(null);this.isActive=true;this.$containerSearch.addClass("active");this.ga.sendEvent("Pages","search-click")};CustomSearch.prototype.closeSearchInput=function(){if(!this.$input.val()){this.$input.val(this.defaultTitle)}this.isActive=false;this.$containerSearch.removeClass("active")};CustomSearch.prototype.search=function(query){query=this.removeInvalidCharacters(query.trim());query=this.replaceGapsWithDashes(query);if(query!==""){this.redirect(this.rootDomain+"search/"+query+"/"+$.cookie("city")+"/")}};CustomSearch.prototype.redirect=function(url){this.ga.sendEvent("Pages","search-value",this.sugesstion);window.location.href=url};CustomSearch.prototype.replaceGapsWithDashes=function(text){return text.split(" ").join("-")};CustomSearch.prototype.removeInvalidCharacters=function(text){return text.replace(/[^0-9a-z \-]/gi,"")};;
var Booking;(function(Booking){var BookingService=function(){function BookingService(){this.collection=new Core.Collection}BookingService.prototype.setDataProxy=function(dataProxy){this.dataProxy=dataProxy.getDataProxy()};BookingService.prototype.setBuilder=function(builder){this.bookingBuilder=builder};BookingService.prototype.setRouter=function(router){this.router=router};BookingService.prototype.setRouteName=function(routeName){this.routeName=routeName};BookingService.prototype.setShortBookingInfo=function(data){this.shortBooking=new Core.Collection(data)};BookingService.prototype.forEach=function(callback){this.shortBooking.forEach(callback)};BookingService.prototype.has=function(modelKey,cityPath){return this.shortBooking.filter(function(shortBooking){return shortBooking.modelKey==modelKey&&shortBooking.cities.indexOf(cityPath)>=0}).count()>0};BookingService.prototype.get=function(modelKey){if(this.hasFullBooking(modelKey)){return this.getBooking(modelKey)}else{return this.loadBooking(modelKey)}};BookingService.prototype.loadBooking=function(modelKey){var _this=this;var link=this.router.generate(this.routeName,{modelKey:modelKey});var booking=this.dataProxy.getJSON("booking|"+modelKey+"|"+performance.now(),link,{},function(response){var booking=new Booking.ModelBooking;var result=_this.bookingBuilder.build(booking,response);return result});this.collection.set(modelKey,booking);return this.getBooking(modelKey)};BookingService.prototype.getBooking=function(modelKey){return this.collection.get(modelKey)};BookingService.prototype.hasFullBooking=function(modelKey){return this.collection.containsKey(modelKey)};return BookingService}();Booking.BookingService=BookingService})(Booking||(Booking={}));;
var Booking;(function(Booking){var BookingBuilder=function(){function BookingBuilder(){}BookingBuilder.prototype.build=function(booking,data){booking.setAmounts(new Core.Collection(data["amounts"]));booking.setBookingText(data["bookingText"]);booking.setBookText(data["bookText"]);booking.setBrandPath(data["brandPath"]);booking.setModelPath(data["modelPath"]);booking.setCitiesPath(new Core.Collection(data["citiesPath"]));booking.setColorKeys(new Core.Collection(data["colorKeys"]));booking.setFaq(new Core.Collection(data["faq"]));booking.setCities(new Core.Collection(data["cities"]));booking.setOffers(new Core.Collection(data["offers"]));booking.setDisclaimer(this.extractDisclaimer(data["processDisclaimer"]));booking.setShowrooms(new Core.Collection(data["showrooms"]));booking.setTerms(new Core.Collection(data["terms"]));booking.setFullName(data["modelName"]);booking.setModelId(data["modelId"]);booking.setVariants(new Core.Collection(data["variants"]));booking.setColors(new Core.Collection(data["colors"]));booking.setRamainings(new Core.Collection(data["remainings"]));return booking};BookingBuilder.prototype.extractDisclaimer=function(disclaimers){var result=new Core.Collection;for(var i in disclaimers){if(disclaimers.hasOwnProperty(i)){result.set(i,disclaimers[i])}}return result};return BookingBuilder}();Booking.BookingBuilder=BookingBuilder})(Booking||(Booking={}));;
var Booking;(function(Booking){var AbstractBooking=function(){function AbstractBooking(){this.createCitiesCollection()}AbstractBooking.prototype.getCitiesPath=function(){return this.cities};AbstractBooking.prototype.getModelKey=function(){return["newcars",this.getBrandPath(),this.getModelPath()].join("|")};return AbstractBooking}();Booking.AbstractBooking=AbstractBooking})(Booking||(Booking={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Booking;(function(Booking){var ModelBooking=function(_super){__extends(ModelBooking,_super);function ModelBooking(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.defaultCityPath="newdelhi";return _this}ModelBooking.prototype.setRamainings=function(data){this.remainings=data};ModelBooking.prototype.getRamainings=function(){return this.remainings};ModelBooking.prototype.setActiveCityPath=function(cityPath){this.activeCityPath=cityPath};ModelBooking.prototype.getActiveCityPath=function(){return this.activeCityPath};ModelBooking.prototype.setColors=function(colors){this.colors=colors};ModelBooking.prototype.getColors=function(){return this.colors};ModelBooking.prototype.setVariants=function(variants){this.variants=variants};ModelBooking.prototype.getVariants=function(){return this.variants};ModelBooking.prototype.setTerms=function(terms){this.terms=terms};ModelBooking.prototype.getTerms=function(){return this.terms};ModelBooking.prototype.setShowrooms=function(showrooms){this.showrooms=showrooms};ModelBooking.prototype.getShowrooms=function(cityPath){if(cityPath===void 0){cityPath=""}return this.showrooms};ModelBooking.prototype.setOffers=function(offers){this.offers=offers};ModelBooking.prototype.getOffers=function(cityPath){return this.offers.filter(function(offer){return offer.citiesPath.indexOf(cityPath)>=0})};ModelBooking.prototype.setFaq=function(faq){this.faq=faq};ModelBooking.prototype.getFaq=function(){return this.faq};ModelBooking.prototype.setColorKeys=function(keys){this.colorKeys=keys};ModelBooking.prototype.getColorKeys=function(){return this.colorKeys};ModelBooking.prototype.setDefaultCityPath=function(path){this.defaultCityPath=path};ModelBooking.prototype.setModelPath=function(path){this.modelPath=path};ModelBooking.prototype.setBrandPath=function(path){this.brandPath=path};ModelBooking.prototype.setBookText=function(text){this.bookText=text};ModelBooking.prototype.setBookingText=function(text){this.bookingText=text};ModelBooking.prototype.setAmounts=function(amounts){this.amounts=amounts};ModelBooking.prototype.setFullName=function(name){this.modelFullName=name};ModelBooking.prototype.setDisclaimer=function(disclaimers){this.disclaimers=disclaimers};ModelBooking.prototype.setModelId=function(modelId){this.modelId=modelId};ModelBooking.prototype.createCitiesCollection=function(){};ModelBooking.prototype.setCities=function(cities){this.cities=cities};ModelBooking.prototype.getCities=function(){return this.cities};ModelBooking.prototype.setCitiesPath=function(citiesPath){this.citiesPath=citiesPath};ModelBooking.prototype.getCitiesPath=function(){return this.citiesPath};ModelBooking.prototype.getDefaultCityPath=function(){return this.defaultCityPath};ModelBooking.prototype.getModelPath=function(){return this.modelPath};ModelBooking.prototype.getBrandPath=function(){return this.brandPath};ModelBooking.prototype.getKey=function(){return this.getBrandPath()+"-"+this.getModelPath()};ModelBooking.prototype.getBookText=function(){return this.bookText};ModelBooking.prototype.getBookingText=function(){return this.bookingText};ModelBooking.prototype.getAmounts=function(){return this.amounts};ModelBooking.prototype.getBookingAmount=function(cityPath){return this.getAmount(cityPath)};ModelBooking.prototype.getBookingFullAmount=function(cityPath){return this.getAmount(cityPath)+this.getRemaining(cityPath)};ModelBooking.prototype.getRemaining=function(cityPath){return parseInt(this.remainings.filter(function(amount){return amount.cityPath==cityPath}).first().amount)};ModelBooking.prototype.getAmount=function(cityPath){return parseInt(this.amounts.filter(function(amount){return amount.cityPath==cityPath}).first().amount)};ModelBooking.prototype.getAboutBookingVideo=function(){return null};ModelBooking.prototype.getFullName=function(){return this.modelFullName};ModelBooking.prototype.getDisclaimer=function(cityPath){return this.disclaimers.containsKey(cityPath)?this.disclaimers.get(cityPath):this.disclaimers.get(this.defaultCityPath)};ModelBooking.prototype.getModelId=function(){return this.modelId};ModelBooking.prototype.getOffersWorth=function(cityPath){var result=0;var offers=this.getOffers(cityPath);offers.forEach(function(offer){result+=parseInt(offer.worth)});return Helper.Price.formatCrLac(result)};ModelBooking.prototype.getMappedCities=function(cityId){return[cityId]};return ModelBooking}(Booking.AbstractBooking);Booking.ModelBooking=ModelBooking})(Booking||(Booking={}));;
var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};var API_KEY="gop";var Lib;(function(Lib){var Gop=function(){function Gop(logger,container){this.logger=logger;this.api=null;this.dfr=null;this.container=container}Gop.prototype.proceed=function(data){return __awaiter(this,void 0,void 0,function(){var error_1;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,2,,3]);return[4,this.init()];case 1:_a.sent();this.api.resolve(data);return[3,3];case 2:error_1=_a.sent();this.logger.error(error_1);return[3,3];case 3:return[2]}})})};Gop.prototype.init=function(){var _this=this;if(!this.dfr){this.setGlobalVars();this.dfr=new Promise(function(resolve,reject){return __awaiter(_this,void 0,void 0,function(){var _a,e_1;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,2,,3]);_a=this;return[4,api(API_KEY)];case 1:_a.api=_b.sent();resolve(this.api);return[3,3];case 2:e_1=_b.sent();reject(e_1);return[3,3];case 3:return[2]}})})})}return this.dfr};Gop.prototype.setGlobalVars=function(){var params=this.container.getParameters();var paramsData={};for(var _i=0,_a=params.getKeys();_i<_a.length;_i++){var key=_a[_i];paramsData[key]=this.container.getParameter(key)}window.__AP_INITIAL_DATA__={gaData:{catalogName:"New cars",category:"Model",pageType:"Model"},configs:{parameters:[paramsData]}}};return Gop}();Lib.Gop=Gop})(Lib||(Lib={}));;
var Helper;(function(Helper){var FormatFlag;(function(FormatFlag){FormatFlag[FormatFlag["SHOW_LETTERS"]=1]="SHOW_LETTERS";FormatFlag[FormatFlag["HIDE_LETTERS"]=0]="HIDE_LETTERS"})(FormatFlag=Helper.FormatFlag||(Helper.FormatFlag={}));var Price=function(){function Price(){}Price.formatCrLac=function(amount,showLetters){if(showLetters===void 0){showLetters=FormatFlag.SHOW_LETTERS}var result=undefined;if(isNaN(amount)||amount===null||amount===0){return"0"}if(amount<1e3){result=this.formatPrice(amount.toFixed(0),",")}else if(amount<1e5){result=this.formatPrice((amount/1e3).toFixed(3),",")}else if(amount<=1e7){result=this.formatPrice((amount/1e5).toFixed(2),".")+(showLetters==FormatFlag.SHOW_LETTERS?" Lakh":"")}else{result=this.formatPrice((amount/1e7).toFixed(2),".")+(showLetters==FormatFlag.SHOW_LETTERS?" Cr":"")}return result};Price.formatPriceRange=function(priceMin,priceMax){var result="";try{if(priceMin==priceMax){result=this.formatCrLac(priceMin)}else{result=this.formatCrLac(priceMin,FormatFlag.HIDE_LETTERS)+" - "+this.formatCrLac(priceMax)}}catch(e){}return result};Price.formatPrice=function(val,delimiter){return val.replace(/\./g,delimiter)};Price.plainNum=function(num){return parseInt(num)};Price.addRupeeSign=function(str){return'<span class="WebRupee"></span>'+str};Price.formatRupees=function(val){var value=val.toString();var position=value.length-3;for(position;position>0;position-=2){value=[value.slice(0,position),",",value.slice(position)].join("")}return value};return Price}();Helper.Price=Price})(Helper||(Helper={}));;
var Helper;(function(Helper){var INTERVAL=1e3;var CountDownBlock=function(){function CountDownBlock($wrapper){this.counterTimer=null;this.$wrapper=$wrapper}CountDownBlock.prototype.start=function(delaySeconds,callback){this.countSeconds=delaySeconds;this.counterTimer=setInterval(this.timer.bind(this),INTERVAL);this.callback=callback;this.render(this.countSeconds,"sec")};CountDownBlock.prototype.stop=function(){clearInterval(this.counterTimer);this.callback()};CountDownBlock.prototype.timer=function(){this.countSeconds--;this.render(this.countSeconds,"sec");if(this.countSeconds==0){this.stop()}};CountDownBlock.prototype.render=function(value,unit){this.$wrapper.find("[data-timer-value]").text(value);this.$wrapper.find("[data-timer-unit]").text(unit)};return CountDownBlock}();Helper.CountDownBlock=CountDownBlock})(Helper||(Helper={}));;
var General;(function(General){var FormView=function(){function FormView($form){this.disableFreezed=false;this.$form=$form}FormView.prototype.freezeDisabled=function(){this.disableFreezed=true};FormView.prototype.unfreezeDisabled=function(){this.disableFreezed=false};FormView.prototype.canBeEnabled=function(){return!this.disableFreezed};FormView.prototype.getForm=function(){return this.$form};FormView.prototype.getSubmitButton=function(){return this.$form.find('[type="submit"]')};FormView.prototype.disableSubmit=function(){this.getSubmitButton().attr("disabled","disabled")};FormView.prototype.enableSubmit=function(){if(this.canBeEnabled()){this.getSubmitButton().removeAttr("disabled")}};FormView.prototype.getAction=function(){return this.$form.attr("action")};FormView.prototype.find=function(selector){return this.$form.find(selector)};FormView.prototype.reset=function(){this.getHTMLFormElement().reset()};FormView.prototype.getHTMLFormElement=function(){return this.$form.get(0)};return FormView}();General.FormView=FormView})(General||(General={}));;
function LocationSearch($searchInput,params){this.$input=$searchInput;this.$inputIds=$(params.inputIdsField);this.searchUrl=params.searchUrl;this.isPriceForModelInCityUrl=params.isPriceForModelInCityUrl;this.rootDomain=params.rootDomain;this.minSearchChars=2;this.defaultTitle=params.searchTitle;this.maxResults=200;this.userQuery="";this.sugesstion=null;this.$button=$(params.searchButton);this.$container=this.$input.closest(params.container);this.appendBox=params.appendBox;this.isActive=false;this.$stateId=$(params.stateIdField);this.$cityId=$(params.cityIdField);this.$localityId=$(params.localityIdField);this.$localityTitle=$(params.localityTitleField);this.$postcode=$(params.postcodeField);this.$city=$(params.cityField);this.$cityPath=$(params.cityPathField);this.$validAddressError=$(params.validAddressError);this.$nextStepButton=$(params.nextStepButton);this.$modelId=params.modelId;this._onChange=$.Callbacks();this.initCustomParameters();this.setTitle();this.initAutoComplete();this.attachListeners()}LocationSearch.prototype.onChange=function(callback){this._onChange.add(callback)};LocationSearch.prototype.addInputCustomParameters=function(customParameters){var self=this;if(this.$input.data("only-cities")){customParameters["only_cities"]=function(){return true}}else if(this.$input.data("only-locations-or-postcodes")){customParameters["only_locations_or_postcodes"]=function(){return true}}if(this.$input.data("filter-city-id")){customParameters["city"]=function(){return self.$input.data("filter-city-id")}}};LocationSearch.prototype.initCustomParameters=function(){this.customParameters={};if(this.$modelId){var self=this;this.customParameters["model"]=function(){return self.$modelId.val()}}this.addInputCustomParameters(this.customParameters)};LocationSearch.prototype.addParameter=function(key,getter){this.customParameters[key]=getter};LocationSearch.prototype.setTitle=function(){this.$input.val(this.defaultTitle)};LocationSearch.prototype.attachListeners=function(){this.searchFocusListener()};LocationSearch.prototype.searchFocusListener=function(){this.$input.on({focusin:this.openSearchInput.bind(this),focusout:this.closeSearchInput.bind(this)})};LocationSearch.prototype.reset=function(){this.$cityId.val(null).trigger("change");this.$localityId.val(null).trigger("change");this.$postcode.val(null).trigger("change");this.$stateId.val(null).trigger("change");this.$input.val(null);this.$inputIds.val(null);this.$cityPath.val(null);this.$city.text("");this.$localityTitle.html("");this._onChange.fire();this.$input.trigger("change")};LocationSearch.prototype.getAutocompleteData=function(request,response){var maxResults=this.maxResults;var self=this;jQuery.getJSON(this.searchUrl,this.getParameters(request),function(data){if(data.response.numFound){response(data.response.docs.slice(0,maxResults))}}).error(function(){self.reset()})};LocationSearch.prototype.isPriceForModelInCity=function(cityId,isTermCallback){jQuery.getJSON(this.isPriceForModelInCityUrl,this.getParameters({term:cityId}),function(data){if(data.result){isTermCallback()}})};LocationSearch.prototype.getParameters=function(request){var result={};result["query"]=request.term.trim();for(var key in this.customParameters){if(this.customParameters.hasOwnProperty(key)){result[key]=this.customParameters[key]()}}return result};LocationSearch.prototype.initAutoComplete=function(){var self=this;this.$input.autocomplete({source:this.getAutocompleteData.bind(this),minLength:this.minSearchChars,appendTo:this.appendBox,select:this.onAutocompleteSelect.bind(this),focus:function(event,ui){event.preventDefault();self.$input.val(ui.item.label)},response:this.onAutocompleteResponse.bind(this)})};LocationSearch.prototype.getCityInputDom=function(){return this.$input};LocationSearch.prototype.onAutocompleteSelect=function(event,ui){event.preventDefault();var addressDetails=ui.item.value.split("-");this.$cityId.val(addressDetails[0]).trigger("change");this.$localityId.val(addressDetails[1]).trigger("change");this.$postcode.val(addressDetails[2]).trigger("change");this.$stateId.val(addressDetails[3]).trigger("change");this.$input.val(ui.item.label);this.$inputIds.val(ui.item.value);this.$cityPath.val(ui.item.cityPath);this.$city.text(ui.item.city);this.$localityTitle.html(ui.item.localityTitle);this.isActive=true;this.$container.addClass("active");this.$validAddressError.removeClass("active");this.$nextStepButton.removeClass("disabled");this._onChange.fire();this.$input.trigger("change");this.$input.trigger("autoportal:location-search:selected")};LocationSearch.prototype.onAutocompleteChange=function(event){this.userQuery=event.target.label};LocationSearch.prototype.onAutocompleteResponse=function(event){this.userQuery=event.target.label};LocationSearch.prototype.openSearchInput=function(){this.reset();this.isActive=true;this.$container.addClass("active")};LocationSearch.prototype.closeSearchInput=function(){if(!this.$input.val()){this.$input.val(this.defaultTitle)}this.isActive=false;this.$container.removeClass("active")};;
var Gop;(function(Gop){var SelectLocality=function(){function SelectLocality($dom){this.$dom=$dom;this.init()}SelectLocality.prototype.getLocationSearch=function(){return this.locationSearch};SelectLocality.prototype.getDom=function(){return this.$dom};SelectLocality.prototype.getCityInputDom=function(){return this.locationSearch.getCityInputDom()};SelectLocality.prototype.hide=function(){this.$dom.addClass("d_n")};SelectLocality.prototype.getCityIdDom=function(){return this.$dom.find("[data-location-cityId]")};SelectLocality.prototype.show=function(){this.$dom.removeClass("d_n")};SelectLocality.prototype.getCityId=function(){return this.getCityIdDom().val()};SelectLocality.prototype.getPostCode=function(){return this.$dom.find("[data-location-pincode]").val()};SelectLocality.prototype.getLocalityId=function(){return this.$dom.find("[data-location-localityId]").val()};SelectLocality.prototype.getCityName=function(){return this.$dom.find("[data-location-city-name]").html()};SelectLocality.prototype.setLocalityId=function(id){this.$dom.find("[data-location-localityId]").val(id)};SelectLocality.prototype.setCityId=function(id){this.getCityIdDom().val(id)};SelectLocality.prototype.setPostCode=function(code){this.$dom.find("[data-location-pincode]").val(code)};SelectLocality.prototype.setCityName=function(name){this.$dom.find("[data-location-city-name]").html(name)};SelectLocality.prototype.getSelectedValue=function(){return this.$dom.find('[data-type="location-search-edit-field"]').val()};SelectLocality.prototype.setSelectedValue=function(value){var element=this.$dom.find('[data-type="location-search-edit-field"]');element.val(value);element.trigger("autoportal:location-search:set-selected")};SelectLocality.prototype.addParameter=function(name,value){this.locationSearch.addParameter(name,value)};SelectLocality.prototype.setAddressText=function(text){this.$dom.find('[data-type="location-search-edit-field"]').val(text)};SelectLocality.prototype.setLocationIds=function(ids){this.$dom.find('[data-type="location-ids-field"]').val(ids)};SelectLocality.prototype.getLocationIds=function(){return this.$dom.find('[data-type="location-ids-field"]').val()};SelectLocality.prototype.init=function(){this.locationSearch=new LocationSearch(this.$dom.find('[data-type="location-search-edit-field"]'),{rootDomain:"/",searchUrl:"/api/v1/location_search/",isPriceForModelInCityUrl:"/api/v1/is_price_for_model_in_city/",container:this.$dom.find('[data-type="location-search-edit"]'),appendBox:this.$dom.find('[data-type="location-search-edit-box"]'),inputIdsField:this.$dom.find('[data-type="location-ids-field"]'),cityIdField:this.$dom.find("[data-location-cityId]"),localityIdField:this.$dom.find("[data-location-localityId]"),postcodeField:this.$dom.find("[data-location-pincode]"),cityField:this.$dom.find("[data-location-city-name]")})};return SelectLocality}();Gop.SelectLocality=SelectLocality})(Gop||(Gop={}));;
var Forms;(function(Forms){var SelectLocationDto=function(){function SelectLocationDto(){this.cityId="";this.localityId="";this.postCode="";this.cityName="";this.selectedValue="";this.locationIds=""}SelectLocationDto.prototype.getLocationIds=function(){return this.locationIds};SelectLocationDto.prototype.setLocationIds=function(ids){if(ids===void 0){ids=""}this.locationIds=ids};SelectLocationDto.prototype.getCityId=function(){return this.cityId};SelectLocationDto.prototype.getLocalityId=function(){return this.localityId};SelectLocationDto.prototype.getPostCode=function(){return this.postCode};SelectLocationDto.prototype.getCityName=function(){return this.cityName};SelectLocationDto.prototype.getSelectedValue=function(){return this.selectedValue};SelectLocationDto.prototype.setLocalityId=function(id){if(id===void 0){id=""}this.localityId=id};SelectLocationDto.prototype.setCityId=function(id){if(id===void 0){id=""}this.cityId=id};SelectLocationDto.prototype.setPostCode=function(code){if(code===void 0){code=""}this.postCode=code};SelectLocationDto.prototype.setCityName=function(name){if(name===void 0){name=""}this.cityName=name};SelectLocationDto.prototype.setSelectedValue=function(name){if(name===void 0){name=""}this.selectedValue=name};SelectLocationDto.prototype.show=function(){};SelectLocationDto.prototype.hide=function(){};SelectLocationDto.prototype.getCityIdDom=function(){return $};SelectLocationDto.prototype.addParameter=function(name,value){};SelectLocationDto.create=function(data){var dto=new SelectLocationDto;if(typeof data["cityId"]!=="undefined"){dto.setCityId(data["cityId"])}if(typeof data["cityName"]!=="undefined"){dto.setCityName(data["cityName"])}if(typeof data["localityId"]!=="undefined"){dto.setLocalityId(data["localityId"])}if(typeof data["postCode"]!=="undefined"){dto.setPostCode(data["postCode"])}if(typeof data["selectedValue"]!=="undefined"){dto.setSelectedValue(data["selectedValue"])}if(typeof data["locationIds"]!=="undefined"){dto.setLocationIds(data["locationIds"])}return dto};SelectLocationDto.prototype.jsonSerialize=function(){return{cityId:this.getCityId(),cityName:this.getCityName(),localityId:this.getLocalityId(),postCode:this.getPostCode(),selectedValue:this.getSelectedValue(),locationIds:this.getLocationIds()}};return SelectLocationDto}();Forms.SelectLocationDto=SelectLocationDto})(Forms||(Forms={}));;
var Forms;(function(Forms){var SelectLocationView=function(){function SelectLocationView(parent,selector){if(selector===void 0){selector='[data-block="localityBlock"]'}this.parent=parent;this.selectLocality=new Gop.SelectLocality(this.getForm().find(selector));this._onChange=$.Callbacks();this.init()}SelectLocationView.prototype.getSelectLocality=function(){return this.selectLocality};SelectLocationView.prototype.getCityInputDom=function(){return this.selectLocality.getCityInputDom()};SelectLocationView.prototype.getDom=function(){return this.selectLocality.getDom()};SelectLocationView.prototype.addParameter=function(name,value){this.selectLocality.addParameter(name,value)};SelectLocationView.prototype.init=function(){var _this=this;this.selectLocality.getLocationSearch().onChange(function(){_this.update()})};SelectLocationView.prototype.getCityId=function(){return this.selectLocality.getCityId()};SelectLocationView.prototype.getLocalityId=function(){return this.selectLocality.getLocalityId()};SelectLocationView.prototype.getPostCode=function(){return this.selectLocality.getPostCode()};SelectLocationView.prototype.getCityName=function(){return this.selectLocality.getCityName()};SelectLocationView.prototype.getSelectedValue=function(){return this.selectLocality.getSelectedValue()};SelectLocationView.prototype.update=function(){this._onChange.fire(this)};SelectLocationView.prototype.restore=function(locationView,onlyWithPrice){var _this=this;if(onlyWithPrice===void 0){onlyWithPrice=false}var isTermCallback=function(){_this.selectLocality.setCityId(locationView.getCityId());_this.selectLocality.setCityName(locationView.getCityName());_this.selectLocality.setLocalityId(locationView.getLocalityId());_this.selectLocality.setPostCode(locationView.getPostCode());_this.selectLocality.setSelectedValue(locationView.getSelectedValue());_this.selectLocality.setAddressText(locationView.getSelectedValue());_this.selectLocality.setLocationIds(locationView.getLocationIds())};if(locationView.getCityId()&&onlyWithPrice){this.selectLocality.getLocationSearch().isPriceForModelInCity(locationView.getCityId(),isTermCallback)}else{isTermCallback()}};SelectLocationView.prototype.setLocationIds=function(ids){this.selectLocality.setLocationIds(ids)};SelectLocationView.prototype.getLocationIds=function(){return this.selectLocality.getLocationIds()};SelectLocationView.prototype.getForm=function(){return this.parent.getForm()};SelectLocationView.prototype.onChange=function(callback){this._onChange.add(callback)};SelectLocationView.prototype.jsonSerialize=function(){return{cityId:this.getCityId(),cityName:this.getCityName(),localityId:this.getLocalityId(),postCode:this.getPostCode(),selectedValue:this.getSelectedValue(),locationIds:this.getLocationIds()}};return SelectLocationView}();Forms.SelectLocationView=SelectLocationView})(Forms||(Forms={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Offers;(function(Offers){var OffersRequestStatus;(function(OffersRequestStatus){OffersRequestStatus[OffersRequestStatus["PHONE_VERIFICATION_OK"]=0]="PHONE_VERIFICATION_OK";OffersRequestStatus[OffersRequestStatus["PHONE_VERIFICATION_FAIL"]=402]="PHONE_VERIFICATION_FAIL";OffersRequestStatus[OffersRequestStatus["PHONE_VERIFICATION_SMS_SENT"]=200]="PHONE_VERIFICATION_SMS_SENT";OffersRequestStatus[OffersRequestStatus["ERROR"]="error"]="ERROR"})(OffersRequestStatus=Offers.OffersRequestStatus||(Offers.OffersRequestStatus={}));var DEFAULT_OFFER_PARTNER_ID=8;var DEFAULT_AUTO_LEAD_PARTNER_ID=9;var GetOffersForm=function(_super){__extends(GetOffersForm,_super);function GetOffersForm($form,leadBuilder,smsVerifyForm,container,popupId){var _this=_super.call(this,$form)||this;_this.offersShowed=false;_this.$form=$form;_this.leadBuilder=leadBuilder;_this.validator=new Offers.GetOffersFormValidator($form);_this.smsVerifyForm=smsVerifyForm;_this.container=container;_this.notificationService=container.get("notification_service");_this.popupId=popupId;_this.userInfo=container.get("user_info_service");_this.ga=container.get("ga");_this.leadsStorage=new Offers.OffersLeadStore(new Storages.SessionStorage,"offersLeads");_this.gtmService=_this.container.get("gtm_service");_this.onSubmitCallbacks=$.Callbacks();_this.locationView=_this.createLocationView('[data-block="localityBlock"]');_this.addListeners();_this.initUserInfo();return _this}GetOffersForm.prototype.getPageCityId=function(){return this.$form.data("city")};GetOffersForm.prototype.createLocationView=function(selector){var _this=this;var result=new Forms.SelectLocationView(this,selector);if(this.isLandingPage()){result.addParameter("with_offers",function(){return true});result.addParameter("model",function(){return _this.getModelId()})}else{result.addParameter("city",function(){return _this.getCityId()})}return result};GetOffersForm.prototype.getPostCode=function(){return this.locationView.getPostCode()};GetOffersForm.prototype.getLocality=function(){return this.locationView.getLocalityId()};GetOffersForm.prototype.initUserInfo=function(){this.updatePhone(this.userInfo.getPhone());this.updateEmail(this.userInfo.getEmail());this.updateName(this.userInfo.getName());if(this.getPageCityId()==this.userInfo.getLocation().getCityId()||this.landingPage){this.locationView.restore(this.userInfo.getLocation());if(this.userInfo.getLocation().getCityId()){this.cityId=this.userInfo.getLocation().getCityId()}}};GetOffersForm.prototype.saveUserInfo=function(){this.userInfo.setEmail(this.getUserEmail());this.userInfo.setName(this.getUserName());this.userInfo.setPhone(this.getUserPhone());this.userInfo.setPurchaseDate(this.getPurchaseDate());this.userInfo.setLocation(this.locationView);this.userInfo.saveClientId()};GetOffersForm.prototype.onSubmit=function(callback){this.onSubmitCallbacks.add(callback)};GetOffersForm.prototype.initByDataSet=function(dataset){this.brandId=dataset.brandId;this.modelId=dataset.modelId;this.cityId=dataset.cityId;this.variantId=dataset.variantId;this.partnerId=dataset.partnerId||DEFAULT_OFFER_PARTNER_ID;this.autoPartnerId=dataset.autoPartnerId||DEFAULT_AUTO_LEAD_PARTNER_ID;this.price=dataset.price;this.landingPage=dataset.landingPage||0;this.modelName=dataset.modelName;this.variantName=dataset.variantName;this.trackeventCategory=dataset.trackeventCategory;if(this.isLandingPage()){this.initLanding()}if(this.getLastOfferLead()){this.submitAutoLead()}else{this.showLeadForm()}};GetOffersForm.prototype.initLanding=function(){if(this.userInfo.getLocation()){this.cityId=this.userInfo.getLocation().getCityId()}this.locationView=this.createLocationView('[data-block="localityBlock"]');var _self=this;this.locationView.onChange(function(locationView){_self.cityId=locationView.getCityId()})};GetOffersForm.prototype.submitAutoLead=function(){var _this=this;var lastLead=this.getLastOfferLead().get();var data=this.leadBuilder.build(this,lastLead);data=this.leadBuilder.setPartnerId(data,this.autoPartnerId);if(this.cityId!=this.locationView.getCityId()&&!this.isLandingPage()){data["postcode"]=null;data["locality"]=null}var dataEntity=new AP.Entity(data);var currentVariantName=this.variantName;if(this.leadsStorage.containts(dataEntity)){this.showOffers()}else{this.submitForm(data).done(function(response){if(response.isNew){_this.trackGaAutoLead(currentVariantName)}})}};GetOffersForm.prototype.isLandingPage=function(){return!!this.landingPage};GetOffersForm.prototype.showLeadForm=function(){var popup=this.container.get("popup_service").get(this.popupId);this.setPopupTitle(popup,this.modelName);this.initUserInfo();popup.open()};GetOffersForm.prototype.setPopupTitle=function(popup,title){var $container=$(popup.getContainer());var modelTitleSelector=this.getModelTitleSelector();var gaTrackevent=this.getGaTrackevent();$(modelTitleSelector,$container).html(title);$(gaTrackevent,$container).data("trackeventLabel",title)};GetOffersForm.prototype.getModelTitleSelector=function(){return"[data-type=brand-model-title]"};GetOffersForm.prototype.getGaTrackevent=function(){return"[data-type=trackevent]"};GetOffersForm.prototype.getBrandId=function(){return this.brandId};GetOffersForm.prototype.getModelId=function(){return this.modelId};GetOffersForm.prototype.getVariantId=function(){return this.variantId};GetOffersForm.prototype.getCityId=function(){return this.cityId};GetOffersForm.prototype.getPartnerId=function(){return this.partnerId};GetOffersForm.prototype.addListeners=function(){var _this=this;this.$form.on("submit",this.handleSubmit.bind(this));this.smsVerifyForm.onSuccess(this.showOffers.bind(this));this.smsVerifyForm.onPhoneUpdate(this.updatePhone.bind(this));this.onSubmit(function(){_this.saveUserInfo()})};GetOffersForm.prototype.updatePhone=function(phone){if(phone===void 0){phone=""}Dom.setValue($("[data-field=userPhone]",this.$form),phone)};GetOffersForm.prototype.updateEmail=function(value){if(value===void 0){value=""}Dom.setValue($("[data-field=userEmail]",this.$form),value)};GetOffersForm.prototype.updateName=function(value){if(value===void 0){value=""}Dom.setValue($("[data-field=userName]",this.$form),value)};GetOffersForm.prototype.updatePurchaseDate=function(value){if(value===void 0){value=""}Dom.setValue($("[data-field=purchaseDate]",this.$form),value)};GetOffersForm.prototype.getUserPhone=function(){return Dom.getValue($("[data-field=userPhone]",this.$form))};GetOffersForm.prototype.getUserEmail=function(){return Dom.getValue($("[data-field=userEmail]",this.$form))};GetOffersForm.prototype.getUserName=function(){return Dom.getValue($("[data-field=userName]",this.$form))};GetOffersForm.prototype.getPurchaseDate=function(){return Dom.getValue($("[data-field=purchaseDate]",this.$form))};GetOffersForm.prototype.enableSubmitButton=function(){this.getSubmitButton().removeAttr("disabled")};GetOffersForm.prototype.disableSubmitButton=function(){this.getSubmitButton().attr("disabled","disabled")};GetOffersForm.prototype.handleSubmit=function(e){var _this=this;e.preventDefault();try{this.validator.validate();var data=this.leadBuilder.build(this);var currentVariantName_1=this.variantName;this.submitForm(data).done(function(response){if(response.isNew){_this.trackGaNewLead(currentVariantName_1);_this.gtmService.pushData({event:"Offer_Lead_Saved"})}})}catch(validationError){}};GetOffersForm.prototype.submitForm=function(data){var _this=this;this.disableSubmitButton();this.saveLastOfferLead(new AP.Entity(data));this.onSubmitCallbacks.fire();return $.post(this.$form.attr("action"),data,function(response){_this.saveLastOfferLeadId(response.leadId);_this.onSubmitCallback(response)},"json").always(function(){_this.enableSubmitButton()})};GetOffersForm.prototype.onSubmitCallback=function(response){if(this.offersShowed){this.showOffers();return}switch(response.status){case Offers.OffersRequestStatus.ERROR:this.notificationService.alert(response.message);break;case Offers.OffersRequestStatus.PHONE_VERIFICATION_OK:this.showOffers();break;case Offers.OffersRequestStatus.PHONE_VERIFICATION_FAIL:case Offers.OffersRequestStatus.PHONE_VERIFICATION_SMS_SENT:default:this.smsVerifyForm.start($("[data-field=userPhone]",this.$form).val(),$("[data-field=userName]",this.$form).val());break}};GetOffersForm.prototype.saveLastOfferLeadId=function(leadId){this.leadsStorage.setLastLeadId(leadId)};GetOffersForm.prototype.saveLastOfferLead=function(lead){this.leadsStorage.saveLead(lead)};GetOffersForm.prototype.getLastOfferLead=function(){return this.leadsStorage.getLastOfferLead()};GetOffersForm.prototype.showOffers=function(){var popupService=this.container.get("popup_service");var popup=popupService.get(this.popupId);popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);popup.close();this.showOffersResult()};GetOffersForm.prototype.showOffersResult=function(){this.container.get("event_dispatcher").publish("get_offers_form.show_offers");this.offersShowed=true};GetOffersForm.prototype.trackGaNewLead=function(variantName){this.ga.sendEvent(this.trackeventCategory,"Offer-Form_ViewOfferDetails-Submit",variantName)};GetOffersForm.prototype.trackGaAutoLead=function(variantName){this.ga.sendEvent(this.trackeventCategory,"Offer-Form_ViewOfferDetails-Submit2",variantName)};return GetOffersForm}(General.FormView);Offers.GetOffersForm=GetOffersForm})(Offers||(Offers={}));;
var Offers;(function(Offers){var OffersLeadStore=function(){function OffersLeadStore(storage,key){this.storage=storage;this.key=key}OffersLeadStore.prototype.saveLead=function(lead){var collection=this.getAll();collection.push(lead);this.commit(collection)};OffersLeadStore.prototype.setLastLeadId=function(leadId){var collection=this.getAll();collection[collection.length-1].get()["id"]=leadId;this.commit(collection)};OffersLeadStore.prototype.getLastLeadId=function(){return this.getLastOfferLead().get()["id"]};OffersLeadStore.prototype.getLastOfferLead=function(){return this.getAll().pop()};OffersLeadStore.prototype.containts=function(lead){var result=false;var collection=this.getAll();for(var index in collection){if(collection[index].toString()===lead.toString()){result=true;break}}return result};OffersLeadStore.prototype.getAll=function(){var jsonCollection=this.storage.get(this.key)||"[]";return this.unserializeCollection(jsonCollection)};OffersLeadStore.prototype.unserializeCollection=function(jsonCollection){var collection=JSON.parse(jsonCollection);var result=[];for(var index in collection){result.push(this.unserializeItem(collection[index]))}return result};OffersLeadStore.prototype.unserializeItem=function(jsonEntity){return new AP.Entity(JSON.parse(jsonEntity))};OffersLeadStore.prototype.serializeCollection=function(collection){var result=[];for(var index in collection){result.push(this.serializeItem(collection[index]))}return JSON.stringify(result)};OffersLeadStore.prototype.serializeItem=function(item){return item.toString()};OffersLeadStore.prototype.commit=function(collection){this.storage.set(this.key,this.serializeCollection(collection))};return OffersLeadStore}();Offers.OffersLeadStore=OffersLeadStore})(Offers||(Offers={}));;
var Offers;(function(Offers){var GetOffersFormValidator=function(){function GetOffersFormValidator($form){this.$form=$form;this.attachValidator()}GetOffersFormValidator.prototype.validate=function(){if(!this.$form.valid()){throw new Error("Form is invalid!")}};GetOffersFormValidator.prototype.attachValidator=function(){var self=this;this.$form.validate({rules:{name:{required:true,autoportalName:true},email:{required:true,email:true,emailNoTopLevelDomains:true},localityBlock:{required:true,requiredLocationAutocompleteCity:true},terms:"required",modelId:"required",purchaseDate:"required",phone:{required:true,sellCarPhone:true}},messages:{name:{autoportalName:"Please Enter Valid Name",required:"Please Enter Name"},email:{email:"Please Enter Valid Email",emailNoTopLevelDomains:"Please Enter Valid Email",required:"Please Enter Email"},terms:"Need to agree with terms and conditions",purchaseDate:"Please Choose Purchase Period",phone:"Please, enter valid number.",localityBlock:"Please Enter Valid Location."},highlight:function(element){self.getErrorBlock($(element).attr("name")).addClass("active")},unhighlight:function(element){self.getErrorBlock($(element).attr("name")).removeClass("active")},errorPlacement:function(error,element){self.getErrorBlock(element.attr("name")).html(error.text())}})};GetOffersFormValidator.prototype.getErrorBlock=function(fieldName){return this.$form.find("[data-error-name='"+fieldName+"']")};return GetOffersFormValidator}();Offers.GetOffersFormValidator=GetOffersFormValidator})(Offers||(Offers={}));;
var Offers;(function(Offers){var GetOffersLeadBuilder=function(){function GetOffersLeadBuilder(fields){this.fields=fields}GetOffersLeadBuilder.prototype.build=function(form,defaults){var result=$.extend({},defaults||this.fillLead());result["brandId"]=form.getBrandId();result["cityId"]=form.getCityId();result["modelId"]=form.getModelId();result["variantId"]=form.getVariantId();result["leadType"]="offer";result["partnerId"]=form.getPartnerId();if(this.sameCity(form,defaults)){result["postcode"]=form.getPostCode();result["locality"]=form.getLocality()}return result};GetOffersLeadBuilder.prototype.sameCity=function(form,defaults){return!!(!!defaults&&defaults.hasOwnProperty("cityId")&&defaults["cityId"]==form.getCityId())||!defaults};GetOffersLeadBuilder.prototype.setPartnerId=function(data,partnerId){data.partnerId=partnerId;return data};GetOffersLeadBuilder.prototype.fillLead=function(){var lead={};for(var field in this.fields){lead[field]=this.fields[field]()}return lead};return GetOffersLeadBuilder}();Offers.GetOffersLeadBuilder=GetOffersLeadBuilder})(Offers||(Offers={}));;
var Offers;(function(Offers){var GetOffersResultPopup=function(){function GetOffersResultPopup(container,bookingForm){this.popupId="offer-popup-result";this.container=container;this.bookingForm=bookingForm;this.$popup=$("#"+this.popupId);this.addListeners()}GetOffersResultPopup.prototype.initByDataSet=function(dataset){this.brandId=dataset.brandId;this.modelId=dataset.modelId;this.variantId=dataset.variantId;this.cityId=dataset.cityId;this.partnerId=dataset.partnerId;this.modelName=dataset.modelName;this.modelImg=dataset.modelImg;this.variantName=dataset.variantName;this.offersWorth=dataset.offersWorth;this.offers=dataset.offers.split(",");this.trackeventCategory=dataset.trackeventCategory};GetOffersResultPopup.prototype.addListeners=function(){this.container.get("event_dispatcher").subscribe("get_offers_form.show_offers",this.showPopup.bind(this))};GetOffersResultPopup.prototype.showPopup=function(){this.container.get("popup_service").get(this.popupId).open();this.setPopupData();this.setBookingFormData()};GetOffersResultPopup.prototype.hidePopup=function(){var popup=this.container.get("popup_service").get(this.popupId);popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);popup.close()};GetOffersResultPopup.prototype.setPopupData=function(){this.setImage();this.setOffersWorth();this.setVariantName();this.setOffers();this.setUserName();this.setTestdriveButtonTrackevent();this.setBookingButtonTrackevent()};GetOffersResultPopup.prototype.setImage=function(){this.$popup.find('[data-target="model-image"]').attr("src",this.modelImg);this.$popup.find('[data-target="model-image"]').attr("alt",this.modelName)};GetOffersResultPopup.prototype.setOffersWorth=function(){this.$popup.find('[data-target="offers-worth"]').html(this.offersWorth.toString())};GetOffersResultPopup.prototype.setVariantName=function(){this.$popup.find('[data-target="variant-name"]').html(this.variantName)};GetOffersResultPopup.prototype.setUserName=function(){var userInfo=this.container.get("user_info_service");this.$popup.find("[data-ty-user-name]").html(userInfo.getName())};GetOffersResultPopup.prototype.setTestdriveButtonTrackevent=function(){var $testdriveButton=this.$popup.find('[data-type="offers-testdrive"]');$testdriveButton.data("trackeventCategory",this.trackeventCategory);$testdriveButton.data("trackeventLabel",this.variantName)};GetOffersResultPopup.prototype.setBookingButtonTrackevent=function(){var $bookingButton=this.$popup.find('[data-type="offers-booking"]');$bookingButton.data("trackeventCategory",this.trackeventCategory);$bookingButton.data("trackeventLabel",this.variantName)};GetOffersResultPopup.prototype.setOffers=function(){var self=this;var $offers=this.$popup.find('[data-target="offers-list"] > [data-offer-id]');$offers.each(function(index,element){var offerId=element.dataset["offerId"];if($.inArray(offerId,self.offers)===-1){$(element).hide()}else{$(element).show()}})};GetOffersResultPopup.prototype.setBookingFormData=function(){this.bookingForm.setBrandId(this.brandId);this.bookingForm.setModelId(this.modelId);this.bookingForm.setVariantId(this.variantId);this.bookingForm.setCityId(this.cityId);this.bookingForm.setTitle(this.modelName)};return GetOffersResultPopup}();Offers.GetOffersResultPopup=GetOffersResultPopup})(Offers||(Offers={}));;
var Form;(function(Form_1){var Form=function(){function Form(container){this.container=container;this.eventDispatcher=this.container.get("event_dispatcher")}return Form}();Form_1.Form=Form})(Form||(Form={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Form;(function(Form){var VerifyPhoneResponseStatus;(function(VerifyPhoneResponseStatus){VerifyPhoneResponseStatus[VerifyPhoneResponseStatus["SEND_SUCCESS"]=200]="SEND_SUCCESS";VerifyPhoneResponseStatus[VerifyPhoneResponseStatus["INVALID_PHONE_NUMBER"]=400]="INVALID_PHONE_NUMBER";VerifyPhoneResponseStatus[VerifyPhoneResponseStatus["PHONE_IS_VERIFIED"]=0]="PHONE_IS_VERIFIED";VerifyPhoneResponseStatus[VerifyPhoneResponseStatus["LIMIT_REACHED"]=401]="LIMIT_REACHED";VerifyPhoneResponseStatus[VerifyPhoneResponseStatus["PHONE_IS_NOT_VERIFIED"]=402]="PHONE_IS_NOT_VERIFIED";VerifyPhoneResponseStatus[VerifyPhoneResponseStatus["SMS_API_PROVIDER_ERROR"]=500]="SMS_API_PROVIDER_ERROR"})(VerifyPhoneResponseStatus=Form.VerifyPhoneResponseStatus||(Form.VerifyPhoneResponseStatus={}));var AbstractSmsVerifyForm=function(_super){__extends(AbstractSmsVerifyForm,_super);function AbstractSmsVerifyForm(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.currentValidateCodeResult=null;_this.countSecondsStart=59;_this.lockClick=true;_this.countClick=1;_this.onShowCallbacks=$.Callbacks();_this.onHideCallbacks=$.Callbacks();return _this}AbstractSmsVerifyForm.prototype.init=function(parameters){this.$form=parameters.$form;this.namespace=parameters.namespace;this.timer=new Helper.CountDownBlock(this.getTimerElement());this.attachListeners()};AbstractSmsVerifyForm.prototype.getEventDispatcher=function(){return this.eventDispatcher};AbstractSmsVerifyForm.prototype.getNamespace=function(){return this.namespace};AbstractSmsVerifyForm.prototype.sendSmsVerifyCode=function(action){if(!action){action="smsverify~VerifyPhone"}var data={a:action,phone:this.phone,name:this.getUserName()};return $.get("/",data,this.onVerificationCodeSend.bind(this))};AbstractSmsVerifyForm.prototype.resendSmsVerifyCode=function(){return this.sendSmsVerifyCode("smsverify~ResendSmsCode")};AbstractSmsVerifyForm.prototype.start=function(phone,userName){this.resetForm();this.setPhone(phone);this.setUserName(userName);this.sendSmsVerifyCode();this.show()};AbstractSmsVerifyForm.prototype.onVerificationCodeSend=function(data){switch(parseInt(data)){case VerifyPhoneResponseStatus.SEND_SUCCESS:break;case VerifyPhoneResponseStatus.LIMIT_REACHED:this.onSendSmsLimit();break;case VerifyPhoneResponseStatus.SMS_API_PROVIDER_ERROR:break}};AbstractSmsVerifyForm.prototype.onShow=function(callback){this.onShowCallbacks.add(callback)};AbstractSmsVerifyForm.prototype.onHide=function(callback){this.onHideCallbacks.add(callback)};AbstractSmsVerifyForm.prototype.setSkipLink=function(link){this.getSkipLinkElement().attr("href",link)};AbstractSmsVerifyForm.prototype.attachListeners=function(){this.getSubmitElement().on("click",this.onSubmit.bind(this));this.getResendElement().on("click",this.onResendSms.bind(this));this.getChangePhoneElement().on("click",this.onEditPhone.bind(this));this.getSavePhoneElement().on("click",this.onSavePhone.bind(this));this.getSkipLinkElement().on("click",this.onSkipLink.bind(this));this.eventDispatcher.subscribe(this.getEventKeyByName("updatePhone"),this.onUpdatePhone.bind(this))};AbstractSmsVerifyForm.prototype.resetForm=function(){this.setPhone("");this.getChangePhoneElement().removeClass("d_n");this.getSavePhoneElement().add(this.getPhoneNoInputElement()).addClass("d_n")};AbstractSmsVerifyForm.prototype.setPhone=function(phone){this.phone=phone;this.getVerifyPhoneNoElement().html(phone);this.$form.find("[name=phone]").val(phone)};AbstractSmsVerifyForm.prototype.getUserName=function(){return this.userName};AbstractSmsVerifyForm.prototype.setUserName=function(name){this.userName=name};AbstractSmsVerifyForm.prototype.show=function(){this.$form.show();this.onShowCallbacks.fire(this)};AbstractSmsVerifyForm.prototype.hide=function(){this.$form.hide();this.onHideCallbacks.fire(this)};AbstractSmsVerifyForm.prototype.onEditPhone=function(event){event.preventDefault();this.showPhoneEditor();this.getChangePhoneElement().hide()};AbstractSmsVerifyForm.prototype.showPhoneEditor=function(){this.hideVerifyPhoneNoElement();this.hideChangePhoneElement();this.showPhoneNoInputElement();this.showSavePhoneElement()};AbstractSmsVerifyForm.prototype.hidePhoneEditor=function(){this.hidePhoneNoInputElement();this.hideSavePhoneElement();this.showVerifyPhoneNoElement();this.showChangePhoneElement()};AbstractSmsVerifyForm.prototype.onSavePhone=function(event){event.preventDefault();this.hidePhoneEditor();var newPhone=this.getPhone();if(this.phone===newPhone){this.getChangePhoneElement().show();return}this.phone=newPhone;this.getSavePhoneElement().hide();this.hide();this.eventDispatcher.publish(this.getEventKeyByName("updatePhone"))};AbstractSmsVerifyForm.prototype.onUpdatePhone=function(){var phone=this.getPhone();this.getVerifyPhoneNoElement().html(phone)};AbstractSmsVerifyForm.prototype.getPhone=function(){return this.getPhoneNoInputElement().val()};AbstractSmsVerifyForm.prototype.onSendSmsLimit=function(){this.getSkipNotificationElement().show();this.getResendElement().addClass("disabled");this.lockClick=false};AbstractSmsVerifyForm.prototype.onResendSms=function(event){event.preventDefault();if(this.countClick===5){this.onSendSmsLimit();return}if(this.lockClick){this.countClick++;this.lockClick=false;this.startTimer()}};AbstractSmsVerifyForm.prototype.startTimer=function(){this.timer.start(this.countSecondsStart,this.onTimerFinish.bind(this));this.getResendElement().addClass("disabled");this.getTimerElement().show()};AbstractSmsVerifyForm.prototype.onTimerFinish=function(callback){this.lockClick=true;this.getTimerElement().hide();this.getResendElement().removeClass("disabled");this.resendSmsVerifyCode()};AbstractSmsVerifyForm.prototype.onSubmit=function(event){this.eventDispatcher.publish(this.getEventKeyByName("smsSending"));var data=this.buildData();$.getJSON("/?a=smsverify~ValidateCode",data,this.onSubmitCallback.bind(this))};AbstractSmsVerifyForm.prototype.buildData=function(){return{phone:this.phone,code:this.getVerificationCodeElement().val(),cg_id:this.container.has("modelId")?this.container.get("modelId").get():$("input[name=model_id]").val(),cities_id:this.container.has("cityId")?this.container.get("cityId").get():$("select[name=city_id]").val()}};AbstractSmsVerifyForm.prototype.onSubmitCallback=function(data){this.eventDispatcher.publish(this.getEventKeyByName("smsSent"));this.currentValidateCodeResult=data;if(typeof data!=="undefined"){if(data.status==="verified"){if(data.result==="ok"){this.eventDispatcher.publish(this.getEventKeyByName("success"));this.hideOtpErrorMessage()}else{this.eventDispatcher.publish(this.getEventKeyByName("response"))}}else{this.eventDispatcher.publish(this.getEventKeyByName("fail"));this.showOtpErrorMessage()}}};AbstractSmsVerifyForm.prototype.showOtpErrorMessage=function(){this.getOtpErrorMessageDom().removeClass("d_n")};AbstractSmsVerifyForm.prototype.hideOtpErrorMessage=function(){this.getOtpErrorMessageDom().addClass("d_n")};AbstractSmsVerifyForm.prototype.getOtpErrorMessageDom=function(){return this.$form.find('[data-action="invalidOtp"]')};AbstractSmsVerifyForm.prototype.getValidateResult=function(){return this.currentValidateCodeResult};AbstractSmsVerifyForm.prototype.getEventKeyByName=function(eventName){return this.namespace+":"+eventName};AbstractSmsVerifyForm.prototype.getSkipLinkElement=function(){return this.$form.find(".box_verify a.alt_btn")};AbstractSmsVerifyForm.prototype.getSkipNotificationElement=function(){return this.$form.find(".box_resend .skip")};AbstractSmsVerifyForm.prototype.getResendElement=function(){return this.$form.find(".resend")};AbstractSmsVerifyForm.prototype.getChangePhoneElement=function(){return this.$form.find(".change_phone")};AbstractSmsVerifyForm.prototype.showChangePhoneElement=function(){this.getChangePhoneElement().removeClass("d_n")};AbstractSmsVerifyForm.prototype.hideChangePhoneElement=function(){this.getChangePhoneElement().addClass("d_n")};AbstractSmsVerifyForm.prototype.getSavePhoneElement=function(){return this.$form.find(".change_phone_ok")};AbstractSmsVerifyForm.prototype.showSavePhoneElement=function(){this.getSavePhoneElement().removeClass("d_n")};AbstractSmsVerifyForm.prototype.hideSavePhoneElement=function(){this.getSavePhoneElement().addClass("d_n")};AbstractSmsVerifyForm.prototype.getVerifyPhoneNoElement=function(){return this.$form.find(".user_phone")};AbstractSmsVerifyForm.prototype.showVerifyPhoneNoElement=function(){this.getVerifyPhoneNoElement().removeClass("d_n")};AbstractSmsVerifyForm.prototype.hideVerifyPhoneNoElement=function(){this.getVerifyPhoneNoElement().addClass("d_n")};AbstractSmsVerifyForm.prototype.getPhoneNoInputElement=function(){return this.$form.find(".user_phone_input")};AbstractSmsVerifyForm.prototype.showPhoneNoInputElement=function(){this.getPhoneNoInputElement().removeClass("d_n")};AbstractSmsVerifyForm.prototype.hidePhoneNoInputElement=function(){this.getPhoneNoInputElement().addClass("d_n")};AbstractSmsVerifyForm.prototype.getVerificationCodeElement=function(){return this.$form.find("[name=code]")};AbstractSmsVerifyForm.prototype.getTimerElement=function(){return this.$form.find("[data-timer-wrapper]")};AbstractSmsVerifyForm.prototype.getSubmitElement=function(){return this.$form.find("button")};return AbstractSmsVerifyForm}(Form.Form);Form.AbstractSmsVerifyForm=AbstractSmsVerifyForm})(Form||(Form={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Form;(function(Form){var GetOffersSmsVerifyForm=function(_super){__extends(GetOffersSmsVerifyForm,_super);function GetOffersSmsVerifyForm(container){var _this=_super.call(this,container)||this;_this.onSuccessCallbacks=$.Callbacks();_this.onFailCallbacks=$.Callbacks();_this.onUpdatePhoneCallbacks=$.Callbacks();return _this}GetOffersSmsVerifyForm.prototype.onSkipLink=function(){this.verificationSuccessAction()};GetOffersSmsVerifyForm.prototype.onSuccess=function(callback){this.onSuccessCallbacks.add(callback)};GetOffersSmsVerifyForm.prototype.onFail=function(callback){this.onFailCallbacks.add(callback)};GetOffersSmsVerifyForm.prototype.onPhoneUpdate=function(callback){this.onUpdatePhoneCallbacks.add(callback)};GetOffersSmsVerifyForm.prototype.updateChangeNumberLabel=function(label){this.getChangePhoneElement().attr("data-trackevent-label",label)};GetOffersSmsVerifyForm.prototype.onSubmitCallback=function(data){this.currentValidateCodeResult=data;if(data.status==="verified"){this.verificationSuccessAction();if(data.result==="ok"){this.hideOtpErrorMessage()}}else{this.verificationFailAction();this.showOtpErrorMessage()}};GetOffersSmsVerifyForm.prototype.verificationSuccessAction=function(){this.onSuccessCallbacks.fire()};GetOffersSmsVerifyForm.prototype.verificationFailAction=function(){this.onFailCallbacks.fire()};GetOffersSmsVerifyForm.prototype.onUpdatePhone=function(){_super.prototype.onUpdatePhone.call(this);this.onUpdatePhoneCallbacks.fire(this.getPhone())};return GetOffersSmsVerifyForm}(Form.AbstractSmsVerifyForm);Form.GetOffersSmsVerifyForm=GetOffersSmsVerifyForm})(Form||(Form={}));;
var Smartech;(function(Smartech){var ClickHandler=function(){function ClickHandler(dataCollector,dataProxyService){this.dataCollector=dataCollector;this.dataProxy=dataProxyService.getDataProxy()}ClickHandler.prototype.init=function(){this.smartech=window.smartech;var self=this;$(document).on("click",this.getButtonSelector(),function(){var $el=$(this);self.processClick($el)})};ClickHandler.prototype.processClick=function($element){var _this=this;if(typeof this.smartech===null){return}var modelData=this.collectData($element.data());this.dataProxy.loadSmartechData(modelData.modelId).done(function(response){_this.smartech("dispatch",modelData.eventId,response)})};ClickHandler.prototype.collectData=function(dataSet){return $.extend(this.dataCollector.getUserData(),this.getData(dataSet),{eventId:this.getEventId()})};return ClickHandler}();Smartech.ClickHandler=ClickHandler})(Smartech||(Smartech={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Smartech;(function(Smartech){var GopClickHandler=function(_super){__extends(GopClickHandler,_super);function GopClickHandler(){return _super!==null&&_super.apply(this,arguments)||this}GopClickHandler.prototype.getEventId=function(){return 101};GopClickHandler.prototype.getButtonSelector=function(){return'[data-type="gop-button"], [data-type="model_gop"], [data-type="gop_button"], [data-type="offers-gop-button"]'};GopClickHandler.prototype.getData=function(dataSet){return{modelId:dataSet["modelId"]}};return GopClickHandler}(Smartech.ClickHandler);Smartech.GopClickHandler=GopClickHandler})(Smartech||(Smartech={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Smartech;(function(Smartech){var BookingClickHandler=function(_super){__extends(BookingClickHandler,_super);function BookingClickHandler(){return _super!==null&&_super.apply(this,arguments)||this}BookingClickHandler.prototype.getEventId=function(){return 105};BookingClickHandler.prototype.getButtonSelector=function(){return'[data-type="booking"], [data-type="request_button"][data-request-type="Booking"], [data-type="offers-booking"]'};BookingClickHandler.prototype.getData=function(dataSet){return{modelId:dataSet["modelId"]}};return BookingClickHandler}(Smartech.ClickHandler);Smartech.BookingClickHandler=BookingClickHandler})(Smartech||(Smartech={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Smartech;(function(Smartech){var TestDriveClickHandler=function(_super){__extends(TestDriveClickHandler,_super);function TestDriveClickHandler(){return _super!==null&&_super.apply(this,arguments)||this}TestDriveClickHandler.prototype.getEventId=function(){return 106};TestDriveClickHandler.prototype.getButtonSelector=function(){return'[data-type="testdrive"], [data-type="request_button"][data-request-type="Testdrive"], [data-type="offers-testdrive"]'};TestDriveClickHandler.prototype.getData=function(dataSet){return{modelId:dataSet["modelId"]}};return TestDriveClickHandler}(Smartech.ClickHandler);Smartech.TestDriveClickHandler=TestDriveClickHandler})(Smartech||(Smartech={}));;
var Smartech;(function(Smartech){var LeadSubmitHandler=function(){function LeadSubmitHandler(dataCollector,leadSubmitService){this.dataCollector=dataCollector;leadSubmitService.addVisitor(this)}LeadSubmitHandler.prototype.init=function(service){this.service=service};LeadSubmitHandler.prototype.processLeadSubmit=function(leadData){var data=this.collectData(leadData);this.service.send(data)};LeadSubmitHandler.prototype.processLeadData=function(leadData){if(this.support(leadData)){this.processLeadSubmit(leadData)}};LeadSubmitHandler.prototype.processResponse=function(leadData,response){};LeadSubmitHandler.prototype.collectData=function(leadData){return $.extend(this.dataCollector.getUserData(),this.getData(leadData),{eventId:this.getEventId()})};return LeadSubmitHandler}();Smartech.LeadSubmitHandler=LeadSubmitHandler})(Smartech||(Smartech={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Smartech;(function(Smartech){var GOP_LEAD_TYPE="gop";var GopSubmitHandler=function(_super){__extends(GopSubmitHandler,_super);function GopSubmitHandler(){return _super!==null&&_super.apply(this,arguments)||this}GopSubmitHandler.prototype.support=function(leadData){return leadData.hasOwnProperty("lead_type")&&leadData["lead_type"]==GOP_LEAD_TYPE};GopSubmitHandler.prototype.getEventId=function(){return 102};GopSubmitHandler.prototype.processLeadData=function(leadData){};GopSubmitHandler.prototype.processResponse=function(leadData,response){if(this.support(leadData)){this.processLeadSubmit(this.updateLeadData(leadData,response))}};GopSubmitHandler.prototype.updateLeadData=function(leadData,response){var phoneVerified=response.hasOwnProperty("status")&&response["status"]==4;return $.extend({},leadData,{phoneVerified:phoneVerified})};GopSubmitHandler.prototype.getData=function(leadData){return{name:leadData["name"],phone:leadData["phone"],cityId:leadData["city_id"],postcode:leadData["postcode"],planningToBuy:leadData["purchase_date"],modelId:leadData["model_id"],verified:leadData["phoneVerified"]}};return GopSubmitHandler}(Smartech.LeadSubmitHandler);Smartech.GopSubmitHandler=GopSubmitHandler})(Smartech||(Smartech={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Smartech;(function(Smartech){var BOOKING_REQUEST_TYPE="Booking";var BookingSubmitHandler=function(_super){__extends(BookingSubmitHandler,_super);function BookingSubmitHandler(){return _super!==null&&_super.apply(this,arguments)||this}BookingSubmitHandler.prototype.support=function(leadData){return leadData.hasOwnProperty("request_type")&&leadData["request_type"]==BOOKING_REQUEST_TYPE};BookingSubmitHandler.prototype.getEventId=function(){return 104};BookingSubmitHandler.prototype.getData=function(leadData){return{name:leadData["name"],phone:leadData["phone"],cityId:leadData["city_id"],postcode:leadData["postcode"],email:leadData["email"],modelId:leadData["model_id"],showroomId:leadData["showroom_id"],dealerId:leadData["dealer_id"]}};return BookingSubmitHandler}(Smartech.LeadSubmitHandler);Smartech.BookingSubmitHandler=BookingSubmitHandler})(Smartech||(Smartech={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Smartech;(function(Smartech){var TESTDRIVE_REQUEST_TYPE="Testdrive";var TestdriveSubmitHandler=function(_super){__extends(TestdriveSubmitHandler,_super);function TestdriveSubmitHandler(){return _super!==null&&_super.apply(this,arguments)||this}TestdriveSubmitHandler.prototype.support=function(leadData){return leadData.hasOwnProperty("request_type")&&leadData["request_type"]==TESTDRIVE_REQUEST_TYPE};TestdriveSubmitHandler.prototype.getEventId=function(){return 103};TestdriveSubmitHandler.prototype.getData=function(leadData){return{name:leadData["name"],phone:leadData["phone"],cityId:leadData["city_id"],postcode:leadData["postcode"],email:leadData["email"],modelId:leadData["model_id"],showroomId:leadData["showroom_id"],dealerId:leadData["dealer_id"]}};return TestdriveSubmitHandler}(Smartech.LeadSubmitHandler);Smartech.TestdriveSubmitHandler=TestdriveSubmitHandler})(Smartech||(Smartech={}));;
var Smartech;(function(Smartech){var COOKIE_KEY="__stp";var DataCollector=function(){function DataCollector(userInfo,cityDetect){this.userInfo=userInfo;this.cityDetect=cityDetect}DataCollector.prototype.getUserData=function(){return{phone:this.userInfo.getPhone(),email:this.userInfo.getEmail(),name:this.userInfo.getName(),cityId:this.cityDetect.getCityId(),uuid:this.getUuid()}};DataCollector.prototype.getUuid=function(){var cookie=this.getSmartechCookie();if(cookie.hasOwnProperty("uuid")){return cookie["uuid"]}return""};DataCollector.prototype.getSmartechCookie=function(){var cookie=$.cookie(COOKIE_KEY);return cookie?JSON.parse(cookie):{}};return DataCollector}();Smartech.DataCollector=DataCollector})(Smartech||(Smartech={}));;
var Smartech;(function(Smartech){var SmartechService=function(){function SmartechService(baseUrl){this.baseUrl=baseUrl;this.handlers=new Core.Collection}SmartechService.prototype.addHandler=function(handler){this.handlers.add(handler)};SmartechService.prototype.init=function(){var _this=this;this.handlers.forEach(function(handler){handler.init(_this)})};SmartechService.prototype.send=function(data){this.post(data)};SmartechService.prototype.post=function(data){return $.post(this.baseUrl,{activity:JSON.stringify(data)})};return SmartechService}();Smartech.SmartechService=SmartechService})(Smartech||(Smartech={}));;
var Services;(function(Services){var CityDetectService=function(){function CityDetectService(storage,localStorage){this.defaultCityId=1147;this.defaultCityPath="newdelhi";this.defaultCityName="New Delhi";this.defaultSolrCityId="city|newdelhi-1147";this.options={path:"/",expires:365};this.storage=storage;this.localStorage=localStorage}CityDetectService.prototype.isConfirmed=function(){return parseInt(this.storage.get("cityIsConfirmed"))};CityDetectService.prototype.setConfirmed=function(){this.storage.set("cityIsConfirmed",1)};CityDetectService.prototype.isDetectedOnce=function(){return this.storage.get("cityDetectedOnce")};CityDetectService.prototype.setCityDetectedOnce=function(){this.storage.set("cityDetectedOnce",true)};CityDetectService.prototype.setReferrerUrl=function(url){this.localStorage.set("referrer",url)};CityDetectService.prototype.getReferrerUrl=function(){return this.localStorage.get("referrer")};CityDetectService.prototype.getCityId=function(){var cityId=parseInt(this.storage.get("cityId"));if(cityId>0){return cityId}else{return this.defaultCityId}};CityDetectService.prototype.getSolrCityId=function(){var id=null;if(this.getCityPath()){id="city|"+this.getCityPath()+"-"+this.getCityId()}else{id=this.defaultSolrCityId}return id};CityDetectService.prototype.getCityName=function(){return this.storage.get("cityName")||this.defaultCityName};CityDetectService.prototype.getCityPath=function(){return this.storage.get("city")};CityDetectService.prototype.getDefaultCityPath=function(){return this.defaultCityPath};CityDetectService.prototype.setCityName=function(cityName){return this.storage.set("cityName",cityName)};CityDetectService.prototype.setCityPath=function(cityPath){return this.storage.set("city",cityPath)};CityDetectService.prototype.setCityId=function(cityId){return this.storage.set("cityId",cityId)};CityDetectService.prototype.getBookingCities=function(){return["newdelhi","gurgaon","mumbai","bangalore","faridabad","noida","ghaziabad","lucknow","kolkata","hyderabad","New Delhi","Gurgaon","Mumbai","Bangalore","Faridabad","Noida","Ghaziabad","Lucknow","Kolkata","Hyderabad"]};CityDetectService.prototype.isBookingCity=function(_city){var cities=this.getBookingCities();var city=_city||this.getCityPath();return!!~cities.indexOf(city)};return CityDetectService}();Services.CityDetectService=CityDetectService})(Services||(Services={}));;
var Leads;(function(Leads){var LeadSubmitService=function(){function LeadSubmitService(eventDispatcher){this.eventDispatcher=eventDispatcher;this.visitors=new Core.Collection}LeadSubmitService.prototype.addVisitor=function(visitor){this.visitors.add(visitor)};LeadSubmitService.prototype.submit=function(link,data,dataType){var _this=this;this.processLeadData(data);return $.post(link,data,function(response){_this.processResponse(data,response)},dataType)};LeadSubmitService.prototype.getJSON=function(link,data){var _this=this;this.processLeadData(data);return $.getJSON(link,data,function(response){_this.processResponse(data,response)})};LeadSubmitService.prototype.processLeadData=function(data){this.visitors.forEach(function(visitor){visitor.processLeadData(data)})};LeadSubmitService.prototype.processResponse=function(leadData,response){this.visitors.forEach(function(visitor){visitor.processResponse(leadData,response)})};return LeadSubmitService}();Leads.LeadSubmitService=LeadSubmitService})(Leads||(Leads={}));;
jQuery.fn.bindFirst=function(type,parameters,fn){type=type.split(/\s+/);this.each(function(){var len=type.length;while(len--){if(typeof parameters==="function")jQuery(this).bind(type[len],parameters);else jQuery(this).bind(type[len],parameters,fn);var evt=jQuery._data(this,"events")[type[len]];evt.splice(0,0,evt.pop())}})};;
var Form;(function(Form){var ValidatorRules=function(){function ValidatorRules(){}ValidatorRules.init=function(validator){validator.addMethod("onlyLetters",this.getOnlyLetters());validator.addMethod("alphanumeric",this.getAlphanumeric());validator.addMethod("regexp",this.getRegexp());validator.addMethod("adultAge",this.getAdultAgeMethod());validator.addMethod("dateFormatDMY",this.getDateFormatDMY());validator.addMethod("validAutoComplete",this.getValidAutoComplete());validator.addMethod("validAutoCompleteLabelId",this.getValidAutoCompleteLabelId());validator.addMethod("CarLoanCompanyName",this.getCarLoanCompanyName());validator.addMethod("callback",this.getCallback())};ValidatorRules.getCallback=function(){return function(value,element,param){return param.hasOwnProperty("valid")?param.valid:true}};ValidatorRules.getOnlyLetters=function(){return function(value,element,param){return this.optional(element)||/^[a-z ]+$/i.test(value)}};ValidatorRules.getAlphanumeric=function(){return function(value,element,param){return this.optional(element)||/^[a-z0-9 ]+$/i.test(value)}};ValidatorRules.getRegexp=function(){return function(value,element,param){return new RegExp(param).test(value)}};ValidatorRules.getAdultAgeMethod=function(){return function(value,element,param){var birthDate=Helper.DateHelper.parseDMYDate(value);var today=new Date;var age=today.getFullYear()-birthDate.getFullYear();var m=today.getMonth()-birthDate.getMonth();if(m<0||m===0&&today.getDate()<birthDate.getDate()){age--}return ValidatorRules.ADULT_MIN_AGE<=age&&age<=ValidatorRules.ADULT_MAX_AGE}};ValidatorRules.getDateFormatDMY=function(){return function(value,element,param){if(this.optional(element)){return true}var pattern=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(pattern.test(value)){var dateParts=value.split("/");var day=parseInt(dateParts[0],10);var month=parseInt(dateParts[1],10);var year=parseInt(dateParts[2],10);var date=new Date(year,month-1,day,12,0,0,0);return date.getUTCFullYear()===year&&date.getUTCMonth()===month-1&&date.getUTCDate()===day}return false}};ValidatorRules.getValidAutoComplete=function(){return function(value,element,param){return this.optional(element)||$.inArray(value,param)!==-1}};ValidatorRules.getValidAutoCompleteLabelId=function(){return function(value,element,param){if(this.optional(element)){return true}var collection=param.collection;var target=param.idElement;for(var i=0;i<collection.length;i++){if(value===collection[i].label){return target.val()===collection[i].id}}return false}};ValidatorRules.getCarLoanCompanyName=function(){return function(value,element,param){return this.optional(element)||/^[a-z0-9\- ,.&]+$/i.test(value)}};ValidatorRules.ADULT_MIN_AGE=21;ValidatorRules.ADULT_MAX_AGE=65;return ValidatorRules}();Form.ValidatorRules=ValidatorRules})(Form||(Form={}));;
(function(jQuery,undefined){var oldManip=jQuery.fn.domManip,tmplItmAtt="_tmplitem",htmlExpr=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,newTmplItems={},wrappedItems={},appendToTmplItems,topTmplItem={key:0,data:{}},itemKey=0,cloneIndex=0,stack=[];function newTmplItem(options,parentItem,fn,data){var newItem={data:data||(data===0||data===false)?data:parentItem?parentItem.data:{},_wrap:parentItem?parentItem._wrap:null,tmpl:null,parent:parentItem||null,nodes:[],calls:tiCalls,nest:tiNest,wrap:tiWrap,html:tiHtml,update:tiUpdate};if(options){jQuery.extend(newItem,options,{nodes:[],parent:parentItem})}if(fn){newItem.tmpl=fn;newItem._ctnt=newItem._ctnt||newItem.tmpl(jQuery,newItem);newItem.key=++itemKey;(stack.length?wrappedItems:newTmplItems)[itemKey]=newItem}return newItem}jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),elems,i,l,tmplItems,parent=this.length===1&&this[0].parentNode;appendToTmplItems=newTmplItems||{};if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);ret=this}else{for(i=0,l=insert.length;i<l;i++){cloneIndex=i;elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}cloneIndex=0;ret=this.pushStack(ret,name,insert.selector)}tmplItems=appendToTmplItems;appendToTmplItems=null;jQuery.tmpl.complete(tmplItems);return ret}});jQuery.fn.extend({tmpl:function(data,options,parentItem){return jQuery.tmpl(this[0],data,options,parentItem)},tmplItem:function(){return jQuery.tmplItem(this[0])},template:function(name){return jQuery.template(name,this[0])},domManip:function(args,table,callback,options){if(args[0]&&jQuery.isArray(args[0])){var dmArgs=jQuery.makeArray(arguments),elems=args[0],elemsLength=elems.length,i=0,tmplItem;while(i<elemsLength&&!(tmplItem=jQuery.data(elems[i++],"tmplItem"))){}if(tmplItem&&cloneIndex){dmArgs[2]=function(fragClone){jQuery.tmpl.afterManip(this,fragClone,callback)}}oldManip.apply(this,dmArgs)}else{oldManip.apply(this,arguments)}cloneIndex=0;if(!appendToTmplItems){jQuery.tmpl.complete(newTmplItems)}return this}});jQuery.extend({tmpl:function(tmpl,data,options,parentItem){var ret,topLevel=!parentItem;if(topLevel){parentItem=topTmplItem;tmpl=jQuery.template[tmpl]||jQuery.template(null,tmpl);wrappedItems={}}else if(!tmpl){tmpl=parentItem.tmpl;newTmplItems[parentItem.key]=parentItem;parentItem.nodes=[];if(parentItem.wrapped){updateWrapped(parentItem,parentItem.wrapped)}return jQuery(build(parentItem,null,parentItem.tmpl(jQuery,parentItem)))}if(!tmpl){return[]}if(typeof data==="function"){data=data.call(parentItem||{})}if(options&&options.wrapped){updateWrapped(options,options.wrapped)}ret=jQuery.isArray(data)?jQuery.map(data,function(dataItem){return dataItem?newTmplItem(options,parentItem,tmpl,dataItem):null}):[newTmplItem(options,parentItem,tmpl,data)];return topLevel?jQuery(build(parentItem,null,ret)):ret},tmplItem:function(elem){var tmplItem;if(elem instanceof jQuery){elem=elem[0]}while(elem&&elem.nodeType===1&&!(tmplItem=jQuery.data(elem,"tmplItem"))&&(elem=elem.parentNode)){}return tmplItem||topTmplItem},template:function(name,tmpl){if(tmpl){if(typeof tmpl==="string"){tmpl=buildTmplFn(tmpl)}else if(tmpl instanceof jQuery){tmpl=tmpl[0]||{}}if(tmpl.nodeType){tmpl=jQuery.data(tmpl,"tmpl")||jQuery.data(tmpl,"tmpl",buildTmplFn(tmpl.innerHTML))}return typeof name==="string"?jQuery.template[name]=tmpl:tmpl}return name?typeof name!=="string"?jQuery.template(null,name):jQuery.template[name]||jQuery.template(null,htmlExpr.test(name)?name:jQuery(name)):null},encode:function(text){return(""+text).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});jQuery.extend(jQuery.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(items){newTmplItems={}},afterManip:function afterManip(elem,fragClone,callback){var content=fragClone.nodeType===11?jQuery.makeArray(fragClone.childNodes):fragClone.nodeType===1?[fragClone]:[];callback.call(elem,fragClone);storeTmplItems(content);cloneIndex++}});function build(tmplItem,nested,content){var frag,ret=content?jQuery.map(content,function(item){return typeof item==="string"?tmplItem.key?item.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+tmplItmAtt+'="'+tmplItem.key+'" $2'):item:build(item,tmplItem,item._ctnt)}):tmplItem;if(nested){return ret}ret=ret.join("");ret.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(all,before,middle,after){frag=jQuery(middle).get();storeTmplItems(frag);if(before){frag=unencode(before).concat(frag)}if(after){frag=frag.concat(unencode(after))}});return frag?frag:unencode(ret)}function unencode(text){var el=document.createElement("div");el.innerHTML=text;return jQuery.makeArray(el.childNodes)}function buildTmplFn(markup){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;"+"with($data){__.push('"+jQuery.trim(markup).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(all,slash,type,fnargs,target,parens,args){var tag=jQuery.tmpl.tag[type],def,expr,exprAutoFnDetect;if(!tag){throw"Unknown template tag: "+type}def=tag._default||[];if(parens&&!/\w$/.test(target)){target+=parens;parens=""}if(target){target=unescape(target);args=args?","+unescape(args)+")":parens?")":"";expr=parens?target.indexOf(".")>-1?target+unescape(parens):"("+target+").call($item"+args:target;exprAutoFnDetect=parens?expr:"(typeof("+target+")==='function'?("+target+").call($item):("+target+"))"}else{exprAutoFnDetect=expr=def.$1||"null"}fnargs=unescape(fnargs);return"');"+tag[slash?"close":"open"].split("$notnull_1").join(target?"typeof("+target+")!=='undefined' && ("+target+")!=null":"true").split("$1a").join(exprAutoFnDetect).split("$1").join(expr).split("$2").join(fnargs||def.$2||"")+"__.push('"})+"');}return __;")}function updateWrapped(options,wrapped){options._wrap=build(options,true,jQuery.isArray(wrapped)?wrapped:[htmlExpr.test(wrapped)?wrapped:jQuery(wrapped).html()]).join("")}function unescape(args){return args?args.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function outerHtml(elem){var div=document.createElement("div");div.appendChild(elem.cloneNode(true));return div.innerHTML}function storeTmplItems(content){var keySuffix="_"+cloneIndex,elem,elems,newClonedItems={},i,l,m;for(i=0,l=content.length;i<l;i++){if((elem=content[i]).nodeType!==1){continue}elems=elem.getElementsByTagName("*");for(m=elems.length-1;m>=0;m--){processItemKey(elems[m])}processItemKey(elem)}function processItemKey(el){var pntKey,pntNode=el,pntItem,tmplItem,key;if(key=el.getAttribute(tmplItmAtt)){while(pntNode.parentNode&&(pntNode=pntNode.parentNode).nodeType===1&&!(pntKey=pntNode.getAttribute(tmplItmAtt))){}if(pntKey!==key){pntNode=pntNode.parentNode?pntNode.nodeType===11?0:pntNode.getAttribute(tmplItmAtt)||0:0;if(!(tmplItem=newTmplItems[key])){tmplItem=wrappedItems[key];tmplItem=newTmplItem(tmplItem,newTmplItems[pntNode]||wrappedItems[pntNode]);tmplItem.key=++itemKey;newTmplItems[itemKey]=tmplItem}if(cloneIndex){cloneTmplItem(key)}}el.removeAttribute(tmplItmAtt)}else if(cloneIndex&&(tmplItem=jQuery.data(el,"tmplItem"))){cloneTmplItem(tmplItem.key);newTmplItems[tmplItem.key]=tmplItem;pntNode=jQuery.data(el.parentNode,"tmplItem");pntNode=pntNode?pntNode.key:0}if(tmplItem){pntItem=tmplItem;while(pntItem&&pntItem.key!=pntNode){pntItem.nodes.push(el);pntItem=pntItem.parent}delete tmplItem._ctnt;delete tmplItem._wrap;jQuery.data(el,"tmplItem",tmplItem)}function cloneTmplItem(key){key=key+keySuffix;tmplItem=newClonedItems[key]=newClonedItems[key]||newTmplItem(tmplItem,newTmplItems[tmplItem.parent.key+keySuffix]||tmplItem.parent)}}}function tiCalls(content,tmpl,data,options){if(!content){return stack.pop()}stack.push({_:content,tmpl:tmpl,item:this,data:data,options:options})}function tiNest(tmpl,data,options){return jQuery.tmpl(jQuery.template(tmpl),data,options,this)}function tiWrap(call,wrapped){var options=call.options||{};options.wrapped=wrapped;return jQuery.tmpl(jQuery.template(call.tmpl),call.data,options,call.item)}function tiHtml(filter,textOnly){var wrapped=this._wrap;return jQuery.map(jQuery(jQuery.isArray(wrapped)?wrapped.join(""):wrapped).filter(filter||"*"),function(e){return textOnly?e.innerText||e.textContent:e.outerHTML||outerHtml(e)})}function tiUpdate(){var coll=this.nodes;jQuery.tmpl(null,null,null,this).insertBefore(coll[0]);jQuery(coll).remove()}})(jQuery);;
(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var a,n,r,o=t.nodeName.toLowerCase();return"area"===o?(a=t.parentNode,n=a.name,t.href&&n&&"map"===a.nodeName.toLowerCase()?(r=e("img[usemap='#"+n+"']")[0],!!r&&i(r)):!1):(/^(input|select|textarea|button|object)$/.test(o)?!t.disabled:"a"===o?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function a(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=n(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",r)}function r(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function o(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,a=t?/(auto|scroll|hidden)/:/(auto|scroll)/,n=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:a.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&n.length?n:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),a=isNaN(s);return(a||s>=0)&&t(i,!a)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,n){return e.each(a,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),n&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var a="Width"===i?["Left","Right"]:["Top","Bottom"],n=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?r["inner"+i].call(this):this.each(function(){e(this).css(n,s(this,t)+"px")})},e.fn["outer"+i]=function(t,a){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){e(this).css(n,s(this,t,!0,a)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,a=e(this[0]);a.length&&a[0]!==document;){if(i=a.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(a.css("zIndex"),10),!isNaN(s)&&0!==s))return s;a=a.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var a,n=e.ui[t].prototype;for(a in s)n.plugins[a]=n.plugins[a]||[],n.plugins[a].push([i,s[a]])},call:function(e,t,i,s){var a,n=e.plugins[t];if(n&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(a=0;n.length>a;a++)e.options[n[a][0]]&&n[a][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,a,n;for(n=0;null!=(a=i[n]);n++)try{s=e._data(a,"events"),s&&s.remove&&e(a).triggerHandler("remove")}catch(r){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var a,n,r,o,h={},l=t.split(".")[0];return t=t.split(".")[1],a=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[l]=e[l]||{},n=e[l][t],r=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new r(e,t)},e.extend(r,n,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),o=new i,o.options=e.widget.extend({},o.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},a=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,n=this._superApply;return this._super=e,this._superApply=a,t=s.apply(this,arguments),this._super=i,this._superApply=n,t}}(),void 0):(h[t]=s,void 0)}),r.prototype=e.widget.extend(o,{widgetEventPrefix:n?o.widgetEventPrefix||t:t},h,{constructor:r,namespace:l,widgetName:t,widgetFullName:a}),n?(e.each(n._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,r,i._proto)}),delete n._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r),r},e.widget.extend=function(t){for(var i,s,a=u.call(arguments,1),n=0,r=a.length;r>n;n++)for(i in a[n])s=a[n][i],a[n].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(a){var n="string"==typeof a,r=u.call(arguments,1),o=this;return n?this.each(function(){var i,n=e.data(this,s);return"instance"===a?(o=n,!1):n?e.isFunction(n[a])&&"_"!==a.charAt(0)?(i=n[a].apply(n,r),i!==n&&void 0!==i?(o=i&&i.jquery?o.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+a+"'")}):(r.length&&(a=e.widget.extend.apply(null,[a].concat(r))),this.each(function(){var t=e.data(this,s);t?(t.option(a||{}),t._init&&t._init()):e.data(this,s,new i(a,this))})),o}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,a,n,r=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(r={},s=t.split("."),t=s.shift(),s.length){for(a=r[t]=e.widget.extend({},this.options[t]),n=0;s.length-1>n;n++)a[s[n]]=a[s[n]]||{},a=a[s[n]];if(t=s.pop(),1===arguments.length)return void 0===a[t]?null:a[t];a[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];r[t]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var a,n=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=a=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,a=this.widget()),e.each(s,function(s,r){function o(){return t||n.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof r?n[r]:r).apply(n,arguments):void 0}"string"!=typeof r&&(o.guid=r.guid=r.guid||o.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+n.eventNamespace,u=h[2];u?a.delegate(u,l,o):i.bind(l,o)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var a,n,r=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],n=i.originalEvent)for(a in n)a in i||(i[a]=n[a]);return this.element.trigger(i,s),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,a,n){"string"==typeof a&&(a={effect:a});var r,o=a?a===!0||"number"==typeof a?i:a.effect||i:t;a=a||{},"number"==typeof a&&(a={duration:a}),r=!e.isEmptyObject(a),a.complete=n,a.delay&&s.delay(a.delay),r&&e.effects&&e.effects.effect[o]?s[t](a):o!==t&&s[o]?s[o](a.duration,a.easing,n):s.queue(function(i){e(this)[t](),n&&n.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,a="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!a&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var a,n,r=Math.max,o=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==a)return a;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=s.children()[0];return e("body").append(s),t=n.offsetWidth,s.css("overflow","scroll"),i=n.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),a=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),a="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,n="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:n?e.position.scrollbarWidth():0,height:a?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),a=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:a,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||a?i.width():i.outerWidth(),height:s||a?i.height():i.outerHeight()}}},e.fn.position=function(a){if(!a||!a.of)return f.apply(this,arguments);a=e.extend({},a);var p,m,g,v,y,b,_=e(a.of),x=e.position.getWithinInfo(a.within),w=e.position.getScrollInfo(x),k=(a.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(a.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(a[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],a[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===a.at[0]?y.left+=m:"center"===a.at[0]&&(y.left+=m/2),"bottom"===a.at[1]?y.top+=g:"center"===a.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),N=t(T.my,u.outerWidth(),u.outerHeight());"right"===a.my[0]?M.left-=d:"center"===a.my[0]&&(M.left-=d/2),"bottom"===a.my[1]?M.top-=c:"center"===a.my[1]&&(M.top-=c/2),M.left+=N[0],M.top+=N[1],n||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+N[0],p[1]+N[1]],my:a.my,at:a.at,within:x,elem:u})}),a.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,n=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>n?"top":s>0?"bottom":"middle"};d>m&&m>o(t+i)&&(h.horizontal="center"),c>g&&g>o(s+n)&&(h.vertical="middle"),h.important=r(o(t),o(i))>r(o(s),o(n))?"horizontal":"vertical",a.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,a=s.isWindow?s.scrollLeft:s.offset.left,n=s.width,o=e.left-t.collisionPosition.marginLeft,h=a-o,l=o+t.collisionWidth-n-a;t.collisionWidth>n?h>0&&0>=l?(i=e.left+h+t.collisionWidth-n-a,e.left+=h-i):e.left=l>0&&0>=h?a:h>l?a+n-t.collisionWidth:a:h>0?e.left+=h:l>0?e.left-=l:e.left=r(e.left-o,e.left)},top:function(e,t){var i,s=t.within,a=s.isWindow?s.scrollTop:s.offset.top,n=t.within.height,o=e.top-t.collisionPosition.marginTop,h=a-o,l=o+t.collisionHeight-n-a;t.collisionHeight>n?h>0&&0>=l?(i=e.top+h+t.collisionHeight-n-a,e.top+=h-i):e.top=l>0&&0>=h?a:h>l?a+n-t.collisionHeight:a:h>0?e.top+=h:l>0?e.top-=l:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var i,s,a=t.within,n=a.offset.left+a.scrollLeft,r=a.width,h=a.isWindow?a.scrollLeft:a.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-r-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-r-n,(0>i||o(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>o(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,a=t.within,n=a.offset.top+a.scrollTop,r=a.height,h=a.isWindow?a.scrollTop:a.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-r-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-r-n,(0>s||o(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,(i>0||d>o(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,a,r,o=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(o?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in s)t.style[r]=s[r];t.appendChild(h),i=o||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",a=e(h).offset().left,n=a>10&&11>a,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),a=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return a.parents("body").length||a.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&a[0]===this.element[0]&&this._setPositionRelative(),a[0]===this.element[0]||/(fixed|absolute)/.test(a.css("position"))||a.css("position","absolute"),a},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,a=this.options,n=this.document[0];return this.relativeContainer=null,a.containment?"window"===a.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===a.containment?(this.containment=[0,0,e(n).width()-this.helperProportions.width-this.margins.left,(e(n).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):a.containment.constructor===Array?(this.containment=a.containment,void 0):("parent"===a.containment&&(a.containment=this.helper[0].parentNode),i=e(a.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,a,n,r=this.options,o=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return o&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),r.grid&&(a=r.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,l=i?a-this.offset.click.top>=i[1]||a-this.offset.click.top>i[3]?a:a-this.offset.click.top>=i[1]?a-r.grid[1]:a+r.grid[1]:a,n=r.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,h=i?n-this.offset.click.left>=i[0]||n-this.offset.click.left>i[2]?n:n-this.offset.click.left>=i[0]?n-r.grid[0]:n+r.grid[0]:n),"y"===r.axis&&(h=this.originalPageX),"x"===r.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:o?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:o?0:this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var a=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,a))})},stop:function(t,i,s){var a=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,a))})},drag:function(t,i,s){e.each(s.sortables,function(){var a=!1,n=this;n.positionAbs=s.positionAbs,n.helperProportions=s.helperProportions,n.offset.click=s.offset.click,n._intersectsWith(n.containerCache)&&(a=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==n&&this._intersectsWith(this.containerCache)&&e.contains(n.element[0],this.element[0])&&(a=!1),a})),a?(n.isOver||(n.isOver=1,s._parent=i.helper.parent(),n.currentItem=i.helper.appendTo(n.element).data("ui-sortable-item",!0),n.options._helper=n.options.helper,n.options.helper=function(){return i.helper[0]},t.target=n.currentItem[0],n._mouseCapture(t,!0),n._mouseStart(t,!0,!0),n.offset.click.top=s.offset.click.top,n.offset.click.left=s.offset.click.left,n.offset.parent.left-=s.offset.parent.left-n.offset.parent.left,n.offset.parent.top-=s.offset.parent.top-n.offset.parent.top,s._trigger("toSortable",t),s.dropped=n.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,n.fromOutside=s),n.currentItem&&(n._mouseDrag(t),i.position=n.position)):n.isOver&&(n.isOver=0,n.cancelHelperRemoval=!0,n.options._revert=n.options.revert,n.options.revert=!1,n._trigger("out",t,n._uiHash(n)),n._mouseStop(t,!0),n.options.revert=n.options._revert,n.options.helper=n.options._helper,n.placeholder&&n.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var a=e("body"),n=s.options;a.css("cursor")&&(n._cursor=a.css("cursor")),a.css("cursor",n.cursor)},stop:function(t,i,s){var a=s.options;a._cursor&&e("body").css("cursor",a._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var a=e(i.helper),n=s.options;a.css("opacity")&&(n._opacity=a.css("opacity")),a.css("opacity",n.opacity)},stop:function(t,i,s){var a=s.options;a._opacity&&e(i.helper).css("opacity",a._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var a=s.options,n=!1,r=s.scrollParentNotHidden[0],o=s.document[0];r!==o&&"HTML"!==r.tagName?(a.axis&&"x"===a.axis||(s.overflowOffset.top+r.offsetHeight-t.pageY<a.scrollSensitivity?r.scrollTop=n=r.scrollTop+a.scrollSpeed:t.pageY-s.overflowOffset.top<a.scrollSensitivity&&(r.scrollTop=n=r.scrollTop-a.scrollSpeed)),a.axis&&"y"===a.axis||(s.overflowOffset.left+r.offsetWidth-t.pageX<a.scrollSensitivity?r.scrollLeft=n=r.scrollLeft+a.scrollSpeed:t.pageX-s.overflowOffset.left<a.scrollSensitivity&&(r.scrollLeft=n=r.scrollLeft-a.scrollSpeed))):(a.axis&&"x"===a.axis||(t.pageY-e(o).scrollTop()<a.scrollSensitivity?n=e(o).scrollTop(e(o).scrollTop()-a.scrollSpeed):e(window).height()-(t.pageY-e(o).scrollTop())<a.scrollSensitivity&&(n=e(o).scrollTop(e(o).scrollTop()+a.scrollSpeed))),a.axis&&"y"===a.axis||(t.pageX-e(o).scrollLeft()<a.scrollSensitivity?n=e(o).scrollLeft(e(o).scrollLeft()-a.scrollSpeed):e(window).width()-(t.pageX-e(o).scrollLeft())<a.scrollSensitivity&&(n=e(o).scrollLeft(e(o).scrollLeft()+a.scrollSpeed)))),n!==!1&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var a=s.options;s.snapElements=[],e(a.snap.constructor!==String?a.snap.items||":data(ui-draggable)":a.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var a,n,r,o,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(a=m>=Math.abs(u-b),n=m>=Math.abs(d-y),r=m>=Math.abs(h-v),o=m>=Math.abs(l-g),a&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),n&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=a||n||r||o,"outer"!==f.snapMode&&(a=m>=Math.abs(u-y),n=m>=Math.abs(d-b),r=m>=Math.abs(h-g),o=m>=Math.abs(l-v),a&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),n&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(a||n||r||o||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=a||n||r||o||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var a,n=s.options,r=e.makeArray(e(n.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});r.length&&(a=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(t){e(this).css("zIndex",a+t)}),this.css("zIndex",a+r.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var a=e(i.helper),n=s.options;a.css("zIndex")&&(n._zIndex=a.css("zIndex")),a.css("zIndex",n.zIndex)},stop:function(t,i,s){var a=s.options;a._zIndex&&e(i.helper).css("zIndex",a._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,a=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(a=!0,!1):void 0}),a?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,a){if(!i.offset)return!1;var n=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,o=n+t.helperProportions.width,h=r+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return n>=l&&d>=o&&r>=u&&c>=h;case"intersect":return n+t.helperProportions.width/2>l&&d>o-t.helperProportions.width/2&&r+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(a.pageY,u,i.proportions().height)&&e(a.pageX,l,i.proportions().width);case"touch":return(r>=u&&c>=r||h>=u&&c>=h||u>r&&h>c)&&(n>=l&&d>=n||o>=l&&d>=o||l>n&&o>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,a,n=e.ui.ddmanager.droppables[t.options.scope]||[],r=i?i.type:null,o=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;n.length>s;s++)if(!(n[s].options.disabled||t&&!n[s].accept.call(n[s].element[0],t.currentItem||t.element))){for(a=0;o.length>a;a++)if(o[a]===n[s].element[0]){n[s].proportions().height=0;continue e}n[s].visible="none"!==n[s].element.css("display"),n[s].visible&&("mousedown"===r&&n[s]._activate.call(n[s],i),n[s].offset=n[s].element.offset(),n[s].proportions({width:n[s].element[0].offsetWidth,height:n[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,a,n,r=e.ui.intersect(t,this,this.options.tolerance,i),o=!r&&this.isover?"isout":r&&!this.isover?"isover":null;o&&(this.options.greedy&&(a=this.options.scope,n=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===a}),n.length&&(s=e(n[0]).droppable("instance"),s.greedyChild="isover"===o)),s&&"isover"===o&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[o]=!0,this["isout"===o?"isover":"isout"]=!1,this["isover"===o?"_over":"_out"].call(this,i),s&&"isout"===o&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",a=!1;return t[s]>0?!0:(t[s]=1,a=t[s]>0,t[s]=0,a)},_create:function(){var t,i,s,a,n,r=this,o=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),n="ui-resizable-"+s,a=e("<div class='ui-resizable-handle "+n+"'></div>"),a.css({zIndex:o.zIndex}),"se"===s&&a.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(a);this._renderAxis=function(t){var i,s,a,n;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=e(this.handles[i]),this._on(this.handles[i],{mousedown:r._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=e(this.handles[i],this.element),n=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),a=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(a,n),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){r.resizing||(this.className&&(a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=a&&a[1]?a[1]:"se")}),o.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||(e(this).removeClass("ui-resizable-autohide"),r._handles.show())}).mouseleave(function(){o.disabled||r.resizing||(e(this).addClass("ui-resizable-autohide"),r._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,a=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(a=!0);return!this.options.disabled&&a},_mouseStart:function(t){var i,s,a,n=this.options,r=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),n.containment&&(i+=e(n.containment).scrollLeft()||0,s+=e(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,a=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===a?this.axis+"-resize":a),r.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,a=this.originalMousePosition,n=this.axis,r=t.pageX-a.left||0,o=t.pageY-a.top||0,h=this._change[n];return this._updatePrevProperties(),h?(i=h.apply(this,[t,r,o]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,a,n,r,o,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),a=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,n=s?0:u.sizeDiff.width,r={width:u.helper.width()-n,height:u.helper.height()-a},o=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(r,{top:h,left:o})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,a,n,r=this.options;n={minWidth:this._isNumber(r.minWidth)?r.minWidth:0,maxWidth:this._isNumber(r.maxWidth)?r.maxWidth:1/0,minHeight:this._isNumber(r.minHeight)?r.minHeight:0,maxHeight:this._isNumber(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||e)&&(t=n.minHeight*this.aspectRatio,s=n.minWidth/this.aspectRatio,i=n.maxHeight*this.aspectRatio,a=n.maxWidth/this.aspectRatio,t>n.minWidth&&(n.minWidth=t),s>n.minHeight&&(n.minHeight=s),n.maxWidth>i&&(n.maxWidth=i),n.maxHeight>a&&(n.maxHeight=a)),this._vBoundaries=n},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,a=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,n=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,r=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,o=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return n&&(e.width=t.minWidth),r&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),a&&(e.height=t.maxHeight),n&&l&&(e.left=o-t.minWidth),s&&l&&(e.left=o-t.maxWidth),r&&u&&(e.top=h-t.minHeight),a&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],a=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(a[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,a=this.originalPosition;return{top:a.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,a=i._proportionallyResizeElements,n=a.length&&/textarea/i.test(a[0].nodeName),r=n&&i._hasScroll(a[0],"left")?0:i.sizeDiff.height,o=n?0:i.sizeDiff.width,h={width:i.size.width-o,height:i.size.height-r},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};a&&a.length&&e(a[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,a,n,r,o,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,a=h.containerSize.height,n=h.containerSize.width,r=h._hasScroll(c,"left")?c.scrollWidth:n,o=h._hasScroll(c)?c.scrollHeight:a,h.parentData={element:c,left:s.left,top:s.top,width:r,height:o}))},resize:function(t){var i,s,a,n,r=e(this).resizable("instance"),o=r.options,h=r.containerOffset,l=r.position,u=r._aspectRatio||t.shiftKey,d={top:0,left:0},c=r.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(r._helper?h.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-h.left:r.position.left-d.left),u&&(r.size.height=r.size.width/r.aspectRatio,p=!1),r.position.left=o.helper?h.left:0),l.top<(r._helper?h.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-h.top:r.position.top),u&&(r.size.width=r.size.height*r.aspectRatio,p=!1),r.position.top=r._helper?h.top:0),a=r.containerElement.get(0)===r.element.parent().get(0),n=/relative|absolute/.test(r.containerElement.css("position")),a&&n?(r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top):(r.offset.left=r.element.offset().left,r.offset.top=r.element.offset().top),i=Math.abs(r.sizeDiff.width+(r._helper?r.offset.left-d.left:r.offset.left-h.left)),s=Math.abs(r.sizeDiff.height+(r._helper?r.offset.top-d.top:r.offset.top-h.top)),i+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-i,u&&(r.size.height=r.size.width/r.aspectRatio,p=!1)),s+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-s,u&&(r.size.width=r.size.height*r.aspectRatio,p=!1)),p||(r.position.left=r.prevPosition.left,r.position.top=r.prevPosition.top,r.size.width=r.prevSize.width,r.size.height=r.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,a=t.containerPosition,n=t.containerElement,r=e(t.helper),o=r.offset(),h=r.outerWidth()-t.sizeDiff.width,l=r.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(n.css("position"))&&e(this).css({left:o.left-a.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(n.css("position"))&&e(this).css({left:o.left-a.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options;e(i.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})},resize:function(t,i){var s=e(this).resizable("instance"),a=s.options,n=s.originalSize,r=s.originalPosition,o={height:s.size.height-n.height||0,width:s.size.width-n.width||0,top:s.position.top-r.top||0,left:s.position.left-r.left||0};e(a.alsoResize).each(function(){var t=e(this),s=e(this).data("ui-resizable-alsoresize"),a={},n=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(n,function(e,t){var i=(s[t]||0)+(o[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,a=i.size,n=i.originalSize,r=i.originalPosition,o=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((a.width-n.width)/l)*l,c=Math.round((a.height-n.height)/u)*u,p=n.width+d,f=n.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(o)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(o)?(i.size.width=p,i.size.height=f,i.position.top=r.top-c):/^(sw)$/.test(o)?(i.size.width=p,i.size.height=f,i.position.left=r.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=r.top-c):(f=u-t.height,i.size.height=f,i.position.top=r.top+n.height-f),p-l>0?(i.size.width=p,i.position.left=r.left-d):(p=l-t.width,i.size.width=p,i.position.left=r.left+n.width-p))}}),e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;
this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,a=e.data(this,"selectable-item");return a?(s=!t.metaKey&&!t.ctrlKey||!a.$element.hasClass("ui-selected"),a.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),a.unselecting=!s,a.selecting=s,a.selected=s,s?i._trigger("selecting",t,{selecting:a.element}):i._trigger("unselecting",t,{unselecting:a.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,a=this.options,n=this.opos[0],r=this.opos[1],o=t.pageX,h=t.pageY;return n>o&&(i=o,o=n,n=i),r>h&&(i=h,h=r,r=i),this.helper.css({left:n,top:r,width:o-n,height:h-r}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===a.tolerance?l=!(i.left>o||n>i.right||i.top>h||r>i.bottom):"fit"===a.tolerance&&(l=i.left>n&&o>i.right&&i.top>r&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,a=!1,n=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,n.widgetName+"-item")===n?(s=e(this),!1):void 0}),e.data(t.target,n.widgetName+"-item")===n&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(a=!0)}),a)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var a,n,r=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(n=this.document.find("body"),this.storedCursor=n.css("cursor"),n.css("cursor",r.cursor),this.storedStylesheet=e("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(n)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(a=this.containers.length-1;a>=0;a--)this.containers[a]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,a,n,r=this.options,o=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=o=this.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=o=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=o=this.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=o=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(t.pageY-this.document.scrollTop()<r.scrollSensitivity?o=this.document.scrollTop(this.document.scrollTop()-r.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<r.scrollSensitivity&&(o=this.document.scrollTop(this.document.scrollTop()+r.scrollSpeed)),t.pageX-this.document.scrollLeft()<r.scrollSensitivity?o=this.document.scrollLeft(this.document.scrollLeft()-r.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<r.scrollSensitivity&&(o=this.document.scrollLeft(this.document.scrollLeft()+r.scrollSpeed))),o!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],a=s.item[0],n=this._intersectsWithPointer(s),n&&s.instance===this.currentContainer&&a!==this.currentItem[0]&&this.placeholder[1===n?"next":"prev"]()[0]!==a&&!e.contains(this.placeholder[0],a)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],a):!0)){if(this.direction=1===n?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,a=this.placeholder.offset(),n=this.options.axis,r={};n&&"x"!==n||(r.left=a.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),n&&"y"!==n||(r.top=a.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,a=s+this.helperProportions.height,n=e.left,r=n+e.width,o=e.top,h=o+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>o&&h>s+l,c="y"===this.options.axis||t+u>n&&r>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>n&&r>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>o&&h>a-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,a=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return s?this.floating?n&&"right"===n||"down"===a?2:1:a&&("down"===a?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return this.floating&&a?"right"===a&&i||"left"===a&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){o.push(this)}var s,a,n,r,o=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(n=e(l[s],this.document[0]),a=n.length-1;a>=0;a--)r=e.data(n[a],this.widgetFullName),r&&r!==this&&!r.options.disabled&&h.push([e.isFunction(r.options.items)?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,a,n,r,o,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(a=e(c[i],this.document[0]),s=a.length-1;s>=0;s--)n=e.data(a[s],this.widgetFullName),n&&n!==this&&!n.options.disabled&&(d.push([e.isFunction(n.options.items)?n.options.items.call(n.element[0],t,{item:this.currentItem}):e(n.options.items,n.element),n]),this.containers.push(n));for(i=d.length-1;i>=0;i--)for(r=d[i][1],o=d[i][0],s=0,l=o.length;l>s;s++)h=e(o[s]),h.data(this.widgetName+"-item",r),u.push({item:h,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,a,n;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(a=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=a.outerWidth(),s.height=a.outerHeight()),n=a.offset(),s.left=n.left,s.top=n.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)n=this.containers[i].element.offset(),this.containers[i].containerCache.left=n.left,this.containers[i].containerCache.top=n.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),a=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===s?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(a)):"tr"===s?t._createTrPlaceholder(t.currentItem,a):"img"===s&&a.attr("src",t.currentItem.attr("src")),i||a.css("visibility","hidden"),a},update:function(e,a){(!i||s.forcePlaceholderSize)&&(a.height()||a.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var s=this;t.children().each(function(){e("<td>&#160;</td>",s.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,s,a,n,r,o,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(a=1e4,n=null,u=c.floating||this._isFloating(this.currentItem),r=u?"left":"top",o=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[r],l=!1,t[d]-h>this.items[s][o]/2&&(l=!0),a>Math.abs(t[d]-h)&&(a=Math.abs(t[d]-h),n=this.items[s],this.direction=l?"up":"down"));if(!n&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;n?this._rearrange(t,n,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,a=this.options;"parent"===a.containment&&(a.containment=this.helper[0].parentNode),("document"===a.containment||"window"===a.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===a.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===a.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(a.containment)||(t=e(a.containment)[0],i=e(a.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(a[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():n?0:a.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():n?0:a.scrollLeft())*s}},_generatePosition:function(t){var i,s,a=this.options,n=t.pageX,r=t.pageY,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(o[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(n=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(n=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),a.grid&&(i=this.originalPageY+Math.round((r-this.originalPageY)/a.grid[1])*a.grid[1],r=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-a.grid[1]:i+a.grid[1]:i,s=this.originalPageX+Math.round((n-this.originalPageX)/a.grid[0])*a.grid[0],n=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-a.grid[0]:s+a.grid[0]:s)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:o.scrollTop()),left:n-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:o.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var a=this.counter;this._delay(function(){a===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,a=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&a.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||a.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(a.push(function(e){this._trigger("remove",e,this._uiHash())}),a.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),a.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||a.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(a.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;a.length>s;s++)a[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,a=this.headers.index(t.target),n=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:n=this.headers[(a+1)%s];break;case i.LEFT:case i.UP:n=this.headers[(a-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:n=this.headers[0];break;case i.END:n=this.headers[s-1]}n&&(e(t.target).attr("tabIndex",-1),e(n).attr("tabIndex",0),n.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))
},_refresh:function(){var t,i=this.options,s=i.heightStyle,a=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),a=s.uniqueId().attr("id");t.attr("aria-controls",a),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=a.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,a=e(t.currentTarget),n=a[0]===s[0],r=n&&i.collapsible,o=r?e():a.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:r?e():a,newPanel:o};t.preventDefault(),n&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=r?!1:this.headers.index(a),this.active=n?e():a,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),n||(a.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&a.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),a.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,i){var s,a,n,r=this,o=0,h=e.css("box-sizing"),l=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=l&&u.down||u,c=function(){r._toggleComplete(i)};return"number"==typeof d&&(n=d),"string"==typeof d&&(a=d),a=a||d.easing||u.easing,n=n||d.duration||u.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:n,easing:a,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:n,easing:a,complete:c,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?"content-box"===h&&(o+=i.now):"content"!==r.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-o),o=0)}}),void 0):t.animate(this.hideProps,n,a,c):e.animate(this.showProps,n,a,c)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,a,n,r=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:r=!1,s=this.previousFilter||"",a=String.fromCharCode(t.keyCode),n=!1,clearTimeout(this.filterTimer),a===s?n=!0:a=s+a,i=this._filterMenuItems(a),i=n&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(a=String.fromCharCode(t.keyCode),i=this._filterMenuItems(a)),i.length?(this.focus(t,i),this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}r&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,a=this.options.icons.submenu,n=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),n.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+a).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=n.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,a,n,r,o;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,a=t.offset().top-this.activeMenu.offset().top-i-s,n=this.activeMenu.scrollTop(),r=this.activeMenu.height(),o=t.outerHeight(),0>a?this.activeMenu.scrollTop(n+a):a+o>r&&this.activeMenu.scrollTop(n+a-r+o))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,a;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,a=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-a}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,a;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,a=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+a>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,a=this.element[0].nodeName.toLowerCase(),n="textarea"===a,r="input"===a;this.isMultiLine=n?!0:r?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[n||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(a){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var n=e.ui.keyCode;switch(a.keyCode){case n.PAGE_UP:t=!0,this._move("previousPage",a);break;case n.PAGE_DOWN:t=!0,this._move("nextPage",a);break;case n.UP:t=!0,this._keyEvent("previous",a);break;case n.DOWN:t=!0,this._keyEvent("next",a);break;case n.ENTER:this.menu.active&&(t=!0,a.preventDefault(),this.menu.select(a));break;case n.TAB:this.menu.active&&this.menu.select(a);break;case n.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(a),a.preventDefault());break;default:i=!0,this._searchTimeout(a)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var a=e.ui.keyCode;switch(s.keyCode){case a.PAGE_UP:this._move("previousPage",s);break;case a.PAGE_DOWN:this._move("nextPage",s);break;case a.UP:this._keyEvent("previous",s);break;case a.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,a;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(a=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:a})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(a.value),s=i.item.attr("aria-label")||a.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,a){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){a(e)},error:function(){a([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,a=e([]);return i&&(i=i.replace(/'/g,"\\'"),a=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),a};e.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,a=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(a)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,a=s.primary&&s.secondary,n=[];s.primary||s.secondary?(this.options.text&&n.push("ui-button-text-icon"+(a?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(n.push(a?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):n.push("ui-button-text-only"),t.addClass(n.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.4"}});var v;e.extend(a.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,a,n;s=t.nodeName.toLowerCase(),a="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),n=this._newInst(e(t),a),n.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,n):a&&this._inlineDatepicker(t,n)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,a,n,r=this._get(i,"appendText"),o=this._get(i,"isRTL");i.append&&i.append.remove(),r&&(i.append=e("<span class='"+this._appendClass+"'>"+r+"</span>"),t[o?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(a=this._get(i,"buttonText"),n=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:n,alt:a,title:a}):e("<button type='button'></button>").addClass(this._triggerClass).html(n?e("<img/>").attr({src:n,alt:a,title:a}):a)),t[o?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,a,n=new Date(2009,11,20),r=this._get(e,"dateFormat");r.match(/[DM]/)&&(t=function(e){for(i=0,s=0,a=0;e.length>a;a++)e[a].length>i&&(i=e[a].length,s=a);return s},n.setMonth(t(this._get(e,r.match(/MM/)?"monthNames":"monthNamesShort"))),n.setDate(t(this._get(e,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-n.getDay())),e.input.attr("size",this._formatDate(e,n).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,a,n){var r,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),o(c.settings,a||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=n?n.length?n:[n.pageX,n.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this
},_destroyDatepicker:function(t){var i,s=e(t),a=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(a.append.remove(),a.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),v===a&&(v=null))},_enableDatepicker:function(t){var i,s,a=e(t),n=e.data(t,"datepicker");a.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=a.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,a=e(t),n=e.data(t,"datepicker");a.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=a.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var a,n,r,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(a=i||{},"string"==typeof i&&(a={},a[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),n=this._getDateDatepicker(t,!0),r=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),o(l.settings,a),null!==r&&void 0!==a.dateFormat&&void 0===a.minDate&&(l.settings.minDate=this._formatDate(l,r)),null!==h&&void 0!==a.dateFormat&&void 0===a.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in a&&(a.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,n),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,a,n=e.datepicker._getInst(t.target),r=!0,o=n.dpDiv.is(".ui-datepicker-rtl");if(n._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),r=!1;break;case 13:return a=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",n.dpDiv),a[0]&&e.datepicker._selectDay(t.target,n.selectedMonth,n.selectedYear,a[0]),i=e.datepicker._get(n,"onSelect"),i?(s=e.datepicker._formatDate(n),i.apply(n.input?n.input[0]:null,[s,n])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(n,"stepBigMonths"):-e.datepicker._get(n,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(n,"stepBigMonths"):+e.datepicker._get(n,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),r=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),r=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,o?1:-1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(n,"stepBigMonths"):-e.datepicker._get(n,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),r=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,o?-1:1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(n,"stepBigMonths"):+e.datepicker._get(n,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),r=t.ctrlKey||t.metaKey;break;default:r=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):r=!1;r&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,a=e.datepicker._getInst(t.target);return e.datepicker._get(a,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(a,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(a){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,a,n,r,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),a=e.datepicker._get(i,"beforeShow"),n=a?a.apply(t,[t,i]):{},n!==!1&&(o(i.settings,n),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),r=!1,e(t).parents().each(function(){return r|="fixed"===e(this).css("position"),!r}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,r),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":r?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),a=s[1],n=17,o=t.dpDiv.find("."+this._dayOverClass+" a");o.length>0&&r.apply(o.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),a>1&&t.dpDiv.addClass("ui-datepicker-multi-"+a).css("width",n*a+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var a=t.dpDiv.outerWidth(),n=t.dpDiv.outerHeight(),r=t.input?t.input.outerWidth():0,o=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?a-r:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+o?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+a>h&&h>a?Math.abs(i.left+a-h):0),i.top-=Math.min(i.top,i.top+n>l&&l>n?Math.abs(n+o):0),i},_findPos:function(t){for(var i,s=this._getInst(t),a=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[a?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,a,n,r=this._curInst;!r||t&&r!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(r,"showAnim"),s=this._get(r,"duration"),a=function(){e.datepicker._tidyDialog(r)},e.effects&&(e.effects.effect[i]||e.effects[i])?r.dpDiv.hide(i,e.datepicker._get(r,"showOptions"),s,a):r.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,a),i||a(),this._datepickerShowing=!1,n=this._get(r,"onClose"),n&&n.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var a=e(t),n=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(n,i+("M"===s?this._get(n,"showCurrentAtPos"):0),s),this._updateDatepicker(n))},_gotoToday:function(t){var i,s=e(t),a=this._getInst(s[0]);this._get(a,"gotoCurrent")&&a.currentDay?(a.selectedDay=a.currentDay,a.drawMonth=a.selectedMonth=a.currentMonth,a.drawYear=a.selectedYear=a.currentYear):(i=new Date,a.selectedDay=i.getDate(),a.drawMonth=a.selectedMonth=i.getMonth(),a.drawYear=a.selectedYear=i.getFullYear()),this._notifyChange(a),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var a=e(t),n=this._getInst(a[0]);n["selected"+("M"===s?"Month":"Year")]=n["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(n),this._adjustDate(a)},_selectDay:function(t,i,s,a){var n,r=e(t);e(a).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||(n=this._getInst(r[0]),n.selectedDay=n.currentDay=e("a",a).html(),n.selectedMonth=n.currentMonth=i,n.selectedYear=n.currentYear=s,this._selectDate(t,this._formatDate(n,n.currentDay,n.currentMonth,n.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,a=e(t),n=this._getInst(a[0]);i=null!=i?i:this._formatDate(n),n.input&&n.input.val(i),this._updateAlternate(n),s=this._get(n,"onSelect"),s?s.apply(n.input?n.input[0]:null,[i,n]):n.input&&n.input.trigger("change"),n.inline?this._updateDatepicker(n):(this._hideDatepicker(),this._lastInput=n.input[0],"object"!=typeof n.input[0]&&n.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,a,n=this._get(t,"altField");n&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),a=this.formatDate(i,s,this._getFormatConfig(t)),e(n).each(function(){e(this).val(a)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var a,n,r,o,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>a+1&&t.charAt(a+1)===e;return i&&a++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,a="y"===e?s:1,n=RegExp("^\\d{"+a+","+s+"}"),r=i.substring(h).match(n);if(!r)throw"Missing number at position "+h;return h+=r[0].length,parseInt(r[0],10)},w=function(t,s,a){var n=-1,r=e.map(_(t)?a:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(r,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(n=t[0],h+=s.length,!1):void 0}),-1!==n)return n+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(a))throw"Unexpected literal at position "+h;h++};for(a=0;t.length>a;a++)if(b)"'"!==t.charAt(a)||_("'")?k():b=!1;else switch(t.charAt(a)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":o=new Date(x("@")),m=o.getFullYear(),g=o.getMonth()+1,v=o.getDate();break;case"!":o=new Date((x("!")-this._ticksTo1970)/1e4),m=o.getFullYear(),g=o.getMonth()+1,v=o.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(r=i.substr(h),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(n=this._getDaysInMonth(m,g-1),n>=v)break;g++,v-=n}if(o=this._daylightSavingAdjust(new Date(m,g-1,v)),o.getFullYear()!==m||o.getMonth()+1!==g||o.getDate()!==v)throw"Invalid date";return o},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,a=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,n=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,o=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),a,n);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),r,o);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,a=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||a("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":a("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,a=this._getDefaultDate(e),n=a,r=this._getFormatConfig(e);try{n=this.parseDate(i,s,r)||a}catch(o){s=t?"":s}e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),e.currentDay=s?n.getDate():0,e.currentMonth=s?n.getMonth():0,e.currentYear=s?n.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var a=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},n=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var a=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,n=a.getFullYear(),r=a.getMonth(),o=a.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":r+=parseInt(l[1],10),o=Math.min(o,e.datepicker._getDaysInMonth(n,r));break;case"y":case"Y":n+=parseInt(l[1],10),o=Math.min(o,e.datepicker._getDaysInMonth(n,r))}l=h.exec(i)}return new Date(n,r,o)},r=null==i||""===i?s:"string"==typeof i?n(i):"number"==typeof i?isNaN(i)?s:a(i):new Date(i.getTime());return r=r&&"Invalid Date"==""+r?s:r,r&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,a=e.selectedMonth,n=e.selectedYear,r=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=r.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=r.getMonth(),e.drawYear=e.selectedYear=e.currentYear=r.getFullYear(),a===e.selectedMonth&&n===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,a,n,r,o,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,N,C,A,I,P,H,F,z,j,E,O,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),J=this._get(e,"showButtonPanel"),B=this._get(e,"hideIfNoPrevNext"),K=this._get(e,"navigationAsDateFormat"),q=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),G=1!==q[0]||1!==q[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-q[0]*q[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":B?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",a=this._get(e,"nextText"),a=K?this.formatDate(a,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):a,n=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+a+"</span></a>":B?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+a+"</span></a>",r=this._get(e,"currentText"),o=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,r=K?this.formatDate(r,o,this._getFormatConfig(e)):r,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=J?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,o)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+r+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;q[0]>w;w++){for(k="",this.maxRows=4,T=0;q[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",G){if(M+="<div class='ui-datepicker-group",q[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case q[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?n:s:"")+(/all|right/.test(S)&&0===w?Y?s:n:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",N=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)C=(x+u)%7,N+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[C]+"'>"+p[C]+"</span></th>";for(M+=N+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),I=(this._getFirstDayOfMonth(et,Z)-u+7)%7,P=Math.ceil((I+A)/7),H=G?this.maxRows>P?this.maxRows:P:P,this.maxRows=H,F=this._daylightSavingAdjust(new Date(et,Z,1-I)),z=0;H>z;z++){for(M+="<tr>",j=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(F)+"</td>":"",x=0;7>x;x++)E=g?g.apply(e.input?e.input[0]:null,[F]):[!0,""],O=F.getMonth()!==Z,W=O&&!y||!E[0]||X&&X>F||$&&F>$,j+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(O?" ui-datepicker-other-month":"")+(F.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===F.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(O&&!v?"":" "+E[1]+(F.getTime()===Q.getTime()?" "+this._currentClass:"")+(F.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(O&&!v||!E[2]?"":" title='"+E[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+F.getMonth()+"' data-year='"+F.getFullYear()+"'")+">"+(O&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+F.getDate()+"</span>":"<a class='ui-state-default"+(F.getTime()===R.getTime()?" ui-state-highlight":"")+(F.getTime()===Q.getTime()?" ui-state-active":"")+(O?" ui-priority-secondary":"")+"' href='#'>"+F.getDate()+"</a>")+"</td>",F.setDate(F.getDate()+1),F=this._daylightSavingAdjust(F);M+=j+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(G?"</div>"+(q[0]>0&&T===q[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,a,n,r,o){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(n||!g)_+="<span class='ui-datepicker-month'>"+r[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=a&&a.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||a.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+o[u]+"</option>");_+="</select>"}if(y||(b+=_+(!n&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",n||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=a?Math.min(m,a.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!n&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),a=e.drawMonth+("M"===i?t:0),n=Math.min(e.selectedDay,this._getDaysInMonth(s,a))+("D"===i?t:0),r=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,a,n)));e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),a=i&&i>t?i:t;return s&&a>s?s:a},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var a=this._getNumberOfMonths(e),n=this._daylightSavingAdjust(new Date(i,s+(0>t?t:a[0]*a[1]),1));return 0>t&&n.setDate(this._getDaysInMonth(n.getFullYear(),n.getMonth())),this._isInRange(e,n)},_isInRange:function(e,t){var i,s,a=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=null,o=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),r=parseInt(i[0],10),o=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(r+=s),i[1].match(/[+\-].*/)&&(o+=s)),(!a||t.getTime()>=a.getTime())&&(!n||t.getTime()<=n.getTime())&&(!r||t.getFullYear()>=r)&&(!o||o>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var a=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),a,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new a,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4",e.datepicker,e.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(a){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,a=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),n=Math.max.apply(null,a);return n>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",n+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;
return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),a=i.filter(":last");t.target!==a[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){a.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var a,n;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),a=s.click,s.click=function(){a.apply(t.element[0],arguments)},n={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(n).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,a){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(a))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(a,n){var r=n.offset.left-i.document.scrollLeft(),o=n.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(o>=0?"+":"")+o,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",a,t(n))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,a=s.resizable,n=this.uiDialog.css("position"),r="string"==typeof a?a:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:r,start:function(s,a){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(a))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(a,n){var r=i.uiDialog.offset(),o=r.left-i.document.scrollLeft(),h=r.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",a,t(n))}}).css("position",n)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,a={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(a[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",a)},_setOption:function(e,t){var i,s,a=this.uiDialog;"dialogClass"===e&&a.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=a.is(":data(ui-draggable)"),i&&!t&&a.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=a.is(":data(ui-resizable)"),s&&!t&&a.resizable("destroy"),s&&"string"==typeof t&&a.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this;this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,a="";e.each(i,function(i,n){n.optgroup!==a&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(n.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:n.optgroup}).appendTo(t),a=n.optgroup),s._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,a=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),a+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](a).eq(-1):i[e+"All"](a).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var a=e(s),n=a.parent("optgroup");i.push({element:a,index:t,value:a.val(),label:a.text(),optgroup:n.attr("label")||"",disabled:n.prop("disabled")||a.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,a=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),n="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",r=[];for(i=s.values&&s.values.length||1,a.length>i&&(a.slice(i).remove(),a=a.slice(0,i)),t=a.length;i>t;t++)r.push(n);this.handles=a.add(e(r.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,a,n,r,o,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),a=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(a>i||a===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(a=i,n=e(this),r=t)}),o=this._start(t,r),o===!1?!1:(this._mouseSliding=!0,this._handleIndex=r,n.addClass("ui-state-active").focus(),h=n.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-n.width()/2,top:t.pageY-h.top-n.height()/2-(parseInt(n.css("borderTopWidth"),10)||0)-(parseInt(n.css("borderBottomWidth"),10)||0)+(parseInt(n.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,r,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,a,n;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),a=this._valueMax()-this._valueMin(),n=this._valueMin()+s*a,this._trimAlignValue(n)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,a,n;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(a=this.values(),a[t]=i,n=this._trigger("slide",e,{handle:this.handles[t],value:i,values:a}),s=this.values(t?0:1),n!==!1&&this.values(t,i))):i!==this.value()&&(n=this._trigger("slide",e,{handle:this.handles[t],value:i}),n!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,a,n;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,a=arguments[0],n=0;s.length>n;n+=1)s[n]=this._trimAlignValue(a[n]),this._change(null,n);this._refreshValue()},_setOption:function(t,i){var s,a=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(a=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;a>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,s=Math.floor(+(e-t).toFixed(this._precision())/i)*i;e=s+t,this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,a,n,r=this.options.range,o=this.options,h=this,l=this._animateOff?!1:o.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,o.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},o.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:o.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},o.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:o.animate}))),t=i}):(s=this.value(),a=this._valueMin(),n=this._valueMax(),i=n!==a?100*((s-a)/(n-a)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,o.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},o.animate),"max"===r&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:o.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},o.animate),"max"===r&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:o.animate}))},_handleEvents:{keydown:function(t){var i,s,a,n,r=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,r),i===!1))return}switch(n=this.options.step,s=a=this.options.values&&this.options.values.length?this.values(r):this.value(),t.keyCode){case e.ui.keyCode.HOME:a=this._valueMin();break;case e.ui.keyCode.END:a=this._valueMax();break;case e.ui.keyCode.PAGE_UP:a=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:a=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;a=this._trimAlignValue(s+n);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;a=this._trimAlignValue(s-n)}this._slide(t,r,a)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var a=i.attr(s);void 0!==a&&a.length&&(t[s]=a)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()
},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(a){}try{s=decodeURIComponent(s)}catch(a){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,a){return e(a).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),a=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:a=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,a),t.ctrlKey||t.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>a&&(t=0),0>t&&(t=a),t}for(var a=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,a=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var a,n,r,o=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(a=s.hash,r=a.substring(1),n=t.element.find(t._sanitizeSelector(a))):(r=h.attr("aria-controls")||e({}).uniqueId()[0].id,a="#"+r,n=t.element.find(a),n.length||(n=t._createPanel(r),n.insertAfter(t.panels[i-1]||t.tablist)),n.attr("aria-live","polite")),n.length&&(t.panels=t.panels.add(n)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":r,"aria-labelledby":o}),n.attr("aria-labelledby",o)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(a.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,a=e(t.currentTarget),n=a.closest("li"),r=n[0]===s[0],o=r&&i.collapsible,h=o?e():this._getPanelForTab(n),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:o?e():n,newPanel:h};t.preventDefault(),n.hasClass("ui-state-disabled")||n.hasClass("ui-tabs-loading")||this.running||r&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=o?!1:this.tabs.index(n),this.active=r?e():n,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(n),t),this._toggle(t,u))},_toggle:function(t,i){function s(){n.running=!1,n._trigger("activate",t,i)}function a(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&n.options.show?n._show(r,n.options.show,s):(r.show(),s())}var n=this,r=i.newPanel,o=i.oldPanel;this.running=!0,o.length&&this.options.hide?this._hide(o,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o.hide(),a()),o.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&o.length?i.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),r.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,a=this.tabs.eq(t),n=a.find(".ui-tabs-anchor"),r=this._getPanelForTab(a),o={tab:a,panel:r},h=function(e,t){"abort"===t&&s.panels.stop(!1,!0),a.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr};this._isLocal(n[0])||(this.xhr=e.ajax(this._ajaxSettings(n,i,o)),this.xhr&&"canceled"!==this.xhr.statusText&&(a.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.done(function(e,t,a){setTimeout(function(){r.html(e),s._trigger("load",i,o),h(a,t)},1)}).fail(function(e,t){setTimeout(function(){h(e,t)},1)})))},_ajaxSettings:function(t,i,s){var a=this;return{url:t.attr("href"),beforeSend:function(t,n){return a._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:n},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),a=e.inArray(i,s);-1!==a&&s.splice(a,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var a=e.Event("blur");a.target=a.currentTarget=s.element[0],t.close(a,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(t,s),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,a=this,n=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){a._delay(function(){e.data("ui-tooltip-open")&&(t&&(t.type=n),this._open(t,e,i))})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function a(e){l.of=e,r.is(":hidden")||r.position(l)}var n,r,o,h,l=e.extend({},this.options.position);if(s){if(n=this._find(i))return n.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),n=this._tooltip(i),r=n.tooltip,this._addDescribedBy(i,r.attr("id")),r.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(h=s.clone(),h.removeAttr("id").find("[id]").removeAttr("id")):h=s,e("<div>").html(h).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:a}),a(t)):r.position(e.extend({of:i},this.options.position)),r.hide(),this._show(r,this.options.show),this.options.show&&this.options.show.delay&&(o=this.delayedShow=setInterval(function(){r.is(":visible")&&(a(l.of),clearInterval(o))},e.fx.interval)),this._trigger("open",t,{tooltip:r})}},_registerCloseHandlers:function(t,i){var s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),t&&"mouseover"!==t.type||(s.mouseleave="close"),t&&"focusin"!==t.type||(s.focusout="close"),this._on(!0,i,s)},close:function(t){var i,s=this,a=e(t?t.currentTarget:this.element),n=this._find(a);return n?(i=n.tooltip,n.closing||(clearInterval(this.delayedShow),a.data("ui-tooltip-title")&&!a.attr("title")&&a.attr("title",a.data("ui-tooltip-title")),this._removeDescribedBy(a),n.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),a.removeData("ui-tooltip-open"),this._off(a,"mouseleave focusout keyup"),a[0]!==this.element[0]&&this._off(a,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),n.closing=!0,this._trigger("close",t,{tooltip:i}),n.hiding||(n.closing=!1)),void 0):(a.removeData("ui-tooltip-open"),void 0)},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var a=e.Event("blur"),n=s.element;a.target=a.currentTarget=n[0],t.close(a,!0),e("#"+i).remove(),n.data("ui-tooltip-title")&&(n.attr("title")||n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),a=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,n){var r,o=n.re.exec(i),h=o&&n.parse(o),l=n.space||"rgba";return h?(r=s[l](h),s[u[l].cache]=r[u[l].cache],a=s._rgba=r._rgba,!1):t}),a.length?("0,0,0,0"===a.join()&&e.extend(a,n.transparent),s):n[i]}function a(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var n,r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",o=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,a){return new e.Color.fn.parse(t,i,s,a)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(a,r,o,h){if(a===t)return this._rgba=[null,null,null,null],this;(a.jquery||a.nodeType)&&(a=e(a).css(r),r=t);var d=this,c=e.type(a),p=this._rgba=[];return r!==t&&(a=[a,r,o,h],c="array"),"string"===c?this.parse(s(a)||n._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(a[t.idx],t)}),this):"object"===c?(a instanceof l?f(u,function(e,t){a[t.cache]&&(d[t.cache]=a[t.cache].slice())}):f(u,function(t,s){var n=s.cache;f(s.props,function(e,t){if(!d[n]&&s.to){if("alpha"===e||null==a[e])return;d[n]=s.to(d._rgba)}d[n][t.idx]=i(a[e],t,!0)}),d[n]&&0>e.inArray(null,d[n].slice(0,3))&&(d[n][3]=1,s.from&&(d._rgba=s.from(d[n])))}),this):t},is:function(e){var i=l(e),s=!0,a=this;return f(u,function(e,n){var r,o=i[n.cache];return o&&(r=a[n.cache]||n.to&&n.to(a._rgba)||[],f(n.props,function(e,i){return null!=o[i.idx]?s=o[i.idx]===r[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),a=s._space(),n=u[a],r=0===this.alpha()?l("transparent"):this,o=r[n.cache]||n.to(r._rgba),h=o.slice();return s=s[n.cache],f(n.props,function(e,a){var n=a.idx,r=o[n],l=s[n],u=d[a.type]||{};null!==l&&(null===r?h[n]=l:(u.mod&&(l-r>u.mod/2?r+=u.mod:r-l>u.mod/2&&(r-=u.mod)),h[n]=i((l-r)*t+r,a)))}),this[a](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),a=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*a[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,a=e[1]/255,n=e[2]/255,r=e[3],o=Math.max(s,a,n),h=Math.min(s,a,n),l=o-h,u=o+h,d=.5*u;return t=h===o?0:s===o?60*(a-n)/l+360:a===o?60*(n-s)/l+120:60*(s-a)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==r?1:r]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],n=e[3],r=.5>=s?s*(1+i):s+i-s*i,o=2*s-r;return[Math.round(255*a(o,r,t+1/3)),Math.round(255*a(o,r,t)),Math.round(255*a(o,r,t-1/3)),n]},f(u,function(s,a){var n=a.props,r=a.cache,h=a.to,u=a.from;l.fn[s]=function(s){if(h&&!this[r]&&(this[r]=h(this._rgba)),s===t)return this[r].slice();var a,o=e.type(s),d="array"===o||"object"===o?s:arguments,c=this[r].slice();return f(n,function(e,t){var s=d["object"===o?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(a=l(u(c)),a[r]=c,a):l(c)},f(n,function(t,i){l.fn[t]||(l.fn[t]=function(a){var n,r=e.type(a),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===r?u:("function"===r&&(a=a.call(this,u),r=e.type(a)),null==a&&i.empty?this:("string"===r&&(n=o.exec(a),n&&(a=u+parseFloat(n[2])*("+"===n[1]?1:-1))),l[i.idx]=a,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,a){var n,r,o="";if("transparent"!==a&&("string"!==e.type(a)||(n=s(a)))){if(a=l(n||a),!c.rgba&&1!==a._rgba[3]){for(r="backgroundColor"===i?t.parentNode:t;(""===o||"transparent"===o)&&r&&r.style;)try{o=e.css(r,"backgroundColor"),r=r.parentNode}catch(h){}a=a.blend(o&&"transparent"!==o?o:"_default")}a=a.toRgbaString()}try{t.style[i]=a}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(r),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},n=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,a=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,n={};if(a&&a.length&&a[0]&&a[a[0]])for(s=a.length;s--;)i=a[s],"string"==typeof a[i]&&(n[e.camelCase(i)]=a[i]);else for(i in a)"string"==typeof a[i]&&(n[i]=a[i]);return n}function i(t,i){var s,n,r={};for(s in i)n=i[s],t[s]!==n&&(a[s]||(e.fx.step[s]||!isNaN(parseFloat(n)))&&(r[s]=n));return r}var s=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(a,n,r,o){var h=e.speed(n,r,o);return this.queue(function(){var n,r=e(this),o=r.attr("class")||"",l=h.children?r.find("*").addBack():r;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),n=function(){e.each(s,function(e,t){a[t]&&r[t+"Class"](a[t])})},n(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),r.attr("class",o),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){n(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(r[0])})})},e.fn.extend({addClass:function(t){return function(i,s,a,n){return s?e.effects.animateClass.call(this,{add:i},s,a,n):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,a,n){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,a,n):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,a,n,r){return"boolean"==typeof s||void 0===s?a?e.effects.animateClass.call(this,s?{add:i}:{remove:i},a,n,r):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,a,n)}}(e.fn.toggleClass),switchClass:function(t,i,s,a,n){return e.effects.animateClass.call(this,{add:i,remove:t},s,a,n)}})}(),function(){function t(t,i,s,a){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(a=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(a=s,s=i,i={}),e.isFunction(s)&&(a=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=a||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.4",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),a={width:t.width(),height:t.height()},n=document.activeElement;try{n.id}catch(r){n=document.body}return t.wrap(s),(t[0]===n||e.contains(t[0],n))&&e(n).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(a),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;
return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,a){return a=a||{},e.each(i,function(e,i){var n=t.cssUnit(i);n[0]>0&&(a[i]=n[0]*s+n[1])}),a}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(n)&&n.call(a[0]),e.isFunction(t)&&t()}var a=e(this),n=s.complete,o=s.mode;(a.is(":hidden")?"hide"===o:"show"===o)?(a[o](),i()):r.call(a[0],s,i)}var s=t.apply(this,arguments),a=s.mode,n=s.queue,r=e.effects.effect[s.effect];return e.fx.off||!r?a?this[a](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):n===!1?this.each(i):this.queue(n||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var a=t.apply(this,arguments);return a.mode="show",this.effect.call(this,a)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);var a=t.apply(this,arguments);return a.mode="hide",this.effect.call(this,a)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var a=t.apply(this,arguments);return a.mode="toggle",this.effect.call(this,a)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,a,n,r=e(this),o=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(r,t.mode||"hide"),d=t.direction||"up",c=o.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;r.parent().is(".ui-effects-wrapper")?e.effects.save(r.parent(),l):e.effects.save(r,l),r.show(),s=e.effects.createWrapper(r).css({overflow:"hidden"}),a=s[p](),n=parseFloat(s.css(f))||0,g[p]=v?a:0,m||(r.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?n:a+n),v&&(s.css(p,0),m||s.css(f,n+a)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&r.hide(),e.effects.restore(r,l),e.effects.removeWrapper(r),i()}})},e.effects.effect.bounce=function(t,i){var s,a,n,r=e(this),o=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(r,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=r.queue(),_=b.length;for((u||l)&&o.push("opacity"),e.effects.save(r,o),r.show(),e.effects.createWrapper(r),c||(c=r["top"===v?"outerHeight":"outerWidth"]()/3),u&&(n={opacity:1},n[v]=0,r.css("opacity",0).css(v,y?2*-c:2*c).animate(n,m,g)),l&&(c/=Math.pow(2,p-1)),n={},n[v]=0,s=0;p>s;s++)a={},a[v]=(y?"-=":"+=")+c,r.animate(a,m,g).animate(n,m,g),c=l?2*c:c/2;l&&(a={opacity:0},a[v]=(y?"-=":"+=")+c,r.animate(a,m,g)),r.queue(function(){l&&r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),r.dequeue()},e.effects.effect.clip=function(t,i){var s,a,n,r=e(this),o=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(r,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(r,o),r.show(),s=e.effects.createWrapper(r).css({overflow:"hidden"}),a="IMG"===r[0].tagName?s:r,n=a[c](),l&&(a.css(c,0),a.css(p,n/2)),f[c]=l?n:0,f[p]=l?0:n/2,a.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),i()}})},e.effects.effect.drop=function(t,i){var s,a=e(this),n=["position","top","bottom","left","right","opacity","height","width"],r=e.effects.setMode(a,t.mode||"hide"),o="show"===r,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:o?1:0};e.effects.save(a,n),a.show(),e.effects.createWrapper(a),s=t.distance||a["top"===l?"outerHeight":"outerWidth"](!0)/2,o&&a.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(o?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,a.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&a.hide(),e.effects.restore(a,n),e.effects.removeWrapper(a),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&a()}function a(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var n,r,o,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(n=0;d>n;n++)for(h=g.top+n*y,u=n-(d-1)/2,r=0;c>r;r++)o=g.left+r*v,l=r-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-r*v,top:-n*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:o+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:o+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),a=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:a},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,a,n=e(this),r=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"hide"),h="show"===o,l="hide"===o,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(n,r),n.show(),s=e.effects.createWrapper(n).css({overflow:"hidden"}),a=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*a[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?a[0]:u,v[f[1]]=h?a[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),a=["backgroundImage","backgroundColor","opacity"],n=e.effects.setMode(s,t.mode||"show"),r={backgroundColor:s.css("backgroundColor")};"hide"===n&&(r.opacity=0),e.effects.save(s,a),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(r,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===n&&s.hide(),e.effects.restore(s,a),i()}})},e.effects.effect.size=function(t,i){var s,a,n,r=e(this),o=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(r,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=r.css("position"),y=f?o:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&r.show(),s={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},"toggle"===t.mode&&"show"===p?(r.from=t.to||b,r.to=t.from||s):(r.from=t.from||("show"===p?b:s),r.to=t.to||("hide"===p?b:s)),n={from:{y:r.from.height/s.height,x:r.from.width/s.width},to:{y:r.to.height/s.height,x:r.to.width/s.width}},("box"===m||"both"===m)&&(n.from.y!==n.to.y&&(y=y.concat(d),r.from=e.effects.setTransition(r,d,n.from.y,r.from),r.to=e.effects.setTransition(r,d,n.to.y,r.to)),n.from.x!==n.to.x&&(y=y.concat(c),r.from=e.effects.setTransition(r,c,n.from.x,r.from),r.to=e.effects.setTransition(r,c,n.to.x,r.to))),("content"===m||"both"===m)&&n.from.y!==n.to.y&&(y=y.concat(u).concat(l),r.from=e.effects.setTransition(r,u,n.from.y,r.from),r.to=e.effects.setTransition(r,u,n.to.y,r.to)),e.effects.save(r,y),r.show(),e.effects.createWrapper(r),r.css("overflow","hidden").css(r.from),g&&(a=e.effects.getBaseline(g,s),r.from.top=(s.outerHeight-r.outerHeight())*a.y,r.from.left=(s.outerWidth-r.outerWidth())*a.x,r.to.top=(s.outerHeight-r.to.outerHeight)*a.y,r.to.left=(s.outerWidth-r.to.outerWidth)*a.x),r.css(r.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=o.concat(d).concat(c),r.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*n.from.y,width:s.width*n.from.x,outerHeight:s.outerHeight*n.from.y,outerWidth:s.outerWidth*n.from.x},i.to={height:s.height*n.to.y,width:s.width*n.to.x,outerHeight:s.height*n.to.y,outerWidth:s.width*n.to.x},n.from.y!==n.to.y&&(i.from=e.effects.setTransition(i,d,n.from.y,i.from),i.to=e.effects.setTransition(i,d,n.to.y,i.to)),n.from.x!==n.to.x&&(i.from=e.effects.setTransition(i,c,n.from.x,i.from),i.to=e.effects.setTransition(i,c,n.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),r.animate(r.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===r.to.opacity&&r.css("opacity",r.from.opacity),"hide"===p&&r.hide(),e.effects.restore(r,y),f||("static"===v?r.css({position:"relative",top:r.to.top,left:r.to.left}):e.each(["top","left"],function(e,t){r.css(t,function(t,i){var s=parseInt(i,10),a=e?r.to.left:r.to.top;return"auto"===i?a+"px":s+a+"px"})})),e.effects.removeWrapper(r),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),a=e.extend(!0,{},t),n=e.effects.setMode(s,t.mode||"effect"),r=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===n?0:100),o=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==o?r/100:1,x:"vertical"!==o?r/100:1};a.effect="size",a.queue=!1,a.complete=i,"effect"!==n&&(a.origin=h||["middle","center"],a.restore=!0),a.from=t.from||("show"===n?{height:0,width:0,outerHeight:0,outerWidth:0}:l),a.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},a.fade&&("show"===n&&(a.from.opacity=0,a.to.opacity=1),"hide"===n&&(a.from.opacity=1,a.to.opacity=0)),s.effect(a)},e.effects.effect.puff=function(t,i){var s=e(this),a=e.effects.setMode(s,t.mode||"hide"),n="hide"===a,r=parseInt(t.percent,10)||150,o=r/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:a,complete:i,percent:n?r:100,from:n?h:{height:h.height*o,width:h.width*o,outerHeight:h.outerHeight*o,outerWidth:h.outerWidth*o}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,a=e(this),n=e.effects.setMode(a,t.mode||"show"),r="show"===n,o="hide"===n,h=r||"hide"===n,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=a.queue(),p=c.length;for((r||!a.is(":visible"))&&(a.css("opacity",0).show(),d=1),s=1;l>s;s++)a.animate({opacity:d},u,t.easing),d=1-d;a.animate({opacity:d},u,t.easing),a.queue(function(){o&&a.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),a.dequeue()},e.effects.effect.shake=function(t,i){var s,a=e(this),n=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"effect"),o=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===o||"down"===o?"top":"left",p="up"===o||"left"===o,f={},m={},g={},v=a.queue(),y=v.length;for(e.effects.save(a,n),a.show(),e.effects.createWrapper(a),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,a.animate(f,d,t.easing),s=1;l>s;s++)a.animate(m,d,t.easing).animate(g,d,t.easing);a.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===r&&a.hide(),e.effects.restore(a,n),e.effects.removeWrapper(a),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),a.dequeue()},e.effects.effect.slide=function(t,i){var s,a=e(this),n=["position","top","bottom","left","right","width","height"],r=e.effects.setMode(a,t.mode||"show"),o="show"===r,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(a,n),a.show(),s=t.distance||a["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(a).css({overflow:"hidden"}),o&&a.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(o?u?"+=":"-=":u?"-=":"+=")+s,a.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&a.hide(),e.effects.restore(a,n),e.effects.removeWrapper(a),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),a=e(t.to),n="fixed"===a.css("position"),r=e("body"),o=n?r.scrollTop():0,h=n?r.scrollLeft():0,l=a.offset(),u={top:l.top-o,left:l.left-h,height:a.innerHeight(),width:a.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-o,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:n?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})}});;
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Slideout=e()}}(function(){var e,t,n;return function i(e,t,n){function s(r,a){if(!t[r]){if(!e[r]){var f=typeof require=="function"&&require;if(!a&&f)return f(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var l=t[r]={exports:{}};e[r][0].call(l.exports,function(t){var n=e[r][1][t];return s(n?n:t)},l,l.exports,i,e,t,n)}return t[r].exports}var o=typeof require=="function"&&require;for(var r=0;r<n.length;r++)s(n[r]);return s}({1:[function(e,t,n){"use strict";var i=e("decouple");var s;var o=false;var r=window.document;var a=r.documentElement;var f=window.navigator.msPointerEnabled;var u={start:f?"MSPointerDown":"touchstart",move:f?"MSPointerMove":"touchmove",end:f?"MSPointerUp":"touchend"};var l=function d(){var e=/^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/;var t=r.getElementsByTagName("script")[0].style;for(var n in t){if(e.test(n)){return"-"+n.match(e)[0].toLowerCase()+"-"}}if("WebkitOpacity"in t){return"-webkit-"}if("KhtmlOpacity"in t){return"-khtml-"}return""}();function p(e){e=e||{};this._startOffsetX=0;this._currentOffsetX=0;this._opening=false;this._moved=false;this._opened=false;this._preventOpen=false;this.panel=e.panel;this.menu=e.menu;this.panel.className+=" slideout-menu";this.menu.className+=" slideout-panel";this._fx=e.fx||"ease";this._duration=parseInt(e.duration,10)||300;this._tolerance=parseInt(e.tolerance,10)||70;this._padding=parseInt(e.padding,10)||256;this._initTouchEvents()}p.prototype.open=function(){var e=this;if(a.className.search("slideout-open")===-1){a.className+=" slideout-open"}this._setTransition();this._translateXTo(this._padding);this._opened=true;setTimeout(function(){e.panel.style.transition=e.panel.style["-webkit-transition"]=""},this._duration+50);return this};p.prototype.close=function(){var e=this;if(!this.isOpen()&&!this._opening){return this}this._setTransition();this._translateXTo(0);this._opened=false;setTimeout(function(){a.className=a.className.replace(/ slideout-open/,"");e.panel.style.transition=e.panel.style["-webkit-transition"]=""},this._duration+50);return this};p.prototype.toggle=function(){return this.isOpen()?this.close():this.open()};p.prototype.isOpen=function(){return this._opened};p.prototype._translateXTo=function(e){this._currentOffsetX=e;this.panel.style[l+"transform"]=this.panel.style.transform="translate3d("+e+"px, 0, 0)"};p.prototype._setTransition=function(){this.panel.style[l+"transition"]=this.panel.style.transition=l+"transform "+this._duration+"ms "+this._fx};p.prototype._initTouchEvents=function(){var e=this;i(r,"scroll",function(){if(!e._moved){clearTimeout(s);o=true;s=setTimeout(function(){o=false},250)}});r.addEventListener(u.move,function(t){if(e._moved){t.preventDefault()}});this.panel.addEventListener(u.start,function(t){e._moved=false;e._opening=false;e._startOffsetX=t.touches[0].pageX;e._preventOpen=!e.isOpen()&&e.menu.clientWidth!==0});this.panel.addEventListener("touchcancel",function(){e._moved=false;e._opening=false});this.panel.addEventListener(u.end,function(){if(e._moved){e._opening&&Math.abs(e._currentOffsetX)>e._tolerance?e.open():e.close()}e._moved=false});this.panel.addEventListener(u.move,function(t){if(o||e._preventOpen){return}var n=t.touches[0].clientX-e._startOffsetX;var i=e._currentOffsetX=n;if(Math.abs(i)>e._padding){return}if(Math.abs(n)>20){e._opening=true;if(e._opened&&n>0||!e._opened&&n<0){return}if(!e._moved&&a.className.search("slideout-open")===-1){a.className+=" slideout-open"}if(n<=0){i=n+e._padding;e._opening=false}e.panel.style[l+"transform"]=e.panel.style.transform="translate3d("+i+"px, 0, 0)";e._moved=true}})};t.exports=p},{decouple:2}],2:[function(e,t,n){"use strict";var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function s(e,t,n){var s,o=false;function r(e){s=e;a()}function a(){if(!o){i(f);o=true}}function f(){n.call(e,s);o=false}e.addEventListener(t,r,false)}t.exports=s},{}]},{},[1])(1)});;
(function($,window,document,undefined){function Owl(element,options){this.settings=null;this.options=$.extend({},Owl.Defaults,options);this.$element=$(element);this._handlers={};this._plugins={};this._supress={};this._current=null;this._speed=null;this._coordinates=[];this._breakpoint=null;this._width=null;this._items=[];this._clones=[];this._mergers=[];this._widths=[];this._invalidated={};this._pipe=[];this._drag={time:null,target:null,pointer:null,stage:{start:null,current:null},direction:null};this._states={current:{},tags:{initializing:["busy"],animating:["busy"],dragging:["interacting"]}};$.each(["onResize","onThrottledResize"],$.proxy(function(i,handler){this._handlers[handler]=$.proxy(this[handler],this)},this));$.each(Owl.Plugins,$.proxy(function(key,plugin){this._plugins[key.charAt(0).toLowerCase()+key.slice(1)]=new plugin(this)},this));$.each(Owl.Workers,$.proxy(function(priority,worker){this._pipe.push({filter:worker.filter,run:$.proxy(worker.run,this)})},this));this.setup();this.initialize()}Owl.Defaults={items:3,loop:false,center:false,rewind:false,mouseDrag:true,touchDrag:true,pullDrag:true,freeDrag:false,margin:0,stagePadding:0,merge:false,mergeFit:true,autoWidth:false,startPosition:0,rtl:false,smartSpeed:250,fluidSpeed:false,dragEndSpeed:false,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:window,fallbackEasing:"swing",info:false,nestedItemSelector:false,itemElement:"div",stageElement:"div",refreshClass:"owl-refresh",loadedClass:"owl-loaded",loadingClass:"owl-loading",rtlClass:"owl-rtl",responsiveClass:"owl-responsive",dragClass:"owl-drag",itemClass:"owl-item",stageClass:"owl-stage",stageOuterClass:"owl-stage-outer",grabClass:"owl-grab"};Owl.Width={Default:"default",Inner:"inner",Outer:"outer"};Owl.Type={Event:"event",State:"state"};Owl.Plugins={};Owl.Workers=[{filter:["width","settings"],run:function(){this._width=this.$element.width()}},{filter:["width","items","settings"],run:function(cache){cache.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){this.$stage.children(".cloned").remove()}},{filter:["width","items","settings"],run:function(cache){var margin=this.settings.margin||"",grid=!this.settings.autoWidth,rtl=this.settings.rtl,css={width:"auto","margin-left":rtl?margin:"","margin-right":rtl?"":margin};!grid&&this.$stage.children().css(css);cache.css=css}},{filter:["width","items","settings"],run:function(cache){var width=(this.width()/this.settings.items).toFixed(3)-this.settings.margin,merge=null,iterator=this._items.length,grid=!this.settings.autoWidth,widths=[];cache.items={merge:false,width:width};while(iterator--){merge=this._mergers[iterator];merge=this.settings.mergeFit&&Math.min(merge,this.settings.items)||merge;cache.items.merge=merge>1||cache.items.merge;widths[iterator]=!grid?this._items[iterator].width():width*merge}this._widths=widths}},{filter:["items","settings"],run:function(){var clones=[],items=this._items,settings=this.settings,view=Math.max(settings.items*2,4),size=Math.ceil(items.length/2)*2,repeat=settings.loop&&items.length?settings.rewind?view:Math.max(view,size):0,append="",prepend="";repeat/=2;while(repeat--){clones.push(this.normalize(clones.length/2,true));append=append+items[clones[clones.length-1]][0].outerHTML;clones.push(this.normalize(items.length-1-(clones.length-1)/2,true));prepend=items[clones[clones.length-1]][0].outerHTML+prepend}this._clones=clones;$(append).addClass("cloned").appendTo(this.$stage);$(prepend).addClass("cloned").prependTo(this.$stage)}},{filter:["width","items","settings"],run:function(){var rtl=this.settings.rtl?1:-1,size=this._clones.length+this._items.length,iterator=-1,previous=0,current=0,coordinates=[];while(++iterator<size){previous=coordinates[iterator-1]||0;current=this._widths[this.relative(iterator)]+this.settings.margin;coordinates.push(previous+current*rtl)}this._coordinates=coordinates}},{filter:["width","items","settings"],run:function(){var padding=this.settings.stagePadding,coordinates=this._coordinates,css={width:Math.ceil(Math.abs(coordinates[coordinates.length-1]))+padding*2,"padding-left":padding||"","padding-right":padding||""};this.$stage.css(css)}},{filter:["width","items","settings"],run:function(cache){var iterator=this._coordinates.length,grid=!this.settings.autoWidth,items=this.$stage.children();if(grid&&cache.items.merge){while(iterator--){cache.css.width=this._widths[this.relative(iterator)];items.eq(iterator).css(cache.css)}}else if(grid){cache.css.width=cache.items.width;items.css(cache.css)}}},{filter:["items"],run:function(){this._coordinates.length<1&&this.$stage.removeAttr("style")}},{filter:["width","items","settings"],run:function(cache){cache.current=cache.current?this.$stage.children().index(cache.current):0;cache.current=Math.max(this.minimum(),Math.min(this.maximum(),cache.current));this.reset(cache.current)}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var rtl=this.settings.rtl?1:-1,padding=this.settings.stagePadding*2,begin=this.coordinates(this.current())+padding,end=begin+this.width()*rtl,inner,outer,matches=[],i,n;for(i=0,n=this._coordinates.length;i<n;i++){inner=this._coordinates[i-1]||0;outer=Math.abs(this._coordinates[i])+padding*rtl;if(this.op(inner,"<=",begin)&&this.op(inner,">",end)||this.op(outer,"<",begin)&&this.op(outer,">",end)){matches.push(i)}}this.$stage.children(".active").removeClass("active");this.$stage.children(":eq("+matches.join("), :eq(")+")").addClass("active");if(this.settings.center){this.$stage.children(".center").removeClass("center");this.$stage.children().eq(this.current()).addClass("center")}}}];Owl.prototype.initialize=function(){this.enter("initializing");this.trigger("initialize");this.$element.toggleClass(this.settings.rtlClass,this.settings.rtl);if(this.settings.autoWidth&&!this.is("pre-loading")){var imgs,nestedSelector,width;imgs=this.$element.find("img");nestedSelector=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:undefined;width=this.$element.children(nestedSelector).width();if(imgs.length&&width<=0){this.preloadAutoWidthImages(imgs)}}this.$element.addClass(this.options.loadingClass);this.$stage=$("<"+this.settings.stageElement+' class="'+this.settings.stageClass+'"/>').wrap('<div class="'+this.settings.stageOuterClass+'"/>');this.$element.append(this.$stage.parent());this.replace(this.$element.children().not(this.$stage.parent()));if(this.$element.is(":visible")){this.refresh()}else{this.invalidate("width")}this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass);this.registerEventHandlers();this.leave("initializing");this.trigger("initialized")};Owl.prototype.setup=function(){var viewport=this.viewport(),overwrites=this.options.responsive,match=-1,settings=null;if(!overwrites){settings=$.extend({},this.options)}else{$.each(overwrites,function(breakpoint){if(breakpoint<=viewport&&breakpoint>match){match=Number(breakpoint)}});settings=$.extend({},this.options,overwrites[match]);delete settings.responsive;if(settings.responsiveClass){this.$element.attr("class",this.$element.attr("class").replace(new RegExp("("+this.options.responsiveClass+"-)\\S+\\s","g"),"$1"+match))}}if(this.settings===null||this._breakpoint!==match){this.trigger("change",{property:{name:"settings",value:settings}});this._breakpoint=match;this.settings=settings;this.invalidate("settings");this.trigger("changed",{property:{name:"settings",value:this.settings}})}};Owl.prototype.optionsLogic=function(){if(this.settings.autoWidth){this.settings.stagePadding=false;this.settings.merge=false}};Owl.prototype.prepare=function(item){var event=this.trigger("prepare",{content:item});if(!event.data){event.data=$("<"+this.settings.itemElement+"/>").addClass(this.options.itemClass).append(item)}this.trigger("prepared",{content:event.data});return event.data};Owl.prototype.update=function(){var i=0,n=this._pipe.length,filter=$.proxy(function(p){return this[p]},this._invalidated),cache={};while(i<n){if(this._invalidated.all||$.grep(this._pipe[i].filter,filter).length>0){this._pipe[i].run(cache)}i++}this._invalidated={};!this.is("valid")&&this.enter("valid")};Owl.prototype.width=function(dimension){dimension=dimension||Owl.Width.Default;switch(dimension){case Owl.Width.Inner:case Owl.Width.Outer:return this._width;default:return this._width-this.settings.stagePadding*2+this.settings.margin}};Owl.prototype.refresh=function(){this.enter("refreshing");this.trigger("refresh");this.setup();this.optionsLogic();this.$element.addClass(this.options.refreshClass);this.update();this.$element.removeClass(this.options.refreshClass);this.leave("refreshing");this.trigger("refreshed")};Owl.prototype.onThrottledResize=function(){window.clearTimeout(this.resizeTimer);this.resizeTimer=window.setTimeout(this._handlers.onResize,this.settings.responsiveRefreshRate)};Owl.prototype.onResize=function(){if(!this._items.length){return false}if(this._width===this.$element.width()){return false}if(!this.$element.is(":visible")){return false}this.enter("resizing");if(this.trigger("resize").isDefaultPrevented()){this.leave("resizing");return false}this.invalidate("width");this.refresh();this.leave("resizing");this.trigger("resized")};Owl.prototype.registerEventHandlers=function(){if($.support.transition){this.$stage.on($.support.transition.end+".owl.core",$.proxy(this.onTransitionEnd,this))}if(this.settings.responsive!==false){this.on(window,"resize",this._handlers.onThrottledResize)}if(this.settings.mouseDrag){this.$element.addClass(this.options.dragClass);this.$stage.on("mousedown.owl.core",$.proxy(this.onDragStart,this));this.$stage.on("dragstart.owl.core selectstart.owl.core",function(){return false})}if(this.settings.touchDrag){this.$stage.on("touchstart.owl.core",$.proxy(this.onDragStart,this));this.$stage.on("touchcancel.owl.core",$.proxy(this.onDragEnd,this))}};Owl.prototype.onDragStart=function(event){var stage=null;if(event.which===3){return}if($.support.transform){stage=this.$stage.css("transform").replace(/.*\(|\)| /g,"").split(",");stage={x:stage[stage.length===16?12:4],y:stage[stage.length===16?13:5]}}else{stage=this.$stage.position();stage={x:this.settings.rtl?stage.left+this.$stage.width()-this.width()+this.settings.margin:stage.left,y:stage.top}}if(this.is("animating")){$.support.transform?this.animate(stage.x):this.$stage.stop();this.invalidate("position")}this.$element.toggleClass(this.options.grabClass,event.type==="mousedown");this.speed(0);this._drag.time=(new Date).getTime();this._drag.target=$(event.target);this._drag.stage.start=stage;this._drag.stage.current=stage;this._drag.pointer=this.pointer(event);$(document).on("mouseup.owl.core touchend.owl.core",$.proxy(this.onDragEnd,this));$(document).one("mousemove.owl.core touchmove.owl.core",$.proxy(function(event){var delta=this.difference(this._drag.pointer,this.pointer(event));$(document).on("mousemove.owl.core touchmove.owl.core",$.proxy(this.onDragMove,this));if(Math.abs(delta.x)<Math.abs(delta.y)&&this.is("valid")){return}event.preventDefault();this.enter("dragging");this.trigger("drag")},this))};Owl.prototype.onDragMove=function(event){var minimum=null,maximum=null,pull=null,delta=this.difference(this._drag.pointer,this.pointer(event)),stage=this.difference(this._drag.stage.start,delta);if(!this.is("dragging")){return}event.preventDefault();if(this.settings.loop){minimum=this.coordinates(this.minimum());maximum=this.coordinates(this.maximum()+1)-minimum;stage.x=((stage.x-minimum)%maximum+maximum)%maximum+minimum}else{minimum=this.settings.rtl?this.coordinates(this.maximum()):this.coordinates(this.minimum());maximum=this.settings.rtl?this.coordinates(this.minimum()):this.coordinates(this.maximum());pull=this.settings.pullDrag?-1*delta.x/5:0;stage.x=Math.max(Math.min(stage.x,minimum+pull),maximum+pull)}this._drag.stage.current=stage;this.animate(stage.x)};Owl.prototype.onDragEnd=function(event){var delta=this.difference(this._drag.pointer,this.pointer(event)),stage=this._drag.stage.current,direction=delta.x>0^this.settings.rtl?"left":"right";$(document).off(".owl.core");this.$element.removeClass(this.options.grabClass);if(delta.x!==0&&this.is("dragging")||!this.is("valid")){this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed);this.current(this.closest(stage.x,delta.x!==0?direction:this._drag.direction));this.invalidate("position");this.update();this._drag.direction=direction;if(Math.abs(delta.x)>3||(new Date).getTime()-this._drag.time>300){this._drag.target.one("click.owl.core",function(){return false})}}if(!this.is("dragging")){return}this.leave("dragging");this.trigger("dragged")};Owl.prototype.closest=function(coordinate,direction){var position=-1,pull=30,width=this.width(),coordinates=this.coordinates();if(!this.settings.freeDrag){$.each(coordinates,$.proxy(function(index,value){if(coordinate>value-pull&&coordinate<value+pull){position=index}else if(this.op(coordinate,"<",value)&&this.op(coordinate,">",coordinates[index+1]||value-width)){position=direction==="left"?index+1:index}return position===-1},this))}if(!this.settings.loop){if(this.op(coordinate,">",coordinates[this.minimum()])){position=coordinate=this.minimum()}else if(this.op(coordinate,"<",coordinates[this.maximum()])){position=coordinate=this.maximum()}}return position};Owl.prototype.animate=function(coordinate){var animate=this.speed()>0;this.is("animating")&&this.onTransitionEnd();if(animate){this.enter("animating");this.trigger("translate")}if($.support.transform3d&&$.support.transition){this.$stage.css({transform:"translate3d("+coordinate+"px,0px,0px)",transition:this.speed()/1e3+"s"})}else if(animate){this.$stage.animate({left:coordinate+"px"},this.speed(),this.settings.fallbackEasing,$.proxy(this.onTransitionEnd,this))}else{this.$stage.css({left:coordinate+"px"})}};Owl.prototype.is=function(state){return this._states.current[state]&&this._states.current[state]>0};Owl.prototype.current=function(position){if(position===undefined){return this._current}if(this._items.length===0){return undefined}position=this.normalize(position);if(this._current!==position){var event=this.trigger("change",{property:{name:"position",value:position}});if(event.data!==undefined){position=this.normalize(event.data)}this._current=position;this.invalidate("position");this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current};Owl.prototype.invalidate=function(part){if($.type(part)==="string"){this._invalidated[part]=true;this.is("valid")&&this.leave("valid")}return $.map(this._invalidated,function(v,i){return i})};Owl.prototype.reset=function(position){position=this.normalize(position);if(position===undefined){return}this._speed=0;this._current=position;this.suppress(["translate","translated"]);this.animate(this.coordinates(position));this.release(["translate","translated"])};Owl.prototype.normalize=function(position,relative){var n=this._items.length,m=relative?0:this._clones.length;if(!$.isNumeric(position)||n<1){position=undefined}else if(position<0||position>=n+m){position=((position-m/2)%n+n)%n+m/2}return position};Owl.prototype.relative=function(position){position-=this._clones.length/2;return this.normalize(position,true)};Owl.prototype.maximum=function(relative){var settings=this.settings,maximum=this._coordinates.length,boundary=Math.abs(this._coordinates[maximum-1])-this._width,i=-1,j;if(settings.loop){maximum=this._clones.length/2+this._items.length-1}else if(settings.autoWidth||settings.merge){while(maximum-i>1){Math.abs(this._coordinates[j=maximum+i>>1])<boundary?i=j:maximum=j}}else if(settings.center){maximum=this._items.length-1}else{maximum=this._items.length-settings.items}if(relative){maximum-=this._clones.length/2}return Math.max(maximum,0)};Owl.prototype.minimum=function(relative){return relative?0:this._clones.length/2};Owl.prototype.items=function(position){if(position===undefined){return this._items.slice()}position=this.normalize(position,true);return this._items[position]};Owl.prototype.mergers=function(position){if(position===undefined){return this._mergers.slice()}position=this.normalize(position,true);return this._mergers[position]};Owl.prototype.clones=function(position){var odd=this._clones.length/2,even=odd+this._items.length,map=function(index){return index%2===0?even+index/2:odd-(index+1)/2};if(position===undefined){return $.map(this._clones,function(v,i){return map(i)})}return $.map(this._clones,function(v,i){return v===position?map(i):null})};Owl.prototype.speed=function(speed){if(speed!==undefined){this._speed=speed}return this._speed};Owl.prototype.coordinates=function(position){var coordinate=null;if(position===undefined){return $.map(this._coordinates,$.proxy(function(coordinate,index){return this.coordinates(index)},this))}if(this.settings.center){coordinate=this._coordinates[position];coordinate+=(this.width()-coordinate+(this._coordinates[position-1]||0))/2*(this.settings.rtl?-1:1)}else{coordinate=this._coordinates[position-1]||0}return coordinate};Owl.prototype.duration=function(from,to,factor){return Math.min(Math.max(Math.abs(to-from),1),6)*Math.abs(factor||this.settings.smartSpeed)};Owl.prototype.to=function(position,speed){var current=this.current(),revert=null,distance=position-this.relative(current),direction=(distance>0)-(distance<0),items=this._items.length,minimum=this.minimum(),maximum=this.maximum();if(this.settings.loop){if(!this.settings.rewind&&Math.abs(distance)>items/2){distance+=direction*-1*items}position=current+distance;revert=((position-minimum)%items+items)%items+minimum;if(revert!==position&&revert-distance<=maximum&&revert-distance>0){current=revert-distance;position=revert;this.reset(current)}}else if(this.settings.rewind){maximum+=1;position=(position%maximum+maximum)%maximum}else{position=Math.max(minimum,Math.min(maximum,position))}this.speed(this.duration(current,position,speed));this.current(position);if(this.$element.is(":visible")){this.update()}};Owl.prototype.next=function(speed){speed=speed||false;this.to(this.relative(this.current())+1,speed)};Owl.prototype.prev=function(speed){speed=speed||false;this.to(this.relative(this.current())-1,speed)};Owl.prototype.onTransitionEnd=function(event){if(event!==undefined){event.stopPropagation();if((event.target||event.srcElement||event.originalTarget)!==this.$stage.get(0)){return false}}this.leave("animating");this.trigger("translated")};Owl.prototype.viewport=function(){var width;if(this.options.responsiveBaseElement!==window){width=$(this.options.responsiveBaseElement).width()}else if(window.innerWidth){width=window.innerWidth}else if(document.documentElement&&document.documentElement.clientWidth){width=document.documentElement.clientWidth}else{throw"Can not detect viewport width."}return width};Owl.prototype.replace=function(content){this.$stage.empty();this._items=[];if(content){content=content instanceof jQuery?content:$(content)}if(this.settings.nestedItemSelector){content=content.find("."+this.settings.nestedItemSelector)}content.filter(function(){return this.nodeType===1}).each($.proxy(function(index,item){item=this.prepare(item);this.$stage.append(item);this._items.push(item);this._mergers.push(item.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")*1||1)},this));this.reset($.isNumeric(this.settings.startPosition)?this.settings.startPosition:0);this.invalidate("items")};Owl.prototype.add=function(content,position){var current=this.relative(this._current);position=position===undefined?this._items.length:this.normalize(position,true);content=content instanceof jQuery?content:$(content);this.trigger("add",{content:content,position:position});content=this.prepare(content);if(this._items.length===0||position===this._items.length){this._items.length===0&&this.$stage.append(content);this._items.length!==0&&this._items[position-1].after(content);this._items.push(content);this._mergers.push(content.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")*1||1)}else{this._items[position].before(content);this._items.splice(position,0,content);this._mergers.splice(position,0,content.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")*1||1)}this._items[current]&&this.reset(this._items[current].index());this.invalidate("items");this.trigger("added",{content:content,position:position})};Owl.prototype.remove=function(position){position=this.normalize(position,true);if(position===undefined){return}this.trigger("remove",{content:this._items[position],position:position});this._items[position].remove();this._items.splice(position,1);this._mergers.splice(position,1);this.invalidate("items");this.trigger("removed",{content:null,position:position})};Owl.prototype.preloadAutoWidthImages=function(images){images.each($.proxy(function(i,element){this.enter("pre-loading");element=$(element);$(new Image).one("load",$.proxy(function(e){element.attr("src",e.target.src);element.css("opacity",1);this.leave("pre-loading");!this.is("pre-loading")&&!this.is("initializing")&&this.refresh()},this)).attr("src",element.attr("src")||element.attr("data-src")||element.attr("data-src-retina"))},this))};Owl.prototype.destroy=function(){this.$element.off(".owl.core");this.$stage.off(".owl.core");$(document).off(".owl.core");if(this.settings.responsive!==false){window.clearTimeout(this.resizeTimer);this.off(window,"resize",this._handlers.onThrottledResize)}for(var i in this._plugins){this._plugins[i].destroy()}this.$stage.children(".cloned").remove();this.$stage.unwrap();this.$stage.children().contents().unwrap();this.$stage.children().unwrap();this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class",this.$element.attr("class").replace(new RegExp(this.options.responsiveClass+"-\\S+\\s","g"),"")).removeData("owl.carousel")};Owl.prototype.op=function(a,o,b){var rtl=this.settings.rtl;switch(o){case"<":return rtl?a>b:a<b;case">":return rtl?a<b:a>b;case">=":return rtl?a<=b:a>=b;case"<=":return rtl?a>=b:a<=b;default:break}};Owl.prototype.on=function(element,event,listener,capture){if(element.addEventListener){element.addEventListener(event,listener,capture)}else if(element.attachEvent){element.attachEvent("on"+event,listener)}};Owl.prototype.off=function(element,event,listener,capture){if(element.removeEventListener){element.removeEventListener(event,listener,capture)}else if(element.detachEvent){element.detachEvent("on"+event,listener)}};Owl.prototype.trigger=function(name,data,namespace,state,enter){var status={item:{count:this._items.length,index:this.current()}},handler=$.camelCase($.grep(["on",name,namespace],function(v){return v}).join("-").toLowerCase()),event=$.Event([name,"owl",namespace||"carousel"].join(".").toLowerCase(),$.extend({relatedTarget:this},status,data));if(!this._supress[name]){$.each(this._plugins,function(name,plugin){if(plugin.onTrigger){plugin.onTrigger(event)}});this.register({type:Owl.Type.Event,name:name});this.$element.trigger(event);if(this.settings&&typeof this.settings[handler]==="function"){this.settings[handler].call(this,event)}}return event};Owl.prototype.enter=function(name){$.each([name].concat(this._states.tags[name]||[]),$.proxy(function(i,name){if(this._states.current[name]===undefined){this._states.current[name]=0}this._states.current[name]++},this))};Owl.prototype.leave=function(name){$.each([name].concat(this._states.tags[name]||[]),$.proxy(function(i,name){this._states.current[name]--},this))};Owl.prototype.register=function(object){if(object.type===Owl.Type.Event){if(!$.event.special[object.name]){$.event.special[object.name]={}}if(!$.event.special[object.name].owl){var _default=$.event.special[object.name]._default;$.event.special[object.name]._default=function(e){if(_default&&_default.apply&&(!e.namespace||e.namespace.indexOf("owl")===-1)){return _default.apply(this,arguments)}return e.namespace&&e.namespace.indexOf("owl")>-1};$.event.special[object.name].owl=true}}else if(object.type===Owl.Type.State){if(!this._states.tags[object.name]){this._states.tags[object.name]=object.tags}else{this._states.tags[object.name]=this._states.tags[object.name].concat(object.tags)}this._states.tags[object.name]=$.grep(this._states.tags[object.name],$.proxy(function(tag,i){return $.inArray(tag,this._states.tags[object.name])===i},this))}};Owl.prototype.suppress=function(events){$.each(events,$.proxy(function(index,event){this._supress[event]=true},this))};Owl.prototype.release=function(events){$.each(events,$.proxy(function(index,event){delete this._supress[event]},this))};Owl.prototype.pointer=function(event){var result={x:null,y:null};event=event.originalEvent||event||window.event;event=event.touches&&event.touches.length?event.touches[0]:event.changedTouches&&event.changedTouches.length?event.changedTouches[0]:event;if(event.pageX){result.x=event.pageX;result.y=event.pageY}else{result.x=event.clientX;result.y=event.clientY}return result};Owl.prototype.difference=function(first,second){return{x:first.x-second.x,y:first.y-second.y}};$.fn.owlCarousel=function(option){var args=Array.prototype.slice.call(arguments,1);return this.each(function(){var $this=$(this),data=$this.data("owl.carousel");if(!data){data=new Owl(this,typeof option=="object"&&option);$this.data("owl.carousel",data);$.each(["next","prev","to","destroy","refresh","replace","add","remove"],function(i,event){data.register({type:Owl.Type.Event,name:event});data.$element.on(event+".owl.carousel.core",$.proxy(function(e){if(e.namespace&&e.relatedTarget!==this){this.suppress([event]);data[event].apply(this,[].slice.call(arguments,1));this.release([event])}},data))})}if(typeof option=="string"&&option.charAt(0)!=="_"){data[option].apply(data,args)}})};$.fn.owlCarousel.Constructor=Owl})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var AutoRefresh=function(carousel){this._core=carousel;this._interval=null;this._visible=null;this._handlers={"initialized.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.autoRefresh){this.watch()}},this)};this._core.options=$.extend({},AutoRefresh.Defaults,this._core.options);this._core.$element.on(this._handlers)};AutoRefresh.Defaults={autoRefresh:true,autoRefreshInterval:500};AutoRefresh.prototype.watch=function(){if(this._interval){return}this._visible=this._core.$element.is(":visible");this._interval=window.setInterval($.proxy(this.refresh,this),this._core.settings.autoRefreshInterval)};AutoRefresh.prototype.refresh=function(){if(this._core.$element.is(":visible")===this._visible){return}this._visible=!this._visible;this._core.$element.toggleClass("owl-hidden",!this._visible);this._visible&&(this._core.invalidate("width")&&this._core.refresh())};AutoRefresh.prototype.destroy=function(){var handler,property;window.clearInterval(this._interval);for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.AutoRefresh=AutoRefresh})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var Lazy=function(carousel){this._core=carousel;this._loaded=[];this._handlers={"initialized.owl.carousel change.owl.carousel":$.proxy(function(e){if(!e.namespace){return}if(!this._core.settings||!this._core.settings.lazyLoad){return}if(e.property&&e.property.name=="position"||e.type=="initialized"){var settings=this._core.settings,n=settings.center&&Math.ceil(settings.items/2)||settings.items,i=settings.center&&n*-1||0,position=(e.property&&e.property.value||this._core.current())+i,clones=this._core.clones().length,load=$.proxy(function(i,v){this.load(v)},this);while(i++<n){this.load(clones/2+this._core.relative(position));clones&&$.each(this._core.clones(this._core.relative(position)),load);position++}}},this)};this._core.options=$.extend({},Lazy.Defaults,this._core.options);this._core.$element.on(this._handlers)};Lazy.Defaults={lazyLoad:false};Lazy.prototype.load=function(position){var $item=this._core.$stage.children().eq(position),$elements=$item&&$item.find(".owl-lazy");if(!$elements||$.inArray($item.get(0),this._loaded)>-1){return}$elements.each($.proxy(function(index,element){var $element=$(element),image,url=window.devicePixelRatio>1&&$element.attr("data-src-retina")||$element.attr("data-src");this._core.trigger("load",{element:$element,url:url},"lazy");if($element.is("img")){$element.one("load.owl.lazy",$.proxy(function(){$element.css("opacity",1);this._core.trigger("loaded",{element:$element,url:url},"lazy")},this)).attr("src",url)}else{image=new Image;image.onload=$.proxy(function(){$element.css({"background-image":"url("+url+")",opacity:"1"});this._core.trigger("loaded",{element:$element,url:url},"lazy")},this);image.src=url}},this));this._loaded.push($item.get(0))};Lazy.prototype.destroy=function(){var handler,property;for(handler in this.handlers){this._core.$element.off(handler,this.handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.Lazy=Lazy})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var AutoHeight=function(carousel){this._core=carousel;this._handlers={"initialized.owl.carousel refreshed.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.autoHeight){this.update()}},this),"changed.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.autoHeight&&e.property.name=="position"){this.update()}},this),"loaded.owl.lazy":$.proxy(function(e){if(e.namespace&&this._core.settings.autoHeight&&e.element.closest("."+this._core.settings.itemClass).index()===this._core.current()){this.update()}},this)};this._core.options=$.extend({},AutoHeight.Defaults,this._core.options);this._core.$element.on(this._handlers)};AutoHeight.Defaults={autoHeight:false,autoHeightClass:"owl-height"};AutoHeight.prototype.update=function(){var start=this._core._current,end=start+this._core.settings.items,visible=this._core.$stage.children().toArray().slice(start,end);heights=[],maxheight=0;$.each(visible,function(index,item){heights.push($(item).height())});maxheight=Math.max.apply(null,heights);this._core.$stage.parent().height(maxheight).addClass(this._core.settings.autoHeightClass)};AutoHeight.prototype.destroy=function(){var handler,property;for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.AutoHeight=AutoHeight})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var Video=function(carousel){this._core=carousel;this._videos={};this._playing=null;this._handlers={"initialized.owl.carousel":$.proxy(function(e){if(e.namespace){this._core.register({type:"state",name:"playing",tags:["interacting"]})}},this),"resize.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.video&&this.isInFullScreen()){e.preventDefault()}},this),"refreshed.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.is("resizing")){this._core.$stage.find(".cloned .owl-video-frame").remove()}},this),"changed.owl.carousel":$.proxy(function(e){if(e.namespace&&e.property.name==="position"&&this._playing){this.stop()}},this),"prepared.owl.carousel":$.proxy(function(e){if(!e.namespace){return}var $element=$(e.content).find(".owl-video");if($element.length){$element.css("display","none");this.fetch($element,$(e.content))}},this)};this._core.options=$.extend({},Video.Defaults,this._core.options);this._core.$element.on(this._handlers);this._core.$element.on("click.owl.video",".owl-video-play-icon",$.proxy(function(e){this.play(e)
},this))};Video.Defaults={video:false,videoHeight:false,videoWidth:false};Video.prototype.fetch=function(target,item){var type=target.attr("data-vimeo-id")?"vimeo":"youtube",id=target.attr("data-vimeo-id")||target.attr("data-youtube-id"),width=target.attr("data-width")||this._core.settings.videoWidth,height=target.attr("data-height")||this._core.settings.videoHeight,url=target.attr("href");if(url){id=url.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/);if(id[3].indexOf("youtu")>-1){type="youtube"}else if(id[3].indexOf("vimeo")>-1){type="vimeo"}else{throw new Error("Video URL not supported.")}id=id[6]}else{throw new Error("Missing video URL.")}this._videos[url]={type:type,id:id,width:width,height:height};item.attr("data-video",url);this.thumbnail(target,this._videos[url])};Video.prototype.thumbnail=function(target,video){var tnLink,icon,path,dimensions=video.width&&video.height?'style="width:'+video.width+"px;height:"+video.height+'px;"':"",customTn=target.find("img"),srcType="src",lazyClass="",settings=this._core.settings,create=function(path){icon='<div class="owl-video-play-icon"></div>';if(settings.lazyLoad){tnLink='<div class="owl-video-tn '+lazyClass+'" '+srcType+'="'+path+'"></div>'}else{tnLink='<div class="owl-video-tn" style="opacity:1;background-image:url('+path+')"></div>'}target.after(tnLink);target.after(icon)};target.wrap('<div class="owl-video-wrapper"'+dimensions+"></div>");if(this._core.settings.lazyLoad){srcType="data-src";lazyClass="owl-lazy"}if(customTn.length){create(customTn.attr(srcType));customTn.remove();return false}if(video.type==="youtube"){path="http://img.youtube.com/vi/"+video.id+"/hqdefault.jpg";create(path)}else if(video.type==="vimeo"){$.ajax({type:"GET",url:"http://vimeo.com/api/v2/video/"+video.id+".json",jsonp:"callback",dataType:"jsonp",success:function(data){path=data[0].thumbnail_large;create(path)}})}};Video.prototype.stop=function(){this._core.trigger("stop",null,"video");this._playing.find(".owl-video-frame").remove();this._playing.removeClass("owl-video-playing");this._playing=null;this._core.leave("playing");this._core.trigger("stopped",null,"video")};Video.prototype.play=function(event){var target=$(event.target),item=target.closest("."+this._core.settings.itemClass),video=this._videos[item.attr("data-video")],width=video.width||"100%",height=video.height||this._core.$stage.height(),html;if(this._playing){return}this._core.enter("playing");this._core.trigger("play",null,"video");item=this._core.items(this._core.relative(item.index()));this._core.reset(item.index());if(video.type==="youtube"){html='<iframe width="'+width+'" height="'+height+'" src="http://www.youtube.com/embed/'+video.id+"?autoplay=1&v="+video.id+'" frameborder="0" allowfullscreen></iframe>'}else if(video.type==="vimeo"){html='<iframe src="http://player.vimeo.com/video/'+video.id+'?autoplay=1" width="'+width+'" height="'+height+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'}$('<div class="owl-video-frame">'+html+"</div>").insertAfter(item.find(".owl-video"));this._playing=item.addClass("owl-video-playing")};Video.prototype.isInFullScreen=function(){var element=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;return element&&$(element).parent().hasClass("owl-video-frame")};Video.prototype.destroy=function(){var handler,property;this._core.$element.off("click.owl.video");for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.Video=Video})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var Animate=function(scope){this.core=scope;this.core.options=$.extend({},Animate.Defaults,this.core.options);this.swapping=true;this.previous=undefined;this.next=undefined;this.handlers={"change.owl.carousel":$.proxy(function(e){if(e.namespace&&e.property.name=="position"){this.previous=this.core.current();this.next=e.property.value}},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":$.proxy(function(e){if(e.namespace){this.swapping=e.type=="translated"}},this),"translate.owl.carousel":$.proxy(function(e){if(e.namespace&&this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)){this.swap()}},this)};this.core.$element.on(this.handlers)};Animate.Defaults={animateOut:false,animateIn:false};Animate.prototype.swap=function(){if(this.core.settings.items!==1){return}if(!$.support.animation||!$.support.transition){return}this.core.speed(0);var left,clear=$.proxy(this.clear,this),previous=this.core.$stage.children().eq(this.previous),next=this.core.$stage.children().eq(this.next),incoming=this.core.settings.animateIn,outgoing=this.core.settings.animateOut;if(this.core.current()===this.previous){return}if(outgoing){left=this.core.coordinates(this.previous)-this.core.coordinates(this.next);previous.one($.support.animation.end,clear).css({left:left+"px"}).addClass("animated owl-animated-out").addClass(outgoing)}if(incoming){next.one($.support.animation.end,clear).addClass("animated owl-animated-in").addClass(incoming)}};Animate.prototype.clear=function(e){$(e.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut);this.core.onTransitionEnd()};Animate.prototype.destroy=function(){var handler,property;for(handler in this.handlers){this.core.$element.off(handler,this.handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.Animate=Animate})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var Autoplay=function(carousel){this._core=carousel;this._interval=null;this._paused=false;this._handlers={"changed.owl.carousel":$.proxy(function(e){if(e.namespace&&e.property.name==="settings"){if(this._core.settings.autoplay){this.play()}else{this.stop()}}},this),"initialized.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.autoplay){this.play()}},this),"play.owl.autoplay":$.proxy(function(e,t,s){if(e.namespace){this.play(t,s)}},this),"stop.owl.autoplay":$.proxy(function(e){if(e.namespace){this.stop()}},this),"mouseover.owl.autoplay":$.proxy(function(){if(this._core.settings.autoplayHoverPause&&this._core.is("rotating")){this.pause()}},this),"mouseleave.owl.autoplay":$.proxy(function(){if(this._core.settings.autoplayHoverPause&&this._core.is("rotating")){this.play()}},this)};this._core.$element.on(this._handlers);this._core.options=$.extend({},Autoplay.Defaults,this._core.options)};Autoplay.Defaults={autoplay:false,autoplayTimeout:5e3,autoplayHoverPause:false,autoplaySpeed:false};Autoplay.prototype.play=function(timeout,speed){this._paused=false;if(this._core.is("rotating")){return}this._core.enter("rotating");this._interval=window.setInterval($.proxy(function(){if(this._paused||this._core.is("busy")||this._core.is("interacting")||document.hidden){return}this._core.next(speed||this._core.settings.autoplaySpeed)},this),timeout||this._core.settings.autoplayTimeout)};Autoplay.prototype.stop=function(){if(!this._core.is("rotating")){return}window.clearInterval(this._interval);this._core.leave("rotating")};Autoplay.prototype.pause=function(){if(!this._core.is("rotating")){return}this._paused=true};Autoplay.prototype.destroy=function(){var handler,property;this.stop();for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.autoplay=Autoplay})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){"use strict";var Navigation=function(carousel){this._core=carousel;this._initialized=false;this._pages=[];this._controls={};this._templates=[];this.$element=this._core.$element;this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to};this._handlers={"prepared.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.dotsData){this._templates.push('<div class="'+this._core.settings.dotClass+'">'+$(e.content).find("[data-dot]").andSelf("[data-dot]").attr("data-dot")+"</div>")}},this),"added.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.dotsData){this._templates.splice(e.position,0,this._templates.pop())}},this),"remove.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.dotsData){this._templates.splice(e.position,1)}},this),"changed.owl.carousel":$.proxy(function(e){if(e.namespace&&e.property.name=="position"){this.draw()}},this),"initialized.owl.carousel":$.proxy(function(e){if(e.namespace&&!this._initialized){this._core.trigger("initialize",null,"navigation");this.initialize();this.update();this.draw();this._initialized=true;this._core.trigger("initialized",null,"navigation")}},this),"refreshed.owl.carousel":$.proxy(function(e){if(e.namespace&&this._initialized){this._core.trigger("refresh",null,"navigation");this.update();this.draw();this._core.trigger("refreshed",null,"navigation")}},this)};this._core.options=$.extend({},Navigation.Defaults,this._core.options);this.$element.on(this._handlers)};Navigation.Defaults={nav:false,navText:["prev","next"],navSpeed:false,navElement:"div",navContainer:false,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:true,dotsEach:false,dotsData:false,dotsSpeed:false,dotsContainer:false};Navigation.prototype.initialize=function(){var override,settings=this._core.settings;this._controls.$relative=(settings.navContainer?$(settings.navContainer):$("<div>").addClass(settings.navContainerClass).appendTo(this.$element)).addClass("disabled");this._controls.$previous=$("<"+settings.navElement+">").addClass(settings.navClass[0]).html(settings.navText[0]).prependTo(this._controls.$relative).on("click",$.proxy(function(e){this.prev(settings.navSpeed)},this));this._controls.$next=$("<"+settings.navElement+">").addClass(settings.navClass[1]).html(settings.navText[1]).appendTo(this._controls.$relative).on("click",$.proxy(function(e){this.next(settings.navSpeed)},this));if(!settings.dotsData){this._templates=[$("<div>").addClass(settings.dotClass).append($("<span>")).prop("outerHTML")]}this._controls.$absolute=(settings.dotsContainer?$(settings.dotsContainer):$("<div>").addClass(settings.dotsClass).appendTo(this.$element)).addClass("disabled");this._controls.$absolute.on("click","div",$.proxy(function(e){var index=$(e.target).parent().is(this._controls.$absolute)?$(e.target).index():$(e.target).parent().index();e.preventDefault();this.to(index,settings.dotsSpeed)},this));for(override in this._overrides){this._core[override]=$.proxy(this[override],this)}};Navigation.prototype.destroy=function(){var handler,control,property,override;for(handler in this._handlers){this.$element.off(handler,this._handlers[handler])}for(control in this._controls){this._controls[control].remove()}for(override in this.overides){this._core[override]=this._overrides[override]}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};Navigation.prototype.update=function(){var i,j,k,lower=this._core.clones().length/2,upper=lower+this._core.items().length,maximum=this._core.maximum(true),settings=this._core.settings,size=settings.center||settings.autoWidth||settings.dotsData?1:settings.dotsEach||settings.items;if(settings.slideBy!=="page"){settings.slideBy=Math.min(settings.slideBy,settings.items)}if(settings.dots||settings.slideBy=="page"){this._pages=[];for(i=lower,j=0,k=0;i<upper;i++){if(j>=size||j===0){this._pages.push({start:Math.min(maximum,i-lower),end:i-lower+size-1});if(Math.min(maximum,i-lower)===maximum){break}j=0,++k}j+=this._core.mergers(this._core.relative(i))}}};Navigation.prototype.draw=function(){var difference,settings=this._core.settings,disabled=this._core.items().length<=settings.items,index=this._core.relative(this._core.current()),loop=settings.loop||settings.rewind;this._controls.$relative.toggleClass("disabled",!settings.nav||disabled);if(settings.nav){this._controls.$previous.toggleClass("disabled",!loop&&index<=this._core.minimum(true));this._controls.$next.toggleClass("disabled",!loop&&index>=this._core.maximum(true))}this._controls.$absolute.toggleClass("disabled",!settings.dots||disabled);if(settings.dots){difference=this._pages.length-this._controls.$absolute.children().length;if(settings.dotsData&&difference!==0){this._controls.$absolute.html(this._templates.join(""))}else if(difference>0){this._controls.$absolute.append(new Array(difference+1).join(this._templates[0]))}else if(difference<0){this._controls.$absolute.children().slice(difference).remove()}this._controls.$absolute.find(".active").removeClass("active");this._controls.$absolute.children().eq($.inArray(this.current(),this._pages)).addClass("active")}};Navigation.prototype.onTrigger=function(event){var settings=this._core.settings;event.page={index:$.inArray(this.current(),this._pages),count:this._pages.length,size:settings&&(settings.center||settings.autoWidth||settings.dotsData?1:settings.dotsEach||settings.items)}};Navigation.prototype.current=function(){var current=this._core.relative(this._core.current());return $.grep(this._pages,$.proxy(function(page,index){return page.start<=current&&page.end>=current},this)).pop()};Navigation.prototype.getPosition=function(successor){var position,length,settings=this._core.settings;if(settings.slideBy=="page"){position=$.inArray(this.current(),this._pages);length=this._pages.length;successor?++position:--position;position=this._pages[(position%length+length)%length].start}else{position=this._core.relative(this._core.current());length=this._core.items().length;successor?position+=settings.slideBy:position-=settings.slideBy}return position};Navigation.prototype.next=function(speed){$.proxy(this._overrides.to,this._core)(this.getPosition(true),speed)};Navigation.prototype.prev=function(speed){$.proxy(this._overrides.to,this._core)(this.getPosition(false),speed)};Navigation.prototype.to=function(position,speed,standard){var length;if(!standard){length=this._pages.length;$.proxy(this._overrides.to,this._core)(this._pages[(position%length+length)%length].start,speed)}else{$.proxy(this._overrides.to,this._core)(position,speed)}};$.fn.owlCarousel.Constructor.Plugins.Navigation=Navigation})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){"use strict";var Hash=function(carousel){this._core=carousel;this._hashes={};this.$element=this._core.$element;this._handlers={"initialized.owl.carousel":$.proxy(function(e){if(e.namespace&&this._core.settings.startPosition==="URLHash"){$(window).trigger("hashchange.owl.navigation")}},this),"prepared.owl.carousel":$.proxy(function(e){if(e.namespace){var hash=$(e.content).find("[data-hash]").andSelf("[data-hash]").attr("data-hash");if(!hash){return}this._hashes[hash]=e.content}},this),"changed.owl.carousel":$.proxy(function(e){if(e.namespace&&e.property.name==="position"){var current=this._core.items(this._core.relative(this._core.current())),hash=$.map(this._hashes,function(item,hash){return item===current?hash:null}).join();if(!hash||window.location.hash.slice(1)===hash){return}window.location.hash=hash}},this)};this._core.options=$.extend({},Hash.Defaults,this._core.options);this.$element.on(this._handlers);$(window).on("hashchange.owl.navigation",$.proxy(function(e){var hash=window.location.hash.substring(1),items=this._core.$stage.children(),position=this._hashes[hash]&&items.index(this._hashes[hash]);if(position===undefined||position===this._core.current()){return}this._core.to(this._core.relative(position),false,true)},this))};Hash.Defaults={URLhashListener:false};Hash.prototype.destroy=function(){var handler,property;$(window).off("hashchange.owl.navigation");for(handler in this._handlers){this._core.$element.off(handler,this._handlers[handler])}for(property in Object.getOwnPropertyNames(this)){typeof this[property]!="function"&&(this[property]=null)}};$.fn.owlCarousel.Constructor.Plugins.Hash=Hash})(window.Zepto||window.jQuery,window,document);(function($,window,document,undefined){var style=$("<support>").get(0).style,prefixes="Webkit Moz O ms".split(" "),events={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},tests={csstransforms:function(){return!!test("transform")},csstransforms3d:function(){return!!test("perspective")},csstransitions:function(){return!!test("transition")},cssanimations:function(){return!!test("animation")}};function test(property,prefixed){var result=false,upper=property.charAt(0).toUpperCase()+property.slice(1);$.each((property+" "+prefixes.join(upper+" ")+upper).split(" "),function(i,property){if(style[property]!==undefined){result=prefixed?property:true;return false}});return result}function prefixed(property){return test(property,true)}if(tests.csstransitions()){$.support.transition=new String(prefixed("transition"));$.support.transition.end=events.transition.end[$.support.transition]}if(tests.cssanimations()){$.support.animation=new String(prefixed("animation"));$.support.animation.end=events.animation.end[$.support.animation]}if(tests.csstransforms()){$.support.transform=new String(prefixed("transform"));$.support.transform3d=tests.csstransforms3d()}})(window.Zepto||window.jQuery,window,document);;
(function($){$.widget("custom.autocomplete",$.ui.autocomplete,{options:{highlightClass:"ui-state-highlight",highlightElement:"span"},_renderItem:function($ul,item){var term=this.term.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1","gi");var re=new RegExp("("+term+")","gi"),cls=this.options.highlightClass,el=this.options.highlightElement,template="<"+el+" class='"+cls+"'>$1</"+el+">",label=item.label.replace(re,template),$li=$("<li/>").appendTo($ul);$li.html(label);return $li}})})(jQuery);;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(){$('[data-type="lazyLoad"]').Lazy({threshold:200,asyncLoader:function(element){element.addClass("owl-carousel");element.owlCarousel({margin:20,nav:true,dots:false,lazyLoad:true,responsive:{0:{items:1},479:{items:2},768:{items:3},980:{items:3},1e3:{items:4}},onRefreshed:function(){element.find(".item").removeClass("d_n")}});element.load()}});$(".carousel_model-js").owlCarousel({margin:20,nav:true,dots:false,lazyLoad:true,responsive:{0:{items:1},479:{items:2},768:{items:3},980:{items:3},1e3:{items:4}}});$(".carousel_model-one-js").owlCarousel({nav:true,dots:false,lazyLoad:true,responsive:{0:{items:1},1e3:{items:1}}})});(function(module){function GalleryCarousel(){this.$self=this;this.$owlPhoto=null;this.$owlThumb=null}GalleryCarousel.prototype.init=function(parameters){var self=this;if(!this.validateParameters(parameters)){return}this.$owlPhoto=parameters.mainBlock||$("#"+parameters.photoId);this.$owlThumb=parameters.thumbBlock||$("#"+parameters.thumb);this.$owlThumb.owlCarousel({responsiveClass:true,nav:false,dots:false,slideBy:8,scrollPerPage:true,responsive:{479:{items:4},768:{items:6},979:{items:6},1199:{items:6}},pagination:false,lazyLoad:false,responsiveRefreshRate:100,onInitialized:function(){var current=this.current();$.each(this.items(),function(index,elem){if(index==current){$(elem).addClass("current")}else{$(elem).removeClass("current")}$(elem).off("click").on("click",function(event){self.syncPosition(event,index)})})}});this.$owlPhoto.owlCarousel({responsiveClass:true,items:1,nav:true,dots:false,lazyLoad:true,animateOut:"fadeOut",responsiveRefreshRate:200,autoHeight:true});this.attachEventListeners()};GalleryCarousel.prototype.validateParameters=function(parameters){return $("#"+parameters.photoId).length&&$("#"+parameters.thumb).length||parameters.mainBlock&&parameters.mainBlock.length&&parameters.thumbBlock&&parameters.thumbBlock.length};GalleryCarousel.prototype.attachEventListeners=function(){this.$owlThumb.on("changed.owl.carousel",this.syncPosition.bind(this));this.$owlPhoto.on("dragged.owl.carousel",this.syncPosition.bind(this));var self=this;$(".owl-next").on("click",function(event){var owlCarousel=self.$owlPhoto.data("owl.carousel");if(owlCarousel){self.syncPosition(event,owlCarousel._current)}});$(".owl-prev").on("click",function(event){var owlCarousel=self.$owlPhoto.data("owl.carousel");if(owlCarousel){self.syncPosition(event,owlCarousel._current)}})};GalleryCarousel.prototype.syncPosition=function(event,index){var position=typeof index!=="undefined"?index:event.item.index;var self=this;$.each(self.$owlThumb.data("owl.carousel")._items,function(index,elem){if(index==position){$(elem).addClass("current")}else{$(elem).removeClass("current")}});self.$owlThumb.data("owl.carousel").to(position,250,true);if(self.$owlPhoto.data("owl.carousel")._current!==position){self.$owlPhoto.trigger("to.owl.carousel",[position,250,true])}};module.GalleryCarousel=GalleryCarousel})(AP);AP.cmd.push(function(){var carousel=new AP.GalleryCarousel;carousel.init({photoId:"nm-photo",thumb:"nm-thumbs"})});function carouselInit(element,$tabContent){var $carousel=$tabContent.find(element),carouselHidden=$carousel.is(":hidden");if(carouselHidden){$carousel.owlCarousel({margin:20,nav:true,dots:false,lazyLoad:true,responsive:{0:{items:1},479:{items:2},768:{items:3},980:{items:3},1e3:{items:4}}})}};
!function(a,b){a(function(){"use strict";function a(a,b){return null!=a&&null!=b&&a.toLowerCase()===b.toLowerCase()}function c(a,b){var c,d,e=a.length;if(!e||!b)return!1;for(c=b.toLowerCase(),d=0;e>d;++d)if(c===a[d].toLowerCase())return!0;return!1}function d(a){for(var b in a)h.call(a,b)&&(a[b]=new RegExp(a[b],"i"))}function e(a,b){this.ua=a||"",this._cache={},this.maxPhoneWidth=b||600}var f={};f.mobileDetectRules={phones:{iPhone:"\\biPhone\\b|\\biPod\\b",BlackBerry:"BlackBerry|\\bBB10\\b|rim[0-9]+",HTC:"HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\\bEVO\\b|T-Mobile G1|Z520m",Nexus:"Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 6",Dell:"Dell.*Streak|Dell.*Aero|Dell.*Venue|DELL.*Venue Pro|Dell Flash|Dell Smoke|Dell Mini 3iX|XCD28|XCD35|\\b001DL\\b|\\b101DL\\b|\\bGS01\\b",Motorola:"Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b",Samsung:"Samsung|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|GT-N7105|SCH-I535|SM-N900A|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205",LG:"\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|MS323)",Sony:"SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533",Asus:"Asus.*Galaxy|PadFone.*Mobile",Micromax:"Micromax.*\\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\\b",Palm:"PalmSource|Palm",Vertu:"Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature",Pantech:"PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|P2000|P7040|P7000|C790",Fly:"IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250",Wiko:"KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|SUNSET|GOA|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|CINK KING|CINK PEAX|CINK SLIM|SUBLIM",iMobile:"i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)",SimValley:"\\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\\b",Wolfgang:"AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q",Alcatel:"Alcatel",Nintendo:"Nintendo 3DS",Amoi:"Amoi",INQ:"INQ",GenericPhone:"Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|up.link|vodafone|\\bwap\\b|nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser"},tablets:{iPad:"iPad|iPad.*Mobile",NexusTablet:"Android.*Nexus[\\s]+(7|9|10)",SamsungTablet:"SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|SHV-E230S|SHW-M180K|SHW-M180L|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|SM-P601|SM-P605|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T330|SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-P550|SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T360|SM-T533|SM-T113|SM-T335|SM-T715",Kindle:"Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI)\\b",SurfaceTablet:"Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)",HPTablet:"HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10",AsusTablet:"^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|ME560CG|ME372CG|ME302KL| K010 | K017 |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|ME581CL|ME8510C|ME181C",BlackBerryTablet:"PlayBook|RIM Tablet",HTCtablet:"HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410",MotorolaTablet:"xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617",NookTablet:"Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2",AcerTablet:"Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b",ToshibaTablet:"Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO",LGTablet:"\\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\\b",FujitsuTablet:"Android.*\\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\\b",PrestigioTablet:"PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|PMT5887|PMT5001|PMT5002",LenovoTablet:"Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|B8000|B8080)(-|)(FL|F|HV|H|)",DellTablet:"Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7",YarvikTablet:"Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b",MedionTablet:"Android.*\\bOYO\\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB",ArnovaTablet:"AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2",IntensoTablet:"INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004",IRUTablet:"M702pro",MegafonTablet:"MegaFon V9|\\bZTE V9\\b|Android.*\\bMT7A\\b",EbodaTablet:"E-Boda (Supreme|Impresspeed|Izzycomm|Essential)",AllViewTablet:"Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)",ArchosTablet:"\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|)(G10| Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b",AinolTablet:"NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark",SonyTablet:"Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP612|SOT31",PhilipsTablet:"\\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\\b",CubeTablet:"Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT",CobyTablet:"MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010",MIDTablet:"M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733",MSITablet:"MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b",SMiTTablet:"Android.*(\\bMID\\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)",RockChipTablet:"Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A",FlyTablet:"IQ310|Fly Vision",bqTablet:"Android.*(bq)?.*(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|Livingstone|Cervantes|Avant|Aquaris E10)|Maxwell.*Lite|Maxwell.*Plus",HuaweiTablet:"MediaPad|MediaPad 7 Youth|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|S7-201|S7-Slim",NecTablet:"\\bN-06D|\\bN-08D",PantechTablet:"Pantech.*P4100",BronchoTablet:"Broncho.*(N701|N708|N802|a710)",VersusTablet:"TOUCHPAD.*[78910]|\\bTOUCHTAB\\b",ZyncTablet:"z1000|Z99 2G|z99|z930|z999|z990|z909|Z919|z900",PositivoTablet:"TB07STA|TB10STA|TB07FTA|TB10FTA",NabiTablet:"Android.*\\bNabi",KoboTablet:"Kobo Touch|\\bK080\\b|\\bVox\\b Build|\\bArc\\b Build",DanewTablet:"DSlide.*\\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\\b",TexetTablet:"NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|TB-436|TB-416|TB-146SE|TB-126SE",PlaystationTablet:"Playstation.*(Portable|Vita)",TrekstorTablet:"ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab",PyleAudioTablet:"\\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\\b",AdvanTablet:"Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b ",DanyTechTablet:"Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|Genius TAB GII|Genius TAB GIII|Genius Tab S1",GalapadTablet:"Android.*\\bG1\\b",MicromaxTablet:"Funbook|Micromax.*\\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\\b",KarbonnTablet:"Android.*\\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\\b",AllFineTablet:"Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide",PROSCANTablet:"\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b",YONESTablet:"BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026",ChangJiaTablet:"TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|TPC10111|TPC10203|TPC10205|TPC10503",GUTablet:"TX-A1301|TX-M9002|Q702|kf026",PointOfViewTablet:"TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10",OvermaxTablet:"OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|MagicTab|Stream|TB-08|TB-09)",HCLTablet:"HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync",DPSTablet:"DPS Dream 9|DPS Dual 7",VistureTablet:"V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10",CrestaTablet:"CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989",MediatekTablet:"\\bMT8125|MT8389|MT8135|MT8377\\b",ConcordeTablet:"Concorde([ ]+)?Tab|ConCorde ReadMan",GoCleverTablet:"GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|TAB R104|TAB R83.3|TAB A1042",ModecomTablet:"FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003",VoninoTablet:"\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b",ECSTablet:"V07OT2|TM105A|S10OT1|TR10CS1",StorexTablet:"eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab",VodafoneTablet:"SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7",EssentielBTablet:"Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2",RossMoorTablet:"RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711",iMobileTablet:"i-mobile i-note",TolinoTablet:"tolino tab [0-9.]+|tolino shine",AudioSonicTablet:"\\bC-22Q|T7-QC|T-17B|T-17P\\b",AMPETablet:"Android.* A78 ",SkkTablet:"Android.* (SKYPAD|PHOENIX|CYCLOPS)",TecnoTablet:"TECNO P9",JXDTablet:"Android.*\\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|P1000|P300|S18|S6600|S9100)\\b",iJoyTablet:"Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)",FX2Tablet:"FX2 PAD7|FX2 PAD10",XoroTablet:"KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151",ViewsonicTablet:"ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a",OdysTablet:"LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\\bXELIO\\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10",CaptivaTablet:"CAPTIVA PAD",IconbitTablet:"NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S",TeclastTablet:"T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|\\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|\\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|\\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|\\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|\\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|\\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|\\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|\\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi",OndaTablet:"\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|Vi40)\\b[\\s]+",JaytechTablet:"TPC-PA762",BlaupunktTablet:"Endeavour 800NG|Endeavour 1010",DigmaTablet:"\\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\\b",EvolioTablet:"ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\\bEvotab\\b|\\bNeura\\b",LavaTablet:"QPAD E704|\\bIvoryS\\b|E-TAB IVORY|\\bE-TAB\\b",AocTablet:"MW0811|MW0812|MW0922|MTK8382",CelkonTablet:"CT695|CT888|CT[\\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\\bCT-1\\b",WolderTablet:"miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b",MiTablet:"\\bMI PAD\\b|\\bHM NOTE 1W\\b",NibiruTablet:"Nibiru M1|Nibiru Jupiter One",NexoTablet:"NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI",LeaderTablet:"TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100",UbislateTablet:"UbiSlate[\\s]?7C",PocketBookTablet:"Pocketbook",Hudl:"Hudl HT7S3|Hudl 2",TelstraTablet:"T-Hub2",GenericTablet:"Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bJolla\\b|\\bTP750\\b"},oss:{AndroidOS:"Android",BlackBerryOS:"blackberry|\\bBB10\\b|rim tablet os",PalmOS:"PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino",SymbianOS:"Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\\bS60\\b",WindowsMobileOS:"Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Window Mobile|Windows Phone [0-9.]+|WCE;",WindowsPhoneOS:"Windows Phone 10.0|Windows Phone 8.1|Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7|Windows NT 6.[23]; ARM;",iOS:"\\biPhone.*Mobile|\\biPod|\\biPad",MeeGoOS:"MeeGo",MaemoOS:"Maemo",JavaOS:"J2ME/|\\bMIDP\\b|\\bCLDC\\b",webOS:"webOS|hpwOS",badaOS:"\\bBada\\b",BREWOS:"BREW"},uas:{Chrome:"\\bCrMo\\b|CriOS|Android.*Chrome/[.0-9]* (Mobile)?",Dolfin:"\\bDolfin\\b",Opera:"Opera.*Mini|Opera.*Mobi|Android.*Opera|Mobile.*OPR/[0-9.]+|Coast/[0-9.]+",Skyfire:"Skyfire",IE:"IEMobile|MSIEMobile",Firefox:"fennec|firefox.*maemo|(Mobile|Tablet).*Firefox|Firefox.*Mobile",Bolt:"bolt",TeaShark:"teashark",Blazer:"Blazer",Safari:"Version.*Mobile.*Safari|Safari.*Mobile|MobileSafari",Tizen:"Tizen",UCBrowser:"UC.*Browser|UCWEB",baiduboxapp:"baiduboxapp",baidubrowser:"baidubrowser",DiigoBrowser:"DiigoBrowser",Puffin:"Puffin",Mercury:"\\bMercury\\b",ObigoBrowser:"Obigo",NetFront:"NF-Browser",GenericBrowser:"NokiaBrowser|OviBrowser|OneBrowser|TwonkyBeamBrowser|SEMC.*Browser|FlyFlow|Minimo|NetFront|Novarra-Vision|MQQBrowser|MicroMessenger"},props:{Mobile:"Mobile/[VER]",Build:"Build/[VER]",Version:"Version/[VER]",VendorID:"VendorID/[VER]",iPad:"iPad.*CPU[a-z ]+[VER]",iPhone:"iPhone.*CPU[a-z ]+[VER]",iPod:"iPod.*CPU[a-z ]+[VER]",Kindle:"Kindle/[VER]",Chrome:["Chrome/[VER]","CriOS/[VER]","CrMo/[VER]"],Coast:["Coast/[VER]"],Dolfin:"Dolfin/[VER]",Firefox:"Firefox/[VER]",Fennec:"Fennec/[VER]",IE:["IEMobile/[VER];","IEMobile [VER]","MSIE [VER];","Trident/[0-9.]+;.*rv:[VER]"],NetFront:"NetFront/[VER]",NokiaBrowser:"NokiaBrowser/[VER]",Opera:[" OPR/[VER]","Opera Mini/[VER]","Version/[VER]"],"Opera Mini":"Opera Mini/[VER]","Opera Mobi":"Version/[VER]","UC Browser":"UC Browser[VER]",MQQBrowser:"MQQBrowser/[VER]",MicroMessenger:"MicroMessenger/[VER]",baiduboxapp:"baiduboxapp/[VER]",baidubrowser:"baidubrowser/[VER]",Iron:"Iron/[VER]",Safari:["Version/[VER]","Safari/[VER]"],Skyfire:"Skyfire/[VER]",Tizen:"Tizen/[VER]",Webkit:"webkit[ /][VER]",Gecko:"Gecko/[VER]",Trident:"Trident/[VER]",Presto:"Presto/[VER]",iOS:" \\bi?OS\\b [VER][ ;]{1}",Android:"Android [VER]",BlackBerry:["BlackBerry[\\w]+/[VER]","BlackBerry.*Version/[VER]","Version/[VER]"],BREW:"BREW [VER]",Java:"Java/[VER]","Windows Phone OS":["Windows Phone OS [VER]","Windows Phone [VER]"],"Windows Phone":"Windows Phone [VER]","Windows CE":"Windows CE/[VER]","Windows NT":"Windows NT [VER]",Symbian:["SymbianOS/[VER]","Symbian/[VER]"],webOS:["webOS/[VER]","hpwOS/[VER];"]},utils:{Bot:"Googlebot|facebookexternalhit|AdsBot-Google|Google Keyword Suggestion|Facebot|YandexBot|bingbot|ia_archiver|AhrefsBot|Ezooms|GSLFbot|WBSearchBot|Twitterbot|TweetmemeBot|Twikle|PaperLiBot|Wotbox|UnwindFetchor|Exabot|MJ12bot|YandexImages|TurnitinBot|Pingdom",MobileBot:"Googlebot-Mobile|AdsBot-Google-Mobile|YahooSeeker/M1A1-R2D2",DesktopMode:"WPDesktop",TV:"SonyDTV|HbbTV",WebKit:"(webkit)[ /]([\\w.]+)",Console:"\\b(Nintendo|Nintendo WiiU|Nintendo 3DS|PLAYSTATION|Xbox)\\b",Watch:"SM-V700"}},f.detectMobileBrowsers={fullPattern:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,shortPattern:/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,tabletPattern:/android|ipad|playbook|silk/i};var g,h=Object.prototype.hasOwnProperty;return f.FALLBACK_PHONE="UnknownPhone",f.FALLBACK_TABLET="UnknownTablet",f.FALLBACK_MOBILE="UnknownMobile",g="isArray"in Array?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},function(){var a,b,c,e,i,j,k=f.mobileDetectRules;for(a in k.props)if(h.call(k.props,a)){for(b=k.props[a],g(b)||(b=[b]),i=b.length,e=0;i>e;++e)c=b[e],j=c.indexOf("[VER]"),j>=0&&(c=c.substring(0,j)+"([\\w._\\+]+)"+c.substring(j+5)),b[e]=new RegExp(c,"i");k.props[a]=b}d(k.oss),d(k.phones),d(k.tablets),d(k.uas),d(k.utils),k.oss0={WindowsPhoneOS:k.oss.WindowsPhoneOS,WindowsMobileOS:k.oss.WindowsMobileOS}}(),f.findMatch=function(a,b){for(var c in a)if(h.call(a,c)&&a[c].test(b))return c;return null},f.findMatches=function(a,b){var c=[];for(var d in a)h.call(a,d)&&a[d].test(b)&&c.push(d);return c},f.getVersionStr=function(a,b){var c,d,e,g,i=f.mobileDetectRules.props;if(h.call(i,a))for(c=i[a],e=c.length,d=0;e>d;++d)if(g=c[d].exec(b),null!==g)return g[1];return null},f.getVersion=function(a,b){var c=f.getVersionStr(a,b);
return c?f.prepareVersionNo(c):NaN},f.prepareVersionNo=function(a){var b;return b=a.split(/[a-z._ \/\-]/i),1===b.length&&(a=b[0]),b.length>1&&(a=b[0]+".",b.shift(),a+=b.join("")),Number(a)},f.isMobileFallback=function(a){return f.detectMobileBrowsers.fullPattern.test(a)||f.detectMobileBrowsers.shortPattern.test(a.substr(0,4))},f.isTabletFallback=function(a){return f.detectMobileBrowsers.tabletPattern.test(a)},f.prepareDetectionCache=function(a,c,d){if(a.mobile===b){var g,h,i;return(h=f.findMatch(f.mobileDetectRules.tablets,c))?(a.mobile=a.tablet=h,void(a.phone=null)):(g=f.findMatch(f.mobileDetectRules.phones,c))?(a.mobile=a.phone=g,void(a.tablet=null)):void(f.isMobileFallback(c)?(i=e.isPhoneSized(d),i===b?(a.mobile=f.FALLBACK_MOBILE,a.tablet=a.phone=null):i?(a.mobile=a.phone=f.FALLBACK_PHONE,a.tablet=null):(a.mobile=a.tablet=f.FALLBACK_TABLET,a.phone=null)):f.isTabletFallback(c)?(a.mobile=a.tablet=f.FALLBACK_TABLET,a.phone=null):a.mobile=a.tablet=a.phone=null)}},f.mobileGrade=function(a){var b=null!==a.mobile();return a.os("iOS")&&a.version("iPad")>=4.3||a.os("iOS")&&a.version("iPhone")>=3.1||a.os("iOS")&&a.version("iPod")>=3.1||a.version("Android")>2.1&&a.is("Webkit")||a.version("Windows Phone OS")>=7||a.is("BlackBerry")&&a.version("BlackBerry")>=6||a.match("Playbook.*Tablet")||a.version("webOS")>=1.4&&a.match("Palm|Pre|Pixi")||a.match("hp.*TouchPad")||a.is("Firefox")&&a.version("Firefox")>=12||a.is("Chrome")&&a.is("AndroidOS")&&a.version("Android")>=4||a.is("Skyfire")&&a.version("Skyfire")>=4.1&&a.is("AndroidOS")&&a.version("Android")>=2.3||a.is("Opera")&&a.version("Opera Mobi")>11&&a.is("AndroidOS")||a.is("MeeGoOS")||a.is("Tizen")||a.is("Dolfin")&&a.version("Bada")>=2||(a.is("UC Browser")||a.is("Dolfin"))&&a.version("Android")>=2.3||a.match("Kindle Fire")||a.is("Kindle")&&a.version("Kindle")>=3||a.is("AndroidOS")&&a.is("NookTablet")||a.version("Chrome")>=11&&!b||a.version("Safari")>=5&&!b||a.version("Firefox")>=4&&!b||a.version("MSIE")>=7&&!b||a.version("Opera")>=10&&!b?"A":a.os("iOS")&&a.version("iPad")<4.3||a.os("iOS")&&a.version("iPhone")<3.1||a.os("iOS")&&a.version("iPod")<3.1||a.is("Blackberry")&&a.version("BlackBerry")>=5&&a.version("BlackBerry")<6||a.version("Opera Mini")>=5&&a.version("Opera Mini")<=6.5&&(a.version("Android")>=2.3||a.is("iOS"))||a.match("NokiaN8|NokiaC7|N97.*Series60|Symbian/3")||a.version("Opera Mobi")>=11&&a.is("SymbianOS")?"B":(a.version("BlackBerry")<5||a.match("MSIEMobile|Windows CE.*Mobile")||a.version("Windows Mobile")<=5.2,"C")},f.detectOS=function(a){return f.findMatch(f.mobileDetectRules.oss0,a)||f.findMatch(f.mobileDetectRules.oss,a)},f.getDeviceSmallerSide=function(){return window.screen.width<window.screen.height?window.screen.width:window.screen.height},e.prototype={constructor:e,mobile:function(){return f.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.mobile},phone:function(){return f.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.phone},tablet:function(){return f.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.tablet},userAgent:function(){return this._cache.userAgent===b&&(this._cache.userAgent=f.findMatch(f.mobileDetectRules.uas,this.ua)),this._cache.userAgent},userAgents:function(){return this._cache.userAgents===b&&(this._cache.userAgents=f.findMatches(f.mobileDetectRules.uas,this.ua)),this._cache.userAgents},os:function(){return this._cache.os===b&&(this._cache.os=f.detectOS(this.ua)),this._cache.os},version:function(a){return f.getVersion(a,this.ua)},versionStr:function(a){return f.getVersionStr(a,this.ua)},is:function(b){return c(this.userAgents(),b)||a(b,this.os())||a(b,this.phone())||a(b,this.tablet())||c(f.findMatches(f.mobileDetectRules.utils,this.ua),b)},match:function(a){return a instanceof RegExp||(a=new RegExp(a,"i")),a.test(this.ua)},isPhoneSized:function(a){return e.isPhoneSized(a||this.maxPhoneWidth)},mobileGrade:function(){return this._cache.grade===b&&(this._cache.grade=f.mobileGrade(this)),this._cache.grade}},"undefined"!=typeof window&&window.screen?e.isPhoneSized=function(a){return 0>a?b:f.getDeviceSmallerSide()<=a}:e.isPhoneSized=function(){},e._impl=f,e})}(function(a){if("undefined"!=typeof module&&module.exports)return function(a){module.exports=a()};if("function"==typeof define&&define.amd)return define;if("undefined"!=typeof window)return function(a){window.MobileDetect=a()};throw new Error("unknown environment")}());;
var Tabs=function(){function Tabs($navCollection,$contentCollection){this.navCollection=this.toCollection($navCollection);this.contentCollection=this.toCollection($contentCollection);this._onVisible=$.Callbacks();$navCollection.on("click",this.dispatchSwitch.bind(this))}Tabs.prototype.onVisible=function(callback){this._onVisible.add(callback)};Tabs.prototype.dispatchSwitch=function(e){var position=this.navCollection.indexOf(e.currentTarget);this.hideNotActive(position);this.showActive(position)};Tabs.prototype.showActive=function(position){var $nav=$(this.navCollection.get(position));var $content=$(this.contentCollection.get(position));$nav.addClass("active");$content.addClass("active").delay(10).queue(function(){$(this).addClass("in").dequeue()});this._onVisible.fire($nav,$content)};Tabs.prototype.switchToTab=function(nav){var position=this.navCollection.getIndex(nav);this.switchTo(position)};Tabs.prototype.switchTo=function(position){this.hideNotActive(position);this.showActive(position)};Tabs.prototype.hideNotActive=function(position){this.navCollection.forEach(function(tab,index){if(position!==index){$(tab).removeClass("active")}});this.contentCollection.forEach(function(tab,index){if(position!==index){$(tab).removeClass("active in")}})};Tabs.prototype.toCollection=function($collection){var result=new Core.Collection;$collection.each(function(index,element){result.add(element)});return result};return Tabs}();;
var DomHint;(function(DomHint_1){var DomHint=function(){function DomHint($dom){this.$dom=$dom;this.init()}DomHint.prototype.init=function(){this.selectItems();this.defineBehavior();this.updatePosition()};DomHint.prototype.selectItems=function(){this.$hintBody=$("[data-hint-body]",this.$dom);this.$hintButton=$("[data-hint-button]",this.$dom)};DomHint.prototype.defineBehavior=function(){var behaviorParameter=this.$dom.data("behavior");this.behavior=DomHint_1.DomHintBehaviorFactory.createBehavior(behaviorParameter);this.behavior.setHint(this);this.behavior.init()};DomHint.prototype.openHint=function(){if(!this.isOpened()){this.$dom.addClass("active");this.opened=true}};DomHint.prototype.isOpened=function(){return this.opened};DomHint.prototype.closeHint=function(){if(this.isOpened()){this.$dom.removeClass("active");this.opened=false}};DomHint.prototype.getDom=function(){return this.$dom};DomHint.prototype.getBody=function(){return this.$hintBody};DomHint.prototype.getButton=function(){return this.$hintButton};return DomHint}();DomHint_1.DomHint=DomHint})(DomHint||(DomHint={}));;
var DomHint;(function(DomHint){var DomHintBehaviorFactory=function(){function DomHintBehaviorFactory(){}DomHintBehaviorFactory.createBehavior=function(criteria){var behavior;switch(criteria){case"hover":behavior=new DomHint.DomHintMouseOverBehavior;break;default:behavior=new DomHint.DomHintMouseClickBehavior;break}return behavior};return DomHintBehaviorFactory}();DomHint.DomHintBehaviorFactory=DomHintBehaviorFactory})(DomHint||(DomHint={}));;
var DomHint;(function(DomHint){var DomHintFactory=function(){function DomHintFactory(){}DomHintFactory.createHint=function($dom){var result;var type=$dom.data("hintType");switch(type){case"topbottom":result=new DomHint.TopBottomDomHint($dom);break;case"leftright":result=new DomHint.LeftRightDomHint($dom);break;default:throw new Error("You have to declarate type of the creating hint. [topbottom, leftright]")}return result};return DomHintFactory}();DomHint.DomHintFactory=DomHintFactory})(DomHint||(DomHint={}));;
var DomHint;(function(DomHint){var DomHintMouseClickBehavior=function(){function DomHintMouseClickBehavior(){}DomHintMouseClickBehavior.prototype.setHint=function(hint){this.hint=hint};DomHintMouseClickBehavior.prototype.init=function(){this.hint.getButton().on("click",this.dispatchButtonClick.bind(this));$(document).on("click",this.dispatchDocumentClick.bind(this))};DomHintMouseClickBehavior.prototype.dispatchButtonClick=function(){if(this.hint.isOpened()){this.hint.closeHint()}else{this.hint.openHint()}};DomHintMouseClickBehavior.prototype.dispatchDocumentClick=function(event){var $hintDom=this.hint.getDom();if(!$hintDom.is(event.target)&&$hintDom.has(event.target).length===0){this.hint.closeHint()}};return DomHintMouseClickBehavior}();DomHint.DomHintMouseClickBehavior=DomHintMouseClickBehavior})(DomHint||(DomHint={}));;
var DomHint;(function(DomHint){var DomHintMouseOverBehavior=function(){function DomHintMouseOverBehavior(){}DomHintMouseOverBehavior.prototype.setHint=function(hint){this.hint=hint};DomHintMouseOverBehavior.prototype.init=function(){this.hint.getButton().on("mouseover",this.hint.openHint.bind(this.hint));this.hint.getDom().on("mouseout",this.hint.closeHint.bind(this.hint))};return DomHintMouseOverBehavior}();DomHint.DomHintMouseOverBehavior=DomHintMouseOverBehavior})(DomHint||(DomHint={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var DomHint;(function(DomHint){var LeftRightDomHint=function(_super){__extends(LeftRightDomHint,_super);function LeftRightDomHint(){return _super!==null&&_super.apply(this,arguments)||this}LeftRightDomHint.prototype.updatePosition=function(){var hintHeight=this.getBody().outerHeight();this.getBody().css({top:-hintHeight/2})};return LeftRightDomHint}(DomHint.DomHint);DomHint.LeftRightDomHint=LeftRightDomHint})(DomHint||(DomHint={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var DomHint;(function(DomHint){var TopBottomDomHint=function(_super){__extends(TopBottomDomHint,_super);function TopBottomDomHint(){return _super!==null&&_super.apply(this,arguments)||this}TopBottomDomHint.prototype.updatePosition=function(){};return TopBottomDomHint}(DomHint.DomHint);DomHint.TopBottomDomHint=TopBottomDomHint})(DomHint||(DomHint={}));;
var Services;(function(Services){var BindService=function(){function BindService(eventDispatcher){this.eventDispatcher=eventDispatcher;this.data=new Core.Collection}BindService.prototype.set=function(key,value){var entity=this.createEntity(key,value);this.setEntity(key,entity)};BindService.prototype.setEntity=function(key,entity){this.data.set(key,entity);this.publishEvent(key,"install")};BindService.prototype.get=function(key){return this.data.get(key)};BindService.prototype.has=function(key){return this.data.containsKey(key)};BindService.prototype.bindFields=function($target){var bindFields=$target.find("[data-bind]");var eventDispatcher=this.eventDispatcher;var self=this;bindFields.each(function(){var dataKey=$(this).attr("data-bind");var dataValue=Dom.getValue($(this));var $self=$(this);(function(){if(!self.has(dataKey)){self.set(dataKey,dataValue)}$self.on("change",function(){if(self.hasBindAttribute($self)){var value=Dom.getValue($(this));self.get(dataKey).set(value)}});eventDispatcher.subscribe(dataKey+":change",function(event){if(self.hasBindAttribute($self)){Dom.setValue($self,self.get(dataKey).get())}})})()})};BindService.prototype.cookieBind=function(dependency){var eventDispatcher=this.eventDispatcher;var cookieKey;var self=this;for(cookieKey in dependency){if(dependency.hasOwnProperty(cookieKey)){(function(){var key=cookieKey;if(!self.has(dependency[cookieKey])){self.set(dependency[cookieKey],$.cookie(cookieKey))}else if($.cookie(cookieKey)){self.get(dependency[cookieKey]).set($.cookie(cookieKey))}eventDispatcher.subscribe(dependency[cookieKey]+":change",function(event){$.cookie(key,self.get(dependency[key]).get(),{expires:1,path:"/"})})})()}}};BindService.prototype.bindEventClick=function($target){$target.off("click","[data-event-click]",this.eventClickHandler.bind(this));$target.on("click","[data-event-click]",this.eventClickHandler.bind(this))};BindService.prototype.eventClickHandler=function(event){var eventName=$(event.currentTarget).data("event-click");this.eventDispatcher.publish(eventName)};BindService.prototype.createEntity=function(key,value){var entity=new AP.Entity(value);this.addChangeCallback(key,entity);return entity};BindService.prototype.addChangeCallback=function(key,entity){var _this=this;entity.addCallback(function(){_this.publishEvent(key,"change")})};BindService.prototype.publishEvent=function(key,event){this.eventDispatcher.publish(key+":"+event)};BindService.prototype.hasBindAttribute=function($dom){return $dom.data().hasOwnProperty("bind")&&$dom.data("bind")};return BindService}();Services.BindService=BindService})(Services||(Services={}));;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(){$("[data-scroll-link]").on("click",function(){var id=$(this).attr("href"),top=$(id).offset().top;$("body,html").animate({scrollTop:top},600)})});;
var Services;(function(Services){var FB_EVENTS;(function(FB_EVENTS){FB_EVENTS["FACEBOOK_RENDERED"]="xfbml.render"})(FB_EVENTS=Services.FB_EVENTS||(Services.FB_EVENTS={}));var MAPS_API_READY_CALLBACK="mapsApiReady";var FACEBOOK_GRAPH_URL="https://graph.facebook.com";var SocialNetworksService=function(){function SocialNetworksService(eventDispatcher,mapsApiKey){this.eventDispatcher=eventDispatcher;this.mapsApiKey=mapsApiKey}SocialNetworksService.prototype.requireScript=function(src,fnOnLoad){var po=document.createElement("script");po.type="text/javascript";po.async=true;po.defer=true;po.src=src;po.onload=fnOnLoad;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(po,s)};SocialNetworksService.prototype.requireGoogleApi=function(){var _this=this;var dfr=$.Deferred();dfr.done(function(){_this.eventDispatcher.publish("googleApi:ready")});this.requireScript("https://apis.google.com/js/platform.js",function(event){dfr.resolve(event)});this.requireGoogleApi=function(){return dfr};return dfr};SocialNetworksService.prototype.requireGoogleMapsApi=function(){var dfr=$.Deferred();window[MAPS_API_READY_CALLBACK]=function(){dfr.resolve()};this.requireScript("https://maps.googleapis.com/maps/api/js?key="+this.mapsApiKey+"&callback="+MAPS_API_READY_CALLBACK,function(){});this.requireGoogleMapsApi=function(){return dfr};return dfr};SocialNetworksService.prototype.requireYoutubeApi=function(){var _this=this;var dfr=$.Deferred();dfr.done(function(){_this.eventDispatcher.publish("youtubeApi:loaded")});this.requireScript("https://www.youtube.com/iframe_api",function(event){dfr.resolve(event)});this.requireYoutubeApi=function(){return dfr};return dfr};SocialNetworksService.prototype.requireFacebookApi=function(){var _this=this;var dfr=$.Deferred();dfr.done(function(){_this.eventDispatcher.publish("facebookApi:ready")});this.requireScript("https://connect.facebook.net/en_GB/sdk.js",function(event){FB.init({version:"v3.2",status:true,cookie:true,xfbml:true});dfr.resolve(event)});this.requireFacebookApi=function(){return dfr};return dfr};SocialNetworksService.prototype.getFbCommentCount=function(collection){if(!collection.length){return}var domElements=[];var self=this;for(var i=0;i<collection.length;i++){var url=collection[i].dataset.href;if(url){domElements[url]=collection[i]}}var urls=Object.keys(domElements).join();$.get(this.getFacebookApiGraphUrl(urls),function(data){if(!data){return}for(var key in data){if(typeof domElements[key]!=="undefined"){self.setFbCommentCountElement(domElements[key],data[key])}}})};SocialNetworksService.prototype.getFacebookApiGraphUrl=function($urls){return FACEBOOK_GRAPH_URL+"/?fields=share&ids="+$urls};SocialNetworksService.prototype.setFbCommentCountElement=function(element,response){if(typeof response.share==="undefined"){return}if(typeof response.share.comment_count==="undefined"){return}element.innerHTML=response.share.comment_count};SocialNetworksService.prototype.requireTwitterApi=function(){var _this=this;var dfr=$.Deferred();dfr.done(function(){_this.eventDispatcher.publish("twitterApi:ready")});this.requireScript("//platform.twitter.com/widgets.js",function(event){dfr.resolve(event)});this.requireTwitterApi=function(){return dfr};return dfr};SocialNetworksService.prototype.youtubeSubscribe=function(){window.open("https://www.youtube.com/channel/UCHcRjWV5XOGdYkM7ruvpgxw?sub_confirmation=1")};SocialNetworksService.prototype.facebookShare=function(){window.open("https://www.facebook.com/sharer/sharer.php?u="+this.urlEncode(window.location.href),"fbShareWindow","scrollbars=no,width=670,height=330")};SocialNetworksService.prototype.urlEncode=function(url){return encodeURIComponent(url).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")};return SocialNetworksService}();Services.SocialNetworksService=SocialNetworksService})(Services||(Services={}));;
var Services;(function(Services){var HintService=function(){function HintService(){this.hints=new Core.Collection}HintService.prototype.count=function(){return this.hints.count()};HintService.prototype.add=function(hint){this.hints.add(hint)};HintService.prototype.forEach=function(callback){this.hints.forEach(callback)};HintService.prototype.updatePositions=function(){this.forEach(function(hint){hint.updatePosition()})};return HintService}();Services.HintService=HintService})(Services||(Services={}));;
var Analytics;(function(Analytics){var PageController=function(){function PageController($document,ga){this.$document=$document;this.ga=ga}PageController.prototype.init=function(){var _this=this;this.$document.on("click","[data-trackevent-category]:not(select)",function(e){_this.pushTrackEventForElement($(e.currentTarget))});this.$document.on("change","select[data-trackevent-category]",function(e){_this.pushTrackEventForElement($(e.currentTarget))})};PageController.prototype.pushTrackEventForElement=function($el){var categories=this.extractCategory($el);var actions=this.extractAction($el);var label=this.extractLabel($el);var value=this.extractValue($el);for(var ci=0;ci<categories.length;ci++){for(var ai=0;ai<actions.length;ai++){this.ga.sendEvent(categories[ci],actions[ai],label,value)}}};PageController.prototype.extractCategory=function($el){return $el.data("trackevent-category").split("|")};PageController.prototype.extractAction=function($el){return $el.data("trackevent-action").split("|")};PageController.prototype.extractLabel=function($el){var dataLabel=$el.data("trackevent-label");if(dataLabel){return dataLabel}return $el.find("[data-trackevent-label]:selected:last").data("trackevent-label")};PageController.prototype.extractValue=function($el){return $el.data("trackeventValue")};return PageController}();Analytics.PageController=PageController})(Analytics||(Analytics={}));;
var Analytics;(function(Analytics){var AnalyticsService=function(){function AnalyticsService(ga){this.ga=ga;this.page=null}AnalyticsService.prototype.init=function(pageName){this.page=this.buildPage(pageName);this.page.init()};AnalyticsService.prototype.buildPage=function(pageName){switch(pageName){default:return new Analytics.PageController($(document),this.ga)}};return AnalyticsService}();Analytics.AnalyticsService=AnalyticsService})(Analytics||(Analytics={}));;
var RecentlyView;(function(RecentlyView){var Model=function(){function Model(){}Model.prototype.getId=function(){return this._id};Model.prototype.setId=function(value){this._id=parseInt(value)};Model.prototype.setTitle=function(title){this._title=title};Model.prototype.getTitle=function(){return this._title?this._title:this._brandName+" "+this._name};Model.prototype.getName=function(){return this._name};Model.prototype.setName=function(value){this._name=value};Model.prototype.getBrandName=function(){return this._brandName};Model.prototype.setBrandName=function(value){this._brandName=value};Model.prototype.getState=function(){return this._state};Model.prototype.setState=function(value){this._state=value};Model.prototype.getModelClass=function(){return this._modelClass};Model.prototype.setModelClass=function(value){this._modelClass=value};Model.prototype.getImage=function(){return this._image};Model.prototype.setImage=function(value){this._image=value};Model.prototype.getPriceRange=function(){return this._priceRange};Model.prototype.setPriceRange=function(value){this._priceRange=value};Model.prototype.getPriceMin=function(){return this._priceMin};Model.prototype.setPriceMin=function(value){this._priceMin=value};Model.prototype.getPriceMax=function(){return this._priceMax};Model.prototype.setPriceMax=function(value){this._priceMax=value};Model.prototype.getReviewsCount=function(){return this._reviewsCount};Model.prototype.setReviewsCount=function(value){this._reviewsCount=value};Model.prototype.getRating=function(){return this._rating};Model.prototype.setRating=function(value){this._rating=value};Model.prototype.getLink=function(){return this._link};Model.prototype.setLink=function(value){this._link=value};Model.prototype.getTimestamp=function(){return this._timestamp};Model.prototype.setTimestamp=function(value){this._timestamp=value};Model.prototype.toArray=function(){return{model_id:this._id,title:this.getTitle(),model_name:this._name,brand_name:this._brandName,image:this._image,price_range:this._priceRange,price_min:this._priceMin,price_max:this._priceMax,reviews_count:this._reviewsCount,rating:this._rating,link:this._link,car_state:this._state,car_class:this._modelClass,timestamp:this._timestamp}};return Model}();RecentlyView.Model=Model})(RecentlyView||(RecentlyView={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var RecentlyView;(function(RecentlyView){var ModelCollection=function(_super){__extends(ModelCollection,_super);function ModelCollection(){return _super!==null&&_super.apply(this,arguments)||this}ModelCollection.prototype.cut=function(count){var data=this.toArray();if(count<data.length){var newData=data.splice(0,count);this.reset(newData)}};ModelCollection.prototype.add=function(model){if(this.contains(model)){this.update(model)}else{_super.prototype.add.call(this,model)}};ModelCollection.prototype.getById=function(id){var model;this.forEach(function(ownModel){if(ownModel.getId()===id){model=ownModel}});return model};ModelCollection.prototype.contains=function(model){var result=false;this.forEach(function(ownModel){if(ownModel.getId()===model.getId()){result=true}});return result};ModelCollection.prototype.update=function(model){var modelId=model.getId();if(modelId){var item=this.getById(modelId);item.setName(model.getName());item.setBrandName(model.getBrandName());item.setImage(model.getImage());item.setPriceRange(model.getPriceRange());item.setPriceMin(model.getPriceMin());item.setPriceMax(model.getPriceMax());item.setReviewsCount(model.getReviewsCount());item.setRating(model.getRating());item.setLink(model.getLink());item.setState(model.getState());item.setModelClass(model.getModelClass());item.setTimestamp(model.getTimestamp())}};return ModelCollection}(Core.Collection);RecentlyView.ModelCollection=ModelCollection})(RecentlyView||(RecentlyView={}));;
var Services;(function(Services){var RecentlyViewModelsService=function(){function RecentlyViewModelsService(storage){this.STORAGE_KEY="recently_models";this.STORAGE_SIZE=6;this.storage=storage;this.models=new RecentlyView.ModelCollection;this.getModels()}RecentlyViewModelsService.prototype.visit=function(model){model.setTimestamp(Date.now());this.models.add(model);this.flush()};RecentlyViewModelsService.prototype.getAll=function(){var data=this.models.toArray();var models=[];data.forEach(function(item){models.push(item.toArray())});return models};RecentlyViewModelsService.prototype.flush=function(){this.sortByTimestamp();this.models.cut(this.STORAGE_SIZE);this.setModels()};RecentlyViewModelsService.prototype.sortByTimestamp=function(){this.models.sort(function(a,b){var timestampA=a.getTimestamp();var timestampB=b.getTimestamp();if(timestampA===timestampB){return 0}return timestampA<timestampB?1:-1})};RecentlyViewModelsService.prototype.getModels=function(){var storageModels=this.storage.get(this.STORAGE_KEY);var models=[];if(storageModels){var data=JSON.parse(storageModels);data.forEach(function(item,index){var model=new RecentlyView.Model;model.setId(item.model_id);model.setTitle(item.title),model.setName(item.model_name);model.setBrandName(item.brand_name);model.setImage(item.image);model.setPriceRange(item.price_range);model.setPriceMin(item.price_min);model.setPriceMax(item.price_max);model.setReviewsCount(item.reviews_count);model.setRating(item.rating);model.setLink(item.link);model.setState(item.car_state);model.setModelClass(item.car_class);model.setTimestamp(item.timestamp);models.push(model)})}this.models.reset(models)};RecentlyViewModelsService.prototype.setModels=function(){var models=this.getAll();this.storage.set(this.STORAGE_KEY,JSON.stringify(models))};return RecentlyViewModelsService}();Services.RecentlyViewModelsService=RecentlyViewModelsService})(Services||(Services={}));;
var Services;(function(Services){var CarLoanEligibilityService=function(){function CarLoanEligibilityService(storage){this.storage=storage}CarLoanEligibilityService.prototype.getAge=function(){return this.storage.get("age")};CarLoanEligibilityService.prototype.setAge=function(value){this.storage.set("age",value)};CarLoanEligibilityService.prototype.getResidenceType=function(){return this.storage.get("residenceType")};CarLoanEligibilityService.prototype.setResidenceType=function(value){this.storage.set("residenceType",value)};CarLoanEligibilityService.prototype.getResidingSince=function(){return this.storage.get("residingSince")};CarLoanEligibilityService.prototype.setResidingSince=function(value){this.storage.set("residingSince",value)};CarLoanEligibilityService.prototype.getMonthlyIncome=function(){return this.storage.get("monthlyIncome")};CarLoanEligibilityService.prototype.setMonthlyIncome=function(value){this.storage.set("monthlyIncome",value)};CarLoanEligibilityService.prototype.getWorkExperience=function(){return this.storage.get("workExperience")};CarLoanEligibilityService.prototype.setWorkExperience=function(value){this.storage.set("workExperience",value)};CarLoanEligibilityService.prototype.getVariantId=function(){return this.storage.get("variantId")};CarLoanEligibilityService.prototype.setVariantId=function(value){this.storage.set("variantId",value)};CarLoanEligibilityService.prototype.getCityId=function(){return this.storage.get("cityId")};CarLoanEligibilityService.prototype.setCityId=function(value){this.storage.set("cityId",value)};CarLoanEligibilityService.prototype.getAcceptedDate=function(){return this.storage.get("accepted")};CarLoanEligibilityService.prototype.setAcceptedDate=function(value){this.storage.set("accepted",value)};CarLoanEligibilityService.prototype.isActualData=function(){var accepted=this.getAcceptedDate();if(accepted){var currentDate=new Date;var acceptedDate=new Date(accepted);var diffHours=Math.ceil(Math.abs(currentDate.getTime()-acceptedDate.getTime())/(1e3*3600));if(diffHours<=24){return true}this.setAcceptedDate(null)}return false};return CarLoanEligibilityService}();Services.CarLoanEligibilityService=CarLoanEligibilityService})(Services||(Services={}));;
var Services;(function(Services){var PriceQuoteService=function(){function PriceQuoteService(){this.priceQuoteModelCities=[]}PriceQuoteService.prototype.isPriceQuote=function(model,city){var modelId=parseInt(model);var cityId=parseInt(city);if(this.priceQuoteModelCities[modelId]){var cities=this.priceQuoteModelCities[modelId];return cities.indexOf(cityId)>=0}return false};PriceQuoteService.prototype.getModelCities=function(){return this.priceQuoteModelCities};PriceQuoteService.prototype.setModelCities=function(priceQuoteModelCities){var _this=this;if(!priceQuoteModelCities){return}this.priceQuoteModelCities=[];$.each(priceQuoteModelCities,function(key,modelCity){var modelId=parseInt(modelCity["model_id"]);var cityId=parseInt(modelCity["city_id"]);if(!_this.priceQuoteModelCities[modelId]){_this.priceQuoteModelCities[modelId]=[]}_this.priceQuoteModelCities[modelId].push(cityId)})};return PriceQuoteService}();Services.PriceQuoteService=PriceQuoteService})(Services||(Services={}));;
var Popup;(function(Popup){var PopupService=function(){function PopupService(){this.popupsCollection={};this.active=null;this.popupsQueue=[];this._onClose=this.onPopupClose.bind(this);this._onOpen=this.onPopupOpen.bind(this);this._onAdd=$.Callbacks();this.documentBody=document.getElementsByTagName("body")[0];this.openedBodyClass="fade-body";this.promises={}}PopupService.prototype.onPopupClose=function(popup){if(this.active===popup){this.active=null;$("body").removeClass(this.openedBodyClass);this.manageQueue()}};PopupService.prototype.onPopupOpen=function(popup){$("body").addClass(this.openedBodyClass);this.active=popup};PopupService.prototype.add=function(popupId,popup){if(this.isExist(popupId)){throw new Error("Popup with identifier "+popupId+" already exist!")}popup.onClose(this._onClose);popup.onOpen(this._onOpen);this.popupsCollection[popupId]=popup;this._onAdd.fire(popup,popupId)};PopupService.prototype.onAdd=function(callback){this._onAdd.add(callback)};PopupService.prototype.showPopup=function(popupId,data){if(this.active){this.popupsQueue.push({id:popupId,data:data})}else{this.get(popupId).open(data)}};PopupService.prototype.setNextPopup=function(popupId,data){if(this.active){this.popupsQueue.unshift({id:popupId,data:data})}else{this.get(popupId).open(data)}};PopupService.prototype.getActivePopup=function(){return this.active};PopupService.prototype.hidePopup=function(popupId){this.get(popupId).close()};PopupService.prototype.manageQueue=function(){if(this.popupsQueue.length>0){var data=this.popupsQueue.shift();this.showPopup(data.id,data.data)}};PopupService.prototype.getPopup=function(popupKey){var _this=this;var result=$.Deferred();var popupExist=this.isExist(popupKey);if(popupExist){if(!this.promises.hasOwnProperty(popupKey)){this.promises[popupKey]=result}else{result=this.promises[popupKey]}result.resolve(this.get(popupKey))}else if(this.promises.hasOwnProperty(popupKey)){return this.promises[popupKey]}else{this.promises[popupKey]=result;this.onAdd(function(popup,popupId){if(popupId==popupKey){result.resolve(_this.get(popupKey))}})}return result};PopupService.prototype.get=function(popupId){if(!this.isExist(popupId)){throw new Error("Popup with identifier "+popupId+" is not defined!")}return this.popupsCollection[popupId]};PopupService.prototype.isExist=function(popupId){return this.popupsCollection.hasOwnProperty(popupId)};PopupService.prototype.forEach=function(callback){for(var popupKey in this.popupsCollection){if(this.popupsCollection.hasOwnProperty(popupKey)){callback(this.get(popupKey))}}};return PopupService}();Popup.PopupService=PopupService})(Popup||(Popup={}));;
var Popup;(function(Popup){var PopupStates;(function(PopupStates){PopupStates["OPEN"]="OPEN";PopupStates["CLOSE"]="CLOSE"})(PopupStates||(PopupStates={}));var CloseType;(function(CloseType){CloseType["CODE"]="CODE";CloseType["USER"]="USER"})(CloseType=Popup.CloseType||(Popup.CloseType={}));var BasePopup=function(){function BasePopup(container){this.container=container;this.onOpenQueue=$.Callbacks();this.onCloseQueue=$.Callbacks();this._afterUserClose=$.Callbacks()}BasePopup.prototype.getContainer=function(){return this.container};BasePopup.prototype.has=function(element){if(element===this.container||element===this.container[0]){return true}if(!element.parentElement){return false}return this.has(element.parentElement)};BasePopup.prototype.onOpen=function(callback){this.onOpenQueue.add(callback)};BasePopup.prototype.onClose=function(callback){this.onCloseQueue.add(callback)};BasePopup.prototype.open=function(data){this.state=PopupStates.OPEN;this.onOpenQueue.fire(this,data)};BasePopup.prototype.close=function(closeType){if(closeType===void 0){closeType=CloseType.CODE}this.state=PopupStates.CLOSE;this.onCloseQueue.fire(this);if(closeType===CloseType.USER){this.onUserClose()}};BasePopup.prototype.onUserClose=function(){this._afterUserClose.fire(this)};BasePopup.prototype.afterUserClose=function(callback){this._afterUserClose.add(callback)};return BasePopup}();Popup.BasePopup=BasePopup})(Popup||(Popup={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var FormPopup=function(_super){__extends(FormPopup,_super);function FormPopup(){return _super!==null&&_super.apply(this,arguments)||this}FormPopup.prototype.getForm=function(){return $(this.getContainer()).find("form")};return FormPopup}(Popup.BasePopup);Popup.FormPopup=FormPopup})(Popup||(Popup={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var IgnoreCloseVerification;(function(IgnoreCloseVerification){IgnoreCloseVerification["IGNORE"]="IGNORE";IgnoreCloseVerification["VERIFY"]="VERIFY"})(IgnoreCloseVerification=Popup.IgnoreCloseVerification||(Popup.IgnoreCloseVerification={}));var ConfirmableFormPopup=function(_super){__extends(ConfirmableFormPopup,_super);function ConfirmableFormPopup(container,eventDispatcher){var _this=_super.call(this,container)||this;_this._afterOpen=$.Callbacks();_this._afterClose=$.Callbacks();_this.confirm=new Messages.Confirm;_this.label="";_this.eventDispatcher=eventDispatcher;_this.validationType=Popup.IgnoreCloseVerification.VERIFY;_this.reset();_this.addListeners();return _this}ConfirmableFormPopup.prototype.afterOpen=function(callback){this._afterOpen.add(callback)};ConfirmableFormPopup.prototype.afterClose=function(callback){this._afterClose.add(callback)};ConfirmableFormPopup.prototype.open=function(data){_super.prototype.open.call(this);this._afterOpen.fire(this)};ConfirmableFormPopup.prototype.close=function(closeType){if(closeType===void 0){closeType=Popup.CloseType.CODE}if(this.validationType===Popup.IgnoreCloseVerification.VERIFY){this.validateClosing()}else{this.closePopup(closeType)}};ConfirmableFormPopup.prototype.closePopup=function(closeType){if(closeType===void 0){closeType=Popup.CloseType.CODE}_super.prototype.close.call(this,closeType)};ConfirmableFormPopup.prototype.validateClosing=function(){var _this=this;if(this.isChanged()){this.handleBeforeClose().done(function(){_this.closePopup(Popup.CloseType.USER);_this.triggerGaConfirmEvent()}).fail(function(){_this.triggerGaCancelationEvent()})}else{this.closePopup(Popup.CloseType.USER)}};ConfirmableFormPopup.prototype.setLabel=function(label){if(label===void 0){label=""}this.label=label};ConfirmableFormPopup.prototype.triggerGaConfirmEvent=function(){this.eventDispatcher.publish("track:ga",{action:"Confirm",category:"PopupCloseControl",label:this.label})};ConfirmableFormPopup.prototype.triggerGaCancelationEvent=function(){this.eventDispatcher.publish("track:ga",{action:"Cancellation",category:"PopupCloseControl",label:this.label})};ConfirmableFormPopup.prototype.isChanged=function(){return this.changed};ConfirmableFormPopup.prototype.addListeners=function(){var _this=this;this.afterOpen(function(){_this.attachFormChangeListener()});this.afterClose(function(){_this.detachFormChangeListener()});this.onClose(function(){_this.reset()})};ConfirmableFormPopup.prototype.attachFormChangeListener=function(){this.getForm().on("change",this.processFormChange.bind(this))};ConfirmableFormPopup.prototype.detachFormChangeListener=function(){this.getForm().off("change",this.processFormChange.bind(this))};ConfirmableFormPopup.prototype.processFormChange=function(e){if(this.isVisibleElement($(e.target))){this.onFormChange()}};ConfirmableFormPopup.prototype.setVerification=function(type){this.validationType=type};ConfirmableFormPopup.prototype.reset=function(){this.changed=false;this.validationType=Popup.IgnoreCloseVerification.VERIFY};ConfirmableFormPopup.prototype.handleBeforeClose=function(){return this.confirm.open("Closing this window might lead to loss of all the valuable information you entered! Do you want to continue?")};ConfirmableFormPopup.prototype.onFormChange=function(){this.changed=true};ConfirmableFormPopup.prototype.isVisibleElement=function($element){return $element.attr("type")!=ConfirmableFormPopup.HIDDEN_FIELD_TYPE};ConfirmableFormPopup.HIDDEN_FIELD_TYPE="hidden";return ConfirmableFormPopup}(Popup.FormPopup);Popup.ConfirmableFormPopup=ConfirmableFormPopup})(Popup||(Popup={}));;
var Messages;(function(Messages){var Message=function(){function Message(){this.dom=this.createDom();document.body.appendChild(this.dom)}Message.prototype.open=function(text){if(text===void 0){text=""}this.message.innerText=text;this.dom.setAttribute("opened","")};Message.prototype.close=function(){if(this.dom.hasAttribute("opened")){this.dom.removeAttribute("opened")}};Message.prototype.create=function(elementType){return document.createElement(elementType)};return Message}();Messages.Message=Message})(Messages||(Messages={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Messages;(function(Messages){var Confirm=function(_super){__extends(Confirm,_super);function Confirm(){return _super!==null&&_super.apply(this,arguments)||this}Confirm.prototype.open=function(message){if(message===void 0){message=""}_super.prototype.open.call(this,message);var dfr=$.Deferred();$(this.confirm).on("click",this.resolve.bind(this,dfr));$(this.cancel).on("click",this.reject.bind(this,dfr));$(this.closeButton).on("click",this.reject.bind(this,dfr));return dfr};Confirm.prototype.close=function(){_super.prototype.close.call(this);$(this.confirm).off("click",this.resolve);$(this.cancel).off("click",this.reject);$(this.closeButton).off("click",this.reject)};Confirm.prototype.resolve=function(dfr){dfr.resolve();this.close()};Confirm.prototype.reject=function(dfr){dfr.reject();this.close()};Confirm.prototype.createDom=function(){var root=this.create("messagebox");var messageBox=this.create("message");var content=this.create("content");var confirmAction=this.create("confirm");confirmAction.innerHTML="Continue";var cancelAction=this.create("cancel");cancelAction.innerHTML="Cancel";var actionsBox=this.create("actions");actionsBox.appendChild(confirmAction);actionsBox.appendChild(cancelAction);var closeButton=this.create("close");closeButton.innerHTML="×";content.appendChild(closeButton);content.appendChild(messageBox);content.appendChild(actionsBox);root.appendChild(content);this.closeButton=closeButton;this.message=messageBox;this.confirm=confirmAction;this.cancel=cancelAction;return root};return Confirm}(Messages.Message);Messages.Confirm=Confirm})(Messages||(Messages={}));;
var General;(function(General){var Menu=function(){function Menu($elements){this.$elements=$elements;menuTimer=null}Menu.prototype.init=function(){this.$elements.hover(this.handleIn,this.handleOut)};Menu.prototype.handleIn=function(){menuTimer=setTimeout(function(element){jQuery(element).addClass("active");jQuery("> div",element).slideDown(600)},400,this)};Menu.prototype.handleOut=function(){clearTimeout(menuTimer);$(this).removeClass("active");$("> div",this).stop(true,true).slideUp(600)};return Menu}();General.Menu=Menu})(General||(General={}));;
(function($,d,w){"use strict";$(d).off("click","[data-link]",resolveRedirect).on("click","[data-link]",resolveRedirect);$(d).off("mousedown","[data-link]",handleMouseWheelClick).on("mousedown","[data-link]",handleMouseWheelClick);function handleMouseWheelClick(event){if(event.which===2){var $element=$(event.currentTarget);var link=$element.attr("data-link");openInNewWindow(link)}}function resolveRedirect(event){var $element=$(event.currentTarget);var link=$element.attr("data-link");var target=$element.attr("data-target");resolveTarget(target)(link)}function resolveTarget(target){return target=="_blank"?openInNewWindow:openInCurrentWindow}function openInNewWindow(link){setTimeout(function(){w.open(link)},17)}function openInCurrentWindow(link){setTimeout(function(){w.location.href=link},17)}})(jQuery,document,window);;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(){var menu=new General.Menu($(".master-menu-js .menu-sub-js").parent());menu.init()});;
var Services;(function(Services){var OptionType;(function(OptionType){OptionType[OptionType["OPTION"]="option"]="OPTION";OptionType[OptionType["OPTION_GROUP"]="optgroup"]="OPTION_GROUP"})(OptionType||(OptionType={}));var RenderService=function(){function RenderService(){}RenderService.prototype.renderSelect=function($container,items){var _this=this;$.each(items,function(index,item){_this.renderSelectItem($container,item)})};RenderService.prototype.renderSelectItem=function($container,item){var type=item.type||OptionType.OPTION;switch(type){case OptionType.OPTION:this.renderOption($container,item);break;case OptionType.OPTION_GROUP:this.renderOptionGroup($container,item);break}};RenderService.prototype.renderOptionGroup=function($container,data){var _this=this;var $result=$("<optgroup/>");if(data.attrs){this.renderAttributes($result,data.attrs)}$container.append($result);if(data.children){$.each(data.children,function(index,child){_this.renderSelectItem($result,child)})}};RenderService.prototype.renderOption=function($container,data){var $result=$("<option/>");if(data.text){$result.text(data.text)}if(data.attrs){this.renderAttributes($result,data.attrs)}$container.append($result)};RenderService.prototype.renderAttributes=function($container,attributes){$.each(attributes,function(key,value){$container.attr(key,value)})};return RenderService}();Services.RenderService=RenderService})(Services||(Services={}));;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){container.get("render_select").render()});;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){var ga=container.get("ga");$("[data-show-hide-button]").on("click",function(e){var $toggler=$(this),gaCategory=$toggler.data("gaCategory");toggleBlock(getContinueTextElement($toggler));$toggler.text(getTogglerText($toggler));$toggler.toggleClass("hide");if($toggler.data("showHideStatus")){ga.sendEvent(gaCategory,getTogglerGaAction($toggler,getTogglerStatus($toggler)))}$(document).trigger("scroll")});function toggleBlock($block){$block.slideToggle(300)}function getContinueTextElement($toggler){return $toggler.parent().children("[data-show-hide-text]")}function getTogglerText($toggler){var showText=$toggler.data("showText")||"See More",hideText=$toggler.data("hideText")||"See Less";return $.trim($toggler.text())==showText?hideText:showText}function getTogglerStatus($toggler){var starStatus=$toggler.attr("data-show-hide-status"),currentStatus=starStatus=="hide"?"show":"hide";$toggler.attr("data-show-hide-status",currentStatus);return $toggler.attr("data-show-hide-status")}function getTogglerGaAction($toggler,status){var showGaAction=$toggler.data("showGaAction")||"",hideGaAction=$toggler.data("hideGaAction")||"";return status=="hide"?hideGaAction:showGaAction}});;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){initHints(container)});function initHints(container){var $hints=$("[data-hint-container]");var pageHintsService=container.get("hint_service");$hints.each(function(){var $dom=$(this);try{var hint=DomHint.DomHintFactory.createHint($dom);pageHintsService.add(hint)}catch(error){console.error(error.message,$dom)}})};
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(){var menuBlock=document.getElementById("menu"),panelBlock=document.getElementById("panel");if(menuBlock&&panelBlock){var slideout=new Slideout({panel:menuBlock,menu:panelBlock,padding:256});document.querySelector(".menu-toggle-js").addEventListener("click",function(){slideout.toggle()});document.querySelector(".slideout-panel").addEventListener("click",function(){slideout.close()})}$(".master-menu-app label").on("click",function(e){var $input=$("#"+$(this).attr("for"));if($input.prop("checked")){e.preventDefault();$input.prop("checked",false)}});var $menuAppContainer=$("[data-menu-app-container]");var $menuApp=$("#menu-app");if($menuAppContainer.length){var $mobileMenu=$menuApp.tmpl().appendTo($menuAppContainer);$mobileMenu.on("click","[href^=#]",function(){slideout.close();scrollToAnchor(this)})}if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){jQuery(".share_but").on("click",function(event){jQuery(".share_but").parent().find(".share-in").fadeToggle(300)})}else{jQuery(".share_compare").hover(function(){jQuery(this).find(".share-in").fadeToggle(300)})}jQuery(".scroll-up").click(function(){$("html, body").animate({scrollTop:0},400);return false});jQuery(window).scroll(function(){if(jQuery(window).scrollTop()>="500"){jQuery(".scroll-up").fadeIn("200")}else{jQuery(".scroll-up").fadeOut("200")}});jQuery("a.scroll-down").on("click",function(e){e.preventDefault();var elem=jQuery(this).attr("href");var attr=elem.substring(elem.indexOf("#")+1);var topMenuHeight=45,position=0;if(attr.length>0){position=jQuery("#"+attr).offset().top;if(position>topMenuHeight){$("html, body").animate({scrollTop:position-topMenuHeight},400)}}});$(".scroll-anchor").on("click",function(event){event.preventDefault();scrollToAnchor(this)});$("[data-user-agent-hidden]").each(function(){var userAgent=$(this).data("userAgentHidden");var regexp=userAgent.match(new RegExp(/\/(.*)\/([gimy]+)?$/))||["",userAgent,"i"];if(navigator.userAgent.match(new RegExp(regexp[1],regexp[2]))){$(this).addClass("d_n")}});function scrollToAnchor(link){var id=$(link).attr("href"),$anchor=$(id),top=$anchor.offset().top;$("body,html").animate({scrollTop:top},600)}});;
AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){if(!container.hasService("lib.gop")){container.get("gop_request_auto_submit_service")}});;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){var cityDetect={$mainBlock:null,$cityHolder:null,citiesListUrl:null,cityDetectUrl:null,topCitiesLimit:null,cityDetectService:null,ga:null,topCities:[],allCities:[],popupService:{},reloadTimer:null,init:function(parameters){if(parameters.$mainBlock.length){this.$mainBlock=parameters.$mainBlock;this.$cityHolder=parameters.$cityHolder;this.citiesListUrl=parameters.citiesListUrl;this.topCitiesLimit=parameters.topCitiesLimit;this.cityDetectUrl=parameters.cityDetectUrl;this.cityDetectService=container.get("city_detect");this.ga=container.get("ga");var cityDetectPopUp=this.createPopUp();this.setCityFromCookie();this.attachEventListeners();this.popupService.add(this.popupKey,cityDetectPopUp)}},createPopUp:function(){var self=this;var cityDetectPopUp;this.popupService=container.get("popup_service");cityDetectPopUp=new Popup.BasePopup(this.getCityPopup().get(0));cityDetectPopUp.onOpen(function(){self.showPopup()});cityDetectPopUp.onClose(function(){self.closePopup()});return cityDetectPopUp},attachEventListeners:function(){this.changeCityButtonEventListener();this.confirmCityButtonEventListener();this.focusCityInputEventListener();this.selectTopCityEventListener();this.setUnloadListener();this.setHolderButtonsListener();var self=this;var $document=$(document);container.get("event_dispatcher").subscribe("cityDetect:reloadRejected",function(){clearTimeout(self.reloadTimer)});this.getCityPopup().on("touchstart mousedown",".popup_close",function(e){e.originalEvent.stopPropagation();self.popupService.hidePopup(self.popupKey);return false});$document.ready(function(){var $input=self.getCityInput();$document.triggerHandler("afterCityInitialize.cityDetection",{cityName:$input.val(),cityPath:$input.data("typePath"),cityId:$input.data("typeId")});if(!self.cityDetectService.isConfirmed()&&!self.cityDetectService.isDetectedOnce()){self.showCityHolder();self.cityDetectService.setCityDetectedOnce()}})},getCookieSettings:function(permanent){var settings={path:"/"};if(permanent){settings.expires=365}return settings},buildCityList:function(callback){if(!this.topCities.length){this.loadCityList(callback)}else if(callback){callback()}},unblockPopup:function(){this.getCityPopup().find(".popup_content.cell").removeClass("busy")},renderPopup:function(){var self=this;this.getTopCityBlock().html("");jQuery.each(this.topCities,function(id,city){self.getTopCityBlock().append($("<li/>").text(city.city).attr({"data-city_name":city.city,"data-city_path":city.city_path,"data-city_id":city.cities_id,"data-trackevent-category":"Pages","data-trackevent-action":"SelectedCity"}).addClass("cell4"))});this.getCityInput().on("focusin",function(){$(this).data("typePath",null)}).autocomplete({source:this.allCities,appendTo:"#typedCity",minLength:1,select:function(event,ui){var $cityInput=self.getCityInput();$cityInput.val(ui.item.value);$cityInput.data("typePath",ui.item.city_path);$cityInput.data("typeId",ui.item.cities_id)}});this.unblockPopup()},loadCities:function(jqXhr){var response=jqXhr.response;var city=null;this.allCities=[];this.topCities=[];for(var i in response.docs){city=response.docs[i];if(city.city_path){this.allCities.push(city)}if(city.top>0){this.topCities[city.top-1]=city}}},loadCityList:function(callback){var self=this;$.getJSON(self.citiesListUrl,{topLimit:self.topCitiesLimit}).success(function(data){self.loadCities(data)}).success(function(){self.renderPopup()}).success(callback)},focusCityInputEventListener:function(){var self=this;this.getCityInput().focus(function(){self.getCityInput().val("")})},changeCityButtonEventListener:function(){var self=this;this.getChangeCityButton().mouseup(function(){self.popupService.showPopup(self.popupKey)})},selectTopCityEventListener:function(){var self=this,callback=function(){self.getCityInput().val($(this).data("city_name")).data("typePath",$(this).data("city_path")).data("typeId",$(this).data("city_id"));self.confirmCity()};this.getTopCityBlock().on("mouseup","li",callback);this.getUcCityBlock().on("mouseup","li",callback)},setUnloadListener:function(){var self=this;$(window).on("unload",function(event){self.cityDetectService.setReferrerUrl(event.target.URL.split("#")[0])})},setHolderButtonsListener:function(){var self=this;$("[data-confirm-button]",this.$cityHolder).on("click",function(){self.ga.sendEvent("Pages","cityHolder","Yes");self.confirmCity();self.$cityHolder.hide()});$("[data-change-button]",this.$cityHolder).on("click",function(){self.popupService.showPopup(self.popupKey);self.$cityHolder.hide()});$("[data-close-btn]",self.$cityHolder).on("click",function(event){self.$cityHolder.hide()})},setCityDetectCookie:function(city,permanent){var cookieSettings=this.getCookieSettings(permanent);$.cookie("city",city.city,cookieSettings);$.cookie("cityId",city.cityId,cookieSettings);$.cookie("cityName",city.cityName,cookieSettings);$.cookie("cityIsConfirmed",city.cityIsConfirmed,cookieSettings);this.setCity(city.cityName,city.city,city.cityId,city.cityIsConfirmed)},confirmCity:function(){var city=this.getCityInput().data("typePath");if(city){var cityName=this.getCityInput().val();var cityId=this.getCityInput().data("typeId");var cityPath=this.getCityInput().data("typePath");this.setCityDetectCookie({city:cityPath,cityId:cityId,cityName:cityName,cityIsConfirmed:1},true);this.popupService.hidePopup(this.popupKey);this.reloadTimer=setTimeout(function(){window.location.reload()},100);$(document).triggerHandler("confirmCity.cityDetection",{city:cityPath,cityId:cityId,cityName:cityName});container.get("event_dispatcher").publish("confirmCity.cityDetection",{city:cityPath,cityId:cityId,cityName:cityName})}else{this.getCityInput().val("").focus()}},confirmCityButtonEventListener:function(){var self=this;this.getConfirmCityButton().click(function(){self.confirmCity()})},tryCityDetect:function(){var self=this;$.getJSON(this.cityDetectUrl).success(function(city){if(city.city){self.setCityDetectCookie({city:city.city_path,cityName:city.city,cityId:city.cities_id,cityIsConfirmed:0},false)}})},setCityFromCookie:function(){var cityPath=this.cityDetectService.getCityPath();var cityName=this.cityDetectService.getCityName();var cityId=this.cityDetectService.getCityId();var confirmed=this.cityDetectService.isConfirmed();if(cityPath&&cityName&&cityId){this.setCity(cityName,cityPath,cityId,confirmed);this.$mainBlock.find(".maincity-in.field").removeClass("busy")}else{this.tryCityDetect()}},setCity:function(cityName,cityPath,cityId,cityIsConfirmed){this.getCityTitle().text(cityName);this.getHolderTitle().text(cityName);this.getCityInput().val(cityName).data("typePath",cityPath).data("typeId",cityId);$(document).triggerHandler("afterCityInitialize.cityDetection",{cityName:cityName,cityPath:cityPath,cityId:cityId})},showCityHolder:function(){this.$cityHolder.removeClass("d_n")},getTopCityBlock:function(){return this.$mainBlock.find('ul[data-type="top-city"]')},getUcCityBlock:function(){return this.$mainBlock.find('ul[data-type="uc-city"]')},getHolderTitle:function(){return $("[data-city-name]",this.$cityHolder)},getHolderChangeButton:function(){return $("[data-change-button]",this.$cityHolder)},getHolderConfirmButton:function(){return $("[data-confirm-button]",this.$cityHolder)},getCityTitle:function(){return this.$mainBlock.find('span[data-type="city-title"]')},getCityInput:function(){return $("#ac_user_city")},getConfirmCityButton:function(){return this.$mainBlock.find('span[data-type="confirm"]')},getChangeCityButton:function(){return this.$mainBlock.find("div.maincity")},getCityPopup:function(){return this.$mainBlock.find('div[data-type="city-popup"]')},showPopup:function(){this.getCityPopup().show();this.buildCityList(function(){});$("body").addClass("hidden")},closePopup:function(){this.getCityPopup().hide();$("body").removeClass("hidden")}};cityDetect.init({$mainBlock:$("#citydetect"),$cityHolder:$("[data-city-holder]"),citiesListUrl:"/api/v1/user-cities/",topCitiesLimit:9,cityDetectUrl:"/api/v1/city/"})});;
(function($){var utmCodes=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","ir_notify","ir_co","gcl_id"];var parseStr=function(query){var result={};var vars=query.replace(/^\?/,"").split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");result[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return result};var hasUtmCode=function(query){for(var i in query){if(!query.hasOwnProperty(i)){continue}if(i.match(/^utm_.+/)||i=="gcl_id"){return true}}return false};var extractUtmCodes=function(query){var result={};var x;for(x=0;x<utmCodes.length;++x){result[utmCodes[x]]=""}for(var i in query){if(!query.hasOwnProperty(i)){continue}if(utmCodes.indexOf(i)===-1){continue}result[i]=query[i]}return result};var utm=function(search){var query=parseStr(search||"");var utmCodes=extractUtmCodes(query);this.hasUtmCode=function(){return hasUtmCode(query)};this.stringify=function(){return JSON.stringify(utmCodes)}};var _utm=new utm(window.location.search);if(_utm.hasUtmCode()){$.cookie("_utm",_utm.stringify(),{path:"/"})}if(!$.cookie("targetUrl")){$.cookie("targetUrl",window.location.href,{path:"/"})}if(!$.cookie("userAgent")){$.cookie("userAgent",navigator.userAgent,{path:"/"});$.cookie("userReferrer",document.referrer,{path:"/"});$.cookie("userResolution",window.screen.availHeight+"-"+window.screen.availWidth,{path:"/"})}window.addEventListener("message",function(event){var action=String.prototype.match.call(event.data||"",/(expand|collapse)\|(div-gpt-ad-.*)$/)||[null,null,null];var element=document.getElementById(action[2]);if(element){switch(action[1]){case"expand":element.classList.add("active");break;case"collapse":element.classList.remove("active");break}}var actionZedo=String.prototype.match.call(event.data||"",/(expand|collapse)\|(desktop.*)$/)||[null,null,null];element=document.querySelector("[data-banner-key='"+actionZedo[2]+"']");if(element){switch(actionZedo[1]){case"expand":element.classList.add("active");break;case"collapse":element.classList.remove("active");break}}},false)})(jQuery);;
!function(t,e){"use strict";function r(r,a,i,l,u){function f(){L=t.devicePixelRatio>1,c(i),a.delay>=0&&setTimeout(function(){s(!0)},a.delay),(a.delay<0||a.combined)&&(l.e=v(a.throttle,function(t){"resize"===t.type&&(w=B=-1),s(t.all)}),l.a=function(t){c(t),i.push.apply(i,t)},l.g=function(){return i=n(i).filter(function(){return!n(this).data(a.loadedName)})},l.f=function(t){for(var e=0;e<t.length;e++){var r=i.filter(function(){return this===t[e]});r.length&&s(!1,r)}},s(),n(a.appendScroll).on("scroll."+u+" resize."+u,l.e))}function c(t){var i=a.defaultImage,o=a.placeholder,l=a.imageBase,u=a.srcsetAttribute,f=a.loaderAttribute,c=a._f||{};t=n(t).filter(function(){var t=n(this),r=m(this);return!t.data(a.handledName)&&(t.attr(a.attribute)||t.attr(u)||t.attr(f)||c[r]!==e)}).data("plugin_"+a.name,r);for(var s=0,d=t.length;s<d;s++){var A=n(t[s]),g=m(t[s]),h=A.attr(a.imageBaseAttribute)||l;g===N&&h&&A.attr(u)&&A.attr(u,b(A.attr(u),h)),c[g]===e||A.attr(f)||A.attr(f,c[g]),g===N&&i&&!A.attr(E)?A.attr(E,i):g===N||!o||A.css(O)&&"none"!==A.css(O)||A.css(O,"url('"+o+"')")}}function s(t,e){if(!i.length)return void(a.autoDestroy&&r.destroy());for(var o=e||i,l=!1,u=a.imageBase||"",f=a.srcsetAttribute,c=a.handledName,s=0;s<o.length;s++)if(t||e||A(o[s])){var g=n(o[s]),h=m(o[s]),b=g.attr(a.attribute),v=g.attr(a.imageBaseAttribute)||u,p=g.attr(a.loaderAttribute);g.data(c)||a.visibleOnly&&!g.is(":visible")||!((b||g.attr(f))&&(h===N&&(v+b!==g.attr(E)||g.attr(f)!==g.attr(F))||h!==N&&v+b!==g.css(O))||p)||(l=!0,g.data(c,!0),d(g,h,v,p))}l&&(i=n(i).filter(function(){return!n(this).data(c)}))}function d(t,e,r,i){++z;var o=function(){y("onError",t),p(),o=n.noop};y("beforeLoad",t);var l=a.attribute,u=a.srcsetAttribute,f=a.sizesAttribute,c=a.retinaAttribute,s=a.removeAttribute,d=a.loadedName,A=t.attr(c);if(i){var g=function(){s&&t.removeAttr(a.loaderAttribute),t.data(d,!0),y(T,t),setTimeout(p,1),g=n.noop};t.off(I).one(I,o).one(D,g),y(i,t,function(e){e?(t.off(D),g()):(t.off(I),o())})||t.trigger(I)}else{var h=n(new Image);h.one(I,o).one(D,function(){t.hide(),e===N?t.attr(C,h.attr(C)).attr(F,h.attr(F)).attr(E,h.attr(E)):t.css(O,"url('"+h.attr(E)+"')"),t[a.effect](a.effectTime),s&&(t.removeAttr(l+" "+u+" "+c+" "+a.imageBaseAttribute),f!==C&&t.removeAttr(f)),t.data(d,!0),y(T,t),h.remove(),p()});var m=(L&&A?A:t.attr(l))||"";h.attr(C,t.attr(f)).attr(F,t.attr(u)).attr(E,m?r+m:null),h.complete&&h.trigger(D)}}function A(t){var e=t.getBoundingClientRect(),r=a.scrollDirection,n=a.threshold,i=h()+n>e.top&&-n<e.bottom,o=g()+n>e.left&&-n<e.right;return"vertical"===r?i:"horizontal"===r?o:i&&o}function g(){return w>=0?w:w=n(t).width()}function h(){return B>=0?B:B=n(t).height()}function m(t){return t.tagName.toLowerCase()}function b(t,e){if(e){var r=t.split(",");t="";for(var a=0,n=r.length;a<n;a++)t+=e+r[a].trim()+(a!==n-1?",":"")}return t}function v(t,e){var n,i=0;return function(o,l){function u(){i=+new Date,e.call(r,o)}var f=+new Date-i;n&&clearTimeout(n),f>t||!a.enableThrottle||l?u():n=setTimeout(u,t-f)}}function p(){--z,i.length||z||y("onFinishedAll")}function y(t,e,n){return!!(t=a[t])&&(t.apply(r,[].slice.call(arguments,1)),!0)}var z=0,w=-1,B=-1,L=!1,T="afterLoad",D="load",I="error",N="img",E="src",F="srcset",C="sizes",O="background-image";"event"===a.bind||o?f():n(t).on(D+"."+u,f)}function a(a,o){var l=this,u=n.extend({},l.config,o),f={},c=u.name+"-"+ ++i;return l.config=function(t,r){return r===e?u[t]:(u[t]=r,l)},l.addItems=function(t){return f.a&&f.a("string"===n.type(t)?n(t):t),l},l.getItems=function(){return f.g?f.g():{}},l.update=function(t){return f.e&&f.e({},!t),l},l.force=function(t){return f.f&&f.f("string"===n.type(t)?n(t):t),l},l.loadAll=function(){return f.e&&f.e({all:!0},!0),l},l.destroy=function(){return n(u.appendScroll).off("."+c,f.e),n(t).off("."+c),f={},e},r(l,u,a,f,c),u.chainable?a:l}var n=t.jQuery||t.Zepto,i=0,o=!1;n.fn.Lazy=n.fn.lazy=function(t){return new a(this,t)},n.Lazy=n.lazy=function(t,r,i){if(n.isFunction(r)&&(i=r,r=[]),n.isFunction(i)){t=n.isArray(t)?t:[t],r=n.isArray(r)?r:[r];for(var o=a.prototype.config,l=o._f||(o._f={}),u=0,f=t.length;u<f;u++)(o[t[u]]===e||n.isFunction(o[t[u]]))&&(o[t[u]]=i);for(var c=0,s=r.length;c<s;c++)l[r[c]]=t[0]}},a.prototype.config={name:"lazy",chainable:!0,autoDestroy:!0,bind:"load",threshold:500,visibleOnly:!1,appendScroll:t,scrollDirection:"both",imageBase:null,defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",placeholder:null,delay:-1,combined:!1,attribute:"data-src",srcsetAttribute:"data-srcset",sizesAttribute:"data-sizes",retinaAttribute:"data-retina",loaderAttribute:"data-loader",imageBaseAttribute:"data-imagebase",removeAttribute:!0,handledName:"handled",loadedName:"loaded",effect:"show",effectTime:0,enableThrottle:!0,throttle:250,beforeLoad:e,afterLoad:e,onError:e,onFinishedAll:e},n(t).on("load",function(){o=!0})}(window);;
$(document).ready(function(){function timestamp(){return(new Date).getTime()}function LazyImage($lazyImage,config){this.$lazyImage=$lazyImage;this.config=config;this.apply()}LazyImage.prototype.apply=function(){this.$lazyImage.Lazy($.extend(this.config,{effect:"fadeIn",attribute:"data-original",beforeLoad:function(){this.loadStartTime=timestamp()},afterLoad:function($image){sendUserTiming("Lazy load",$image.prop("src"),timestamp()-this.loadStartTime,window.location.pathname);$image.parent().removeClass("loader-transparent")}}))};new LazyImage($("img.lazy"),{visibleOnly:true,threshold:10});new LazyImage($(".carousel img.lazy"),{visibleOnly:false,threshold:10,appendScroll:$(".carousel")})});function applyLazyLoad($dom,lazyClass){$("img."+lazyClass,$dom).Lazy({effect:"fadeIn",attribute:"data-original",beforeLoad:function(){this.loadStartTime=(new Date).getTime()},afterLoad:function($image){sendUserTiming("Lazy load",$image.prop("src"),(new Date).getTime()-this.loadStartTime,window.location.pathname);$image.parent().removeClass("loader-transparent")}})};
var General;(function(General){var FormValidator=function(){function FormValidator(view){this.view=view;this.errorsCount=0;this._onValid=$.Callbacks();this._onInvalid=$.Callbacks();this._onElementInvalid=$.Callbacks();this.validator=null}FormValidator.prototype.element=function(el){this.validator.element(el)};FormValidator.prototype.init=function(){this.initValidation()};FormValidator.prototype.onElementInvalid=function(callback){this._onElementInvalid.add(callback)};FormValidator.prototype.getIgnore=function(){return":hidden"};FormValidator.prototype.onFormValid=function(callback){this._onValid.add(callback)};FormValidator.prototype.onFormInvalid=function(callback){this._onInvalid.add(callback)};FormValidator.prototype.initValidation=function(){var self=this;this.validator=this.view.getForm().validate({ignore:self.getIgnore(),rules:self.getRules(),messages:self.getMessages(),focusCleanup:true,highlight:function(element){self.getErrorBlock(element).addClass("active");self.errorsCount=self.validator.numberOfInvalids();if(self.errorsCount!==0){self._onInvalid.fire()}},unhighlight:function(element){self.getErrorBlock(element).removeClass("active");self.errorsCount=self.validator.numberOfInvalids();if(self.errorsCount===0){self._onValid.fire()}},errorPlacement:function($error,$element){var errorMessage=$error.text();self._onElementInvalid.fire(errorMessage,$element);self.getErrorBlock($element).html(errorMessage)}})};FormValidator.prototype.getErrorBlock=function(element){var property=$(element).attr("name");return this.view.getForm().find('[data-error-name="'+property+'"]')};FormValidator.prototype.validate=function(){return this.view.getForm().valid()};FormValidator.prototype.doValidate=function(){return this.view.getForm().validate()};return FormValidator}();General.FormValidator=FormValidator})(General||(General={}));;
var Services;(function(Services){var CookieStorage=Storages.CookieStorage;var GopRequestStatus;(function(GopRequestStatus){GopRequestStatus[GopRequestStatus["STATUS_VERIFY_FAIL"]=10]="STATUS_VERIFY_FAIL";GopRequestStatus[GopRequestStatus["STATUS_NO_MODEL_IN_CITY"]=20]="STATUS_NO_MODEL_IN_CITY";GopRequestStatus[GopRequestStatus["STATUS_OK"]=4]="STATUS_OK";GopRequestStatus[GopRequestStatus["STATUS_ERROR"]=2]="STATUS_ERROR";GopRequestStatus["ERROR"]="error"})(GopRequestStatus=Services.GopRequestStatus||(Services.GopRequestStatus={}));var GopService=function(){function GopService(router,leadSubmitService){this.GOP_LEAD_ID_COOKIE_NAME="GopLeadId";this.GOP_FILLED_COOKIE_NAME="gop_filled";this.router=router;this.storage=new CookieStorage;this.leadSubmitService=leadSubmitService}GopService.prototype.save=function(lead){var _this=this;var url=this.router.generate("save_newcars_lead",{});return this.leadSubmitService.submit(url,lead,"json").done(function(response){switch(response.status){case Services.GopRequestStatus.STATUS_VERIFY_FAIL:case Services.GopRequestStatus.STATUS_OK:_this.setLastLeadId(response.leadId);_this.updateFilledGop(lead.model_id);break}})};GopService.prototype.getLastLeadId=function(){var value=this.storage.get(this.GOP_LEAD_ID_COOKIE_NAME);if(!value){return 0}return parseInt(value,10)};GopService.prototype.setLastLeadId=function(leadId){this.storage.set(this.GOP_LEAD_ID_COOKIE_NAME,leadId,{path:"/"})};GopService.prototype.isFilled=function(modelId){var result=false;$.each(this.getFilledGop(),function(i,gopModelId){if(gopModelId===modelId){result=true}});return result};GopService.prototype.updateFilledGop=function(modelId){var id=typeof modelId==="string"?parseInt(modelId,10):modelId;var filledGop=this.getFilledGop();if(filledGop.indexOf(id)===-1){filledGop.push(id)}this.setFilledGop(filledGop)};GopService.prototype.getFilledGop=function(){var value=this.storage.get(this.GOP_FILLED_COOKIE_NAME);if(!value){return[]}var filledGop=[];$.each(JSON.parse(value),function(i,gopModelId){filledGop.push(parseInt(gopModelId,10))});return filledGop};GopService.prototype.setFilledGop=function(value){this.storage.set(this.GOP_FILLED_COOKIE_NAME,JSON.stringify(value),{path:"/"})};return GopService}();Services.GopService=GopService})(Services||(Services={}));;
var Helpers;(function(Helpers){var RedirectType;(function(RedirectType){RedirectType["CURRENT_TAB"]="current_window";RedirectType["NEW_TAB"]="new_tab"})(RedirectType=Helpers.RedirectType||(Helpers.RedirectType={}));var RedirectHelper=function(){function RedirectHelper(){}RedirectHelper.redirect=function(link,redirectType){if(redirectType===void 0){redirectType=Helpers.RedirectType.CURRENT_TAB}var method=this.getRedirectMethod(redirectType);method(link)};RedirectHelper.getRedirectMethod=function(redirectType){var result;switch(redirectType){case Helpers.RedirectType.CURRENT_TAB:result=this.openInCurrentTab;break;case Helpers.RedirectType.NEW_TAB:result=this.openInNewTab;break;default:result=function(){};break}return result};RedirectHelper.openInCurrentTab=function(link){window.location.href=link};RedirectHelper.openInNewTab=function(link){var button=document.createElement("a");button.href=link;button.target="_blank";button.click();button.remove()};return RedirectHelper}();Helpers.RedirectHelper=RedirectHelper})(Helpers||(Helpers={}));;
var Services;(function(Services){var GopRequestAutoSubmit=function(){function GopRequestAutoSubmit(router,gopService,userInfoService,gaService,dataProxy){this.autosubmittableGopButtonSelector='[data-sub-type="gop-button-auto-submittable"]';this.router=router;this.gopService=gopService;this.userInfoService=userInfoService;this.gaService=gaService;this.dataProxy=dataProxy;this.addListener()}GopRequestAutoSubmit.prototype.addListener=function($context){if(this.userInfoService.isAutoSubmitEnabled()){var $buttons=$(this.autosubmittableGopButtonSelector,$context);this.unsetClickListener($buttons);this.setClickListener($buttons)}};GopRequestAutoSubmit.prototype.setClickListener=function($buttons){$buttons.bindFirst("click",$.proxy(this.onButtonClick,this))};GopRequestAutoSubmit.prototype.unsetClickListener=function($buttons){$buttons.off("click",$.proxy(this.onButtonClick,this))};GopRequestAutoSubmit.prototype.onButtonClick=function(event){var button=event.delegateTarget;var buttonData=button.dataset;var lead=this.buildLead(buttonData);if(this.validateLead(lead)){this.saveLead(lead,button);event.stopImmediatePropagation();return false}};GopRequestAutoSubmit.prototype.validateLead=function(lead){return!((lead.brand_id==823||lead.brand_id==857)&&!lead.email)};GopRequestAutoSubmit.prototype.saveLead=function(lead,button){var _this=this;this.gopService.save(lead).done(function(response){if(Services.GopRequestStatus.STATUS_NO_MODEL_IN_CITY===response.status){var $button=$(button);_this.unsetClickListener($button);$button.click()}else if(response.isNew){_this.trackGa(button).done(function(){_this.doRedirect(response.data,_this.getRedirectType(button))})}else{_this.doRedirect(response.data,_this.getRedirectType(button))}})};GopRequestAutoSubmit.prototype.getRedirectType=function(button){return button.dataset.redirectType};GopRequestAutoSubmit.prototype.buildLead=function(buttonData){var lead=new Leads.GopLead;lead.setAutoSubmitted();lead.setName(this.userInfoService.getName());lead.setPhone(this.userInfoService.getPhone());lead.setPurchaseDate(this.userInfoService.getPurchaseDate());lead.setEmail(this.userInfoService.getEmail());var locationData=typeof buttonData.location!=="undefined"?JSON.parse(buttonData.location):false;var location=typeof buttonData.location!=="undefined"?Forms.SelectLocationDto.create(locationData):this.userInfoService.getLocation();lead.setCityId(location.getCityId());lead.setPostcode(location.getPostCode());lead.setLocality(location.getLocalityId());lead.setBrandId(buttonData.brandId);lead.setModelId(buttonData.modelId);lead.setPartnerId(buttonData.partnerId);if(typeof buttonData.variantId!=="undefined"){lead.setVariantId(buttonData.variantId);this.dataProxy.getDataProxy().set("gopVariantId",{value:buttonData.variantId})}return lead.build()};GopRequestAutoSubmit.prototype.doRedirect=function(url,redirectType){Helpers.RedirectHelper.redirect(url,redirectType)};GopRequestAutoSubmit.prototype.trackGa=function(button){var result=$.Deferred();var gaCategory=$(button).data("trackeventCategory");var gaLabel=$(button).data("trackeventLabel");var hotnessGaCategory=this.getLeadHotnessCategory();var purchaseDateGaAction=this.userInfoService.getPurchaseDate();$.when(this.gaService.sendEvent(gaCategory,"GetOnRoadPrice",gaLabel),this.gaService.sendEvent(gaCategory,"GetOnRoadPrice (AutoSubmit)",gaLabel),this.gaService.sendEvent(hotnessGaCategory,purchaseDateGaAction,gaLabel)).always(function(){result.resolve()});return result};GopRequestAutoSubmit.prototype.getLeadHotnessCategory=function(){return"Lead hotness"};return GopRequestAutoSubmit}();Services.GopRequestAutoSubmit=GopRequestAutoSubmit})(Services||(Services={}));;
var Services;(function(Services){var RenderSelect=function(){function RenderSelect(renderService){this.ready=false;this.renderService=renderService;this._onReady=$.Callbacks()}RenderSelect.prototype.render=function(){var items=document.querySelectorAll("[data-render-select]");var length=items.length;for(var i=0;i<length;i++){var $element=$(items[i]);var data=$element.data("renderSelect");if(data.hasOwnProperty("data")){var options=data["data"];this.renderService.renderSelect($element,options)}if(i===length-1){this.onRendered()}}};RenderSelect.prototype.onReady=function(callback){if(this.isReady()){callback()}else{this._onReady.add(callback)}};RenderSelect.prototype.isReady=function(){return this.ready};RenderSelect.prototype.onRendered=function(){var _this=this;requestAnimationFrame(function(){_this.ready=true;_this._onReady.fire()})};return RenderSelect}();Services.RenderSelect=RenderSelect})(Services||(Services={}));;
var Services;(function(Services){var NotificationService=function(){function NotificationService(){}NotificationService.prototype.alert=function(message){alert(message)};return NotificationService}();Services.NotificationService=NotificationService})(Services||(Services={}));;
var Services;(function(Services){var StateService=function(){function StateService(){this.data=new Core.ParametersBag;this.onChangeCallbacks={}}StateService.prototype.set=function(key,value){var oldValue=this.data.get(key,undefined);this.data.set(key,value);if(this.onChangeCallbacks.hasOwnProperty(key)){this.onChangeCallbacks[key].fire(value,oldValue)}};StateService.prototype.get=function(key,defaults){if(defaults===void 0){defaults=null}return this.data.get(key,defaults)};StateService.prototype.onChange=function(key,cb){if(!this.onChangeCallbacks.hasOwnProperty(key)){this.onChangeCallbacks[key]=$.Callbacks()}this.onChangeCallbacks[key].add(cb)};return StateService}();Services.StateService=StateService})(Services||(Services={}));;
var GTM;(function(GTM){var CityInfo=function(){function CityInfo(){}CityInfo.prototype.getId=function(){return this.id};CityInfo.prototype.setId=function(value){this.id=value};CityInfo.prototype.getName=function(){return this.name};CityInfo.prototype.setName=function(value){this.name=value};CityInfo.prototype.getPath=function(){return this.path};CityInfo.prototype.setPath=function(value){this.path=value};return CityInfo}();GTM.CityInfo=CityInfo})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var NewDelhiCity=function(_super){__extends(NewDelhiCity,_super);function NewDelhiCity(){var _this=_super.call(this)||this;_this.setId("1147");_this.setName("New Delhi");_this.setPath("newdelhi");return _this}return NewDelhiCity}(GTM.CityInfo);GTM.NewDelhiCity=NewDelhiCity})(GTM||(GTM={}));;
var GTM;(function(GTM){var VariantItem=function(){function VariantItem(){}VariantItem.prototype.getId=function(){return this.id};VariantItem.prototype.setId=function(value){this.id=value};VariantItem.prototype.getBrand=function(){return this.brand};VariantItem.prototype.setBrand=function(value){this.brand=value};VariantItem.prototype.getModel=function(){return this.model};VariantItem.prototype.setModel=function(value){this.model=value};VariantItem.prototype.getVariant=function(){return this.variant};VariantItem.prototype.setVariant=function(value){this.variant=value};VariantItem.prototype.getName=function(){return this.name};VariantItem.prototype.setName=function(value){this.name=value};VariantItem.prototype.getPrice=function(){return this.price};VariantItem.prototype.setPrice=function(value){this.price=parseInt(value)};VariantItem.prototype.getPosition=function(){return this.position};VariantItem.prototype.setPosition=function(value){this.position=parseInt(value)};VariantItem.prototype.data=function(){return{id:this.getId(),brand:this.getBrand(),model:this.getModel(),variant:this.getVariant(),name:this.getName(),price:this.getPrice(),position:this.getPosition()}};return VariantItem}();GTM.VariantItem=VariantItem})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var VariantCompareItem=function(_super){__extends(VariantCompareItem,_super);function VariantCompareItem(){return _super!==null&&_super.apply(this,arguments)||this}VariantCompareItem.prototype.getQuantity=function(){return this.quantity};VariantCompareItem.prototype.setQuantity=function(value){this.quantity=parseInt(value)};VariantCompareItem.prototype.data=function(){var data=_super.prototype.data.call(this);data["quantity"]=this.getQuantity();return data};return VariantCompareItem}(GTM.VariantItem);GTM.VariantCompareItem=VariantCompareItem})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var VariantMateItem=function(_super){__extends(VariantMateItem,_super);function VariantMateItem(){return _super!==null&&_super.apply(this,arguments)||this}VariantMateItem.prototype.getList=function(){return this.list};VariantMateItem.prototype.setList=function(value){this.list=value};return VariantMateItem}(GTM.VariantItem);GTM.VariantMateItem=VariantMateItem})(GTM||(GTM={}));;
var GTM;(function(GTM){var ModelItem=function(){function ModelItem(){}ModelItem.prototype.getId=function(){return this.id};ModelItem.prototype.setId=function(value){this.id=value};ModelItem.prototype.getBrand=function(){return this.brand};ModelItem.prototype.setBrand=function(value){this.brand=value};ModelItem.prototype.getModel=function(){return this.model};ModelItem.prototype.setModel=function(value){this.model=value};ModelItem.prototype.getName=function(){return this.name};ModelItem.prototype.setName=function(value){this.name=value};ModelItem.prototype.getPriceFrom=function(){return this.priceFrom};ModelItem.prototype.setPriceFrom=function(value){this.priceFrom=value};ModelItem.prototype.getPriceTo=function(){return this.priceTo};ModelItem.prototype.setPriceTo=function(value){this.priceTo=value};ModelItem.prototype.getClass=function(){return this.class};ModelItem.prototype.setClass=function(value){this.class=value};ModelItem.prototype.getStatus=function(){return this.status};ModelItem.prototype.setStatus=function(value){var statuses=this.getStatuses();this.status=statuses[value]};ModelItem.prototype.getList=function(){return this.list};ModelItem.prototype.setList=function(value){this.list=value};ModelItem.prototype.getPosition=function(){return this.position};ModelItem.prototype.setPosition=function(value){this.position=value};ModelItem.prototype.data=function(){return{id:this.getId(),brand:this.getBrand(),model:this.getModel(),name:this.getName(),priceFrom:this.getPriceFrom(),priceTo:this.getPriceTo(),"class":this.getClass(),status:this.getStatus(),list:this.getList(),position:this.getPosition()}};ModelItem.prototype.getStatuses=function(){return{NORMAL:"onsale",ANNOUNCE:"upcoming",ANNONSE:"upcoming",MADE_OFF:"discontinued"}};return ModelItem}();GTM.ModelItem=ModelItem})(GTM||(GTM={}));;
var GTM;(function(GTM){var ModelProduct=function(){function ModelProduct(){}ModelProduct.prototype.getId=function(){return this.id};ModelProduct.prototype.setId=function(value){this.id=value};ModelProduct.prototype.getKey=function(){return this.key};ModelProduct.prototype.setKey=function(value){this.key=value};ModelProduct.prototype.getBrand=function(){return this.brand};ModelProduct.prototype.setBrand=function(value){this.brand=value};ModelProduct.prototype.getModel=function(){return this.model};ModelProduct.prototype.setModel=function(value){this.model=value};ModelProduct.prototype.getName=function(){return this.name};ModelProduct.prototype.setName=function(value){this.name=value};ModelProduct.prototype.getClass=function(){return this.class};ModelProduct.prototype.setClass=function(value){this.class=value};ModelProduct.prototype.getList=function(){return this.list};ModelProduct.prototype.setList=function(value){this.list=value};ModelProduct.prototype.getAssuredBenefits=function(){return this.assuredBenefits};ModelProduct.prototype.setAssuredBenefits=function(value){this.assuredBenefits=parseInt(value)||0};ModelProduct.prototype.getPriceFrom=function(){return this.priceFrom};ModelProduct.prototype.setPriceFrom=function(value){this.priceFrom=parseInt(value)||0};ModelProduct.prototype.getPriceTo=function(){return this.priceTo};ModelProduct.prototype.setPriceTo=function(value){this.priceTo=parseInt(value)||0};ModelProduct.prototype.getMileageMin=function(){return this.minMilege};ModelProduct.prototype.setMileageMin=function(value){this.minMilege=parseInt(value)||0};ModelProduct.prototype.getMileageMax=function(){return this.maxMileage};ModelProduct.prototype.setMileageMax=function(value){this.maxMileage=parseInt(value)||0};ModelProduct.prototype.getBodyType=function(){return this.bodyType};ModelProduct.prototype.setBodyType=function(value){this.bodyType=value};ModelProduct.prototype.setLowestPrice=function(value){this.lowestPrice=parseInt(value)||0};ModelProduct.prototype.getLowestPrice=function(){return this.lowestPrice};ModelProduct.prototype.data=function(){return{assuredBenefits:this.getAssuredBenefits(),brand:this.getBrand(),category:this.getBodyType(),"class":this.getClass(),id:this.getId(),list:this.getList(),"max mileAge":this.getMileageMax(),"min mileAge":this.getMileageMin(),model:this.getModel(),name:this.getName(),priceFrom:this.getPriceFrom(),priceTo:this.getPriceTo(),lowestPrice:this.getLowestPrice()}};return ModelProduct}();GTM.ModelProduct=ModelProduct})(GTM||(GTM={}));;
var GTM;(function(GTM){var VariantProduct=function(){function VariantProduct(){}VariantProduct.prototype.getId=function(){return this.id};VariantProduct.prototype.setId=function(value){this.id=value};VariantProduct.prototype.getKey=function(){return this.key};VariantProduct.prototype.setKey=function(value){this.key=value};VariantProduct.prototype.getBrand=function(){return this.brand};VariantProduct.prototype.setBrand=function(value){this.brand=value};VariantProduct.prototype.getModel=function(){return this.model};VariantProduct.prototype.setVariant=function(value){this.variant=value};VariantProduct.prototype.getVariant=function(){return this.variant};VariantProduct.prototype.setModel=function(value){this.model=value};VariantProduct.prototype.getName=function(){return this.name};VariantProduct.prototype.setName=function(value){this.name=value};VariantProduct.prototype.getList=function(){return this.list};VariantProduct.prototype.setList=function(value){this.list=value};VariantProduct.prototype.getAssuredBenefits=function(){return this.assuredBenefits};VariantProduct.prototype.setAssuredBenefits=function(value){this.assuredBenefits=value||"0"};VariantProduct.prototype.getPrice=function(){return this.price};VariantProduct.prototype.setPrice=function(value){this.price=value||"0"};VariantProduct.prototype.getMileage=function(){return this.mileAge};VariantProduct.prototype.setMileage=function(value){this.mileAge=value||"0"};VariantProduct.prototype.getCarType=function(){return this.carType};VariantProduct.prototype.setCarType=function(value){this.carType=value};VariantProduct.prototype.getFuelType=function(){return this.fuelType};VariantProduct.prototype.setFuelType=function(value){this.fuelType=value};VariantProduct.prototype.getEngine=function(){return this.engine};VariantProduct.prototype.setEngine=function(value){this.engine=value||"0"};VariantProduct.prototype.getDefaultPrice=function(){return this.defaultPrice};VariantProduct.prototype.setDefaultPrice=function(value){this.defaultPrice=parseInt(value)||0};return VariantProduct}();GTM.VariantProduct=VariantProduct})(GTM||(GTM={}));;
var GTM;(function(GTM){var GtmPage=function(){function GtmPage(service,dispatcher){this.gtmService=service;this.eventDispatcher=dispatcher}GtmPage.prototype.getCityInfo=function(){var cityId=this.getCookieValue("cityId"),cityName=this.getCookieValue("cityName"),cityPath=this.getCookieValue("city"),cityData;if(cityId&&cityName&&cityPath){cityData=new GTM.CityInfo;cityData.setId(cityId);cityData.setName(cityName);cityData.setPath(cityPath)}else{cityData=new GTM.NewDelhiCity}return cityData};GtmPage.prototype.withUserId=function(data){if(data===void 0){data={}}var userId=this.gtmService.getGa().getUserId();if(userId){data["userId"]=userId}return data};GtmPage.prototype.getBreadcrumbs=function(){var breadcrumbs=[];$(this.getBreadcrumbsSelector()).find("span").each(function(){breadcrumbs.push($(this).text().replace(/(\s){2,}/g,""))});return breadcrumbs};GtmPage.prototype.getBreadcrumbsSelector=function(){return"#breadcrumbs li"};GtmPage.prototype.getCookieValue=function(name){return $.cookie(name)};return GtmPage}();GTM.GtmPage=GtmPage})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var ModelGtmPage=function(_super){__extends(ModelGtmPage,_super);function ModelGtmPage(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.variantCompareCollection=[];_this.modelDataProvider=new GTM.ModelDataProvider;_this.compareDataService=new GTM.CompareDataProvider;_this.attachEventListeners();return _this}ModelGtmPage.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe(this.getRouteName()+":Ready",this.onReadyCallback.bind(this));this.eventDispatcher.subscribe("ModelPage:GOP_Button",this.onGopButtonClickCallback.bind(this));this.eventDispatcher.subscribe("ModelPage:EMI_Button",this.onEmiButtonClickCallback.bind(this));this.eventDispatcher.subscribe("ModelPage:TestDrive_Button",this.onTestDriveButtonClickCallback.bind(this));this.eventDispatcher.subscribe("ModelPage:Booking_Button",this.onBookingButtonClickCallback.bind(this));this.eventDispatcher.subscribe("ModelPage:Variant_Compare",this.onVariantCompareCallback.bind(this));this.eventDispatcher.subscribe("GopPopup:formSubmit",this.onGopSubmitCallback.bind(this));this.eventDispatcher.subscribe("TestDrivePopup:formSubmit",this.onTestdriveSubmitCallback.bind(this));this.eventDispatcher.subscribe("BookingPopup:formSubmit",this.onBookingSubmitCallback.bind(this))};ModelGtmPage.prototype.getRouteName=function(){return"modelPage"};ModelGtmPage.prototype.onReadyCallback=function(event){this.modelDataProvider.init();this.gtmService.pushData({caregoryBreadcrumbs:this.getBreadcrumbs().join("/"),event:"impressions",ecommerce:this.modelDataProvider.getEcommerceObject()});var contentData=this.modelDataProvider.getContentObject();contentData["event"]="fb_view_product";this.gtmService.pushData(contentData);this.gtmService.pushData(this.modelDataProvider.getAdWordsData())};ModelGtmPage.prototype.onGopButtonClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"GetOnRoadPrice_button",eventLabel:data["label"],eventContext:data["context"]})};ModelGtmPage.prototype.onEmiButtonClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"CalculateEMI_click",eventLabel:data["label"],priceFrom:$("[data-gtm-emi-price]").data("gtmEmiPrice")})};ModelGtmPage.prototype.onTestDriveButtonClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"TestDrive_click",eventLabel:data["label"],eventContext:data["context"]})};ModelGtmPage.prototype.onBookingButtonClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"Booking_click",eventLabel:data["label"],eventContext:data["context"]})};ModelGtmPage.prototype.onGopSubmitCallback=function(event){var data=event.getData();this.gtmService.pushData(this.withUserId({event:"GAEvent",eventCategory:"Interaction",eventAction:"GetOnRoadPrice saved",eventLabel:data["model_id"],ecommerce:this.modelDataProvider.getGopSubmitEcommerce(data)}))};ModelGtmPage.prototype.onTestdriveSubmitCallback=function(event){var data=event.getData();this.gtmService.pushData(this.withUserId({event:"GAEvent",eventCategory:"Action",eventAction:"TestDrive",eventLabel:data["model_id"],ecommerce:this.modelDataProvider.getTestdriveEcommerce(data)}))};ModelGtmPage.prototype.onBookingSubmitCallback=function(event){var data=event.getData();this.gtmService.pushData(this.withUserId({event:"GAEvent",eventCategory:"Action",eventAction:"Booking",eventLabel:data["model_id"],ecommerce:this.modelDataProvider.getBookingEcommerce(data)}))};ModelGtmPage.prototype.onVariantCompareCallback=function(event){var data=event.getData(),itemData=data["item"]||{},variant=new GTM.VariantCompareItem;variant.setId(itemData["id"]);variant.setBrand(itemData["brand"]);variant.setModel(itemData["model"]);variant.setVariant(itemData["variant"]);variant.setName(itemData["name"]);variant.setPrice(itemData["price"]);variant.setPosition(itemData["position"]);variant.setQuantity(itemData["quantity"]);if(this.variantCompareCollection.indexOf(variant.getId())===-1){this.variantCompareCollection.push(variant.getId());this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"AddToCompare",eventLabel:data["label"],ecommerce:this.compareDataService.getVariantAddEcommerce(variant)})}else{this.variantCompareCollection.splice(variant.getId());this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"RemoveFromCompare",eventLabel:data["label"],ecommerce:this.compareDataService.getVariantRemoveEcommerce(variant)})}};return ModelGtmPage}(GTM.GtmPage);GTM.ModelGtmPage=ModelGtmPage})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var GopResultGtmPage=function(_super){__extends(GopResultGtmPage,_super);function GopResultGtmPage(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.attachEventListeners();return _this}GopResultGtmPage.prototype.attachEventListeners=function(){var _this=this;this.eventDispatcher.once("gopResultModel:ready",function(e){_this.onReadyCallback(e.getData())})};GopResultGtmPage.prototype.onReadyCallback=function(model){this.pushGeneralData(model);this.pushPageType();this.pushRemarketingData(model)};GopResultGtmPage.prototype.pushRemarketingData=function(model){this.gtmService.pushData({dynx_itemid:["newcars",model.getBrand().getPath(),model.getPath()].join("|"),dynx_totalvalue:model.getCheapestVariant().getShowroomPrice()})};GopResultGtmPage.prototype.pushPageType=function(){this.gtmService.pushData({pageType:"GoRP Result"})};GopResultGtmPage.prototype.pushGeneralData=function(model){var contentData={content_category:"Newcars",content_ids:[["newcars",model.getBrand().getPath(),model.getPath()].join("|")],content_name:model.getBrandName()+" "+model.getName(),content_type:"product",currency:"rupee",event:"fb_add_to_cart",value:model.getCheapestVariant().getOnRoadPrice()};this.gtmService.pushData(contentData)};return GopResultGtmPage}(GTM.GtmPage);GTM.GopResultGtmPage=GopResultGtmPage})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var FooterGtmPage=function(_super){__extends(FooterGtmPage,_super);function FooterGtmPage(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.attachEventListeners();return _this}FooterGtmPage.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe("FooterPage:PopularBrands_Link",this.onPopularBrandsClickCallback.bind(this));this.eventDispatcher.subscribe("FooterPage:PopularCars_Link",this.onPopularCarsClickCallback.bind(this));this.eventDispatcher.subscribe("FooterPage:CarFinder_Link",this.onCarFinderClickCallback.bind(this));this.eventDispatcher.subscribe("FooterPage:UpcomingCars_Link",this.onUpcomingCarsClickCallback.bind(this));this.eventDispatcher.subscribe("FooterPage:PopularBikes_Link",this.onPopularBikesClickCallback.bind(this))};FooterGtmPage.prototype.onPopularBrandsClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Footer",eventAction:"PopularBrands",eventLabel:data["label"]})};FooterGtmPage.prototype.onPopularCarsClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Footer",eventAction:"PopularCars",eventLabel:data["label"]})};FooterGtmPage.prototype.onCarFinderClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Footer",eventAction:"CarFinder",eventLabel:data["label"]})};FooterGtmPage.prototype.onUpcomingCarsClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Footer",eventAction:"UpcomingCars",eventLabel:data["label"]})};FooterGtmPage.prototype.onPopularBikesClickCallback=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Footer",eventAction:"PopularBikes",eventLabel:data["label"]})};return FooterGtmPage}(GTM.GtmPage);GTM.FooterGtmPage=FooterGtmPage})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var VariantGtmPage=function(_super){__extends(VariantGtmPage,_super);function VariantGtmPage(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.variantDataProvider=new GTM.VariantDataProvider;_this.attachEventListeners();return _this}VariantGtmPage.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe("variantPage:Ready",this.onReadyCallback.bind(this))};VariantGtmPage.prototype.onReadyCallback=function(event){this.variantDataProvider.init();this.gtmService.pushData({caregoryBreadcrumbs:this.getBreadcrumbs().join("/"),event:"impressions",ecommerce:this.variantDataProvider.getEcommerceObject()});var contentData=this.variantDataProvider.getContentObject();contentData["event"]="fb_view_product";this.gtmService.pushData(contentData);this.gtmService.pushData(this.variantDataProvider.getAdWordsData())};return VariantGtmPage}(GTM.GtmPage);GTM.VariantGtmPage=VariantGtmPage})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var CompareCollection=function(){function CompareCollection(){this.collection={length:0}}CompareCollection.prototype.add=function(item,index){index=index||this.collection.length;this.collection[index]=item;this.collection.length++};CompareCollection.prototype.remove=function(index){if(this.collection[index]){this.collection[index]=undefined;this.collection.length--}};CompareCollection.prototype.has=function(index){return!!this.collection[index]};CompareCollection.prototype.get=function(index){if(!this.collection[index]){throw new Error("Item not found.")}return this.collection[index]};CompareCollection.prototype.getLength=function(){return this.collection.length};return CompareCollection}();var CompareGtmPage=function(_super){__extends(CompareGtmPage,_super);function CompareGtmPage(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.variantCompareCollection=new CompareCollection;_this.dataService=new GTM.CompareDataProvider;_this.attachEventListeners();return _this}CompareGtmPage.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe("catalog~CompareForm:Ready",this.onFormReadyCallback.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_Brand",this.onFormSelectBrand.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_Model",this.onFormSelectModel.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_Variant",this.onFormSelectVariant.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_Start",this.onFormStartComparison.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_ClearSlot",this.onFormClearSlot.bind(this));this.eventDispatcher.subscribe("ComparePage:PopularComparison",this.onPopularComparisonClick.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_ModelClick",this.onFormModelClick.bind(this));this.eventDispatcher.subscribe("ComparePage:Form_VariantClick",this.onFormVariantClick.bind(this));this.eventDispatcher.subscribe("ComparePage:GOP_Button",this.onGopButtonClick.bind(this));this.eventDispatcher.subscribe("ComparePage:PopularChoices_Button",this.onPopularChoicesClick.bind(this));this.eventDispatcher.subscribe("finder~compare1:Loaded",this.onResultReadyCallback.bind(this))};CompareGtmPage.prototype.onFormReadyCallback=function(event){this.gtmService.pushData({caregoryBreadcrumbs:this.getBreadcrumbs().join("/")})};CompareGtmPage.prototype.onResultReadyCallback=function(){var selectedCars=this.dataService.getImpressionsFromSlots(window["slots"]["_values"]);for(var i in selectedCars){if(selectedCars.hasOwnProperty(i)){var variant=selectedCars[i];this.variantCompareCollection.add(variant,variant.getPosition())}}this.gtmService.pushData({caregoryBreadcrumbs:this.getCompareResultBreadcrumbs(),ecommerce:{impressions:selectedCars}})};CompareGtmPage.prototype.onFormSelectBrand=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Filter",eventAction:"Brand",eventLabel:data["label"]})};CompareGtmPage.prototype.onFormSelectModel=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Filter",eventAction:"Model",eventLabel:data["label"]})};CompareGtmPage.prototype.onFormSelectVariant=function(event){var data=event.getData(),variant=this.dataService.getVariantProduct(data);this.gtmService.pushData({event:"GAEvent",eventCategory:"Filter",eventAction:"Variant",eventLabel:variant.getVariant()});if(variant){this.variantCompareCollection.add(variant,variant.getPosition());this.gtmService.pushData({event:"GAEvent",eventCategory:"Ecommerce",eventAction:"AddToCompare",eventLabel:variant.getVariant(),ecommerce:this.dataService.getVariantAddEcommerce(variant)})}};CompareGtmPage.prototype.onFormStartComparison=function(event){this.gtmService.pushData({event:"GAEvent",eventCategory:"Comparison",eventAction:"start",eventLabel:this.variantCompareCollection.getLength()})};CompareGtmPage.prototype.onFormClearSlot=function(event){var data=event.getData();var variant=null;if(this.variantCompareCollection.has(data["index"])){variant=this.variantCompareCollection.get(data["index"]);this.variantCompareCollection.remove(data["index"]);this.gtmService.pushData({event:"GAEvent",eventCategory:"Ecommerce",eventAction:"RemoveFromCompare",eventLabel:variant["variant"],ecommerce:this.dataService.getVariantRemoveEcommerce(variant)})}};CompareGtmPage.prototype.onPopularComparisonClick=function(event){var data=event.getData();this.gtmService.pushData({event:"GAEvent",eventCategory:"Comparison",eventAction:"CompareCars",eventLabel:data["label"]})};CompareGtmPage.prototype.onFormModelClick=function(event){var data=event.getData(),currentCity=this.getCityInfo();this.gtmService.pushData({cityName:currentCity.getName(),cityId:currentCity.getId(),pageType:this.dataService.getPageType(window["gtmPageName"]),event:"GAEvent",eventCategory:"Ecommerce",eventAction:"productClick",eventLabel:data["id"],ecommerce:this.dataService.getModelClickEcommerce(data)})};CompareGtmPage.prototype.onFormVariantClick=function(event){var data=event.getData(),variant=null,currentCity=this.getCityInfo();if(this.variantCompareCollection.has(data["index"])){variant=this.variantCompareCollection.get(data["index"]);this.gtmService.pushData({cityName:currentCity.getName(),cityId:currentCity.getId(),pageType:this.dataService.getPageType(window["gtmPageName"]),event:"GAEvent",eventCategory:"Ecommerce",eventAction:"productClick",eventLabel:variant.getId(),ecommerce:this.dataService.getVariantClickEcommerce(variant)})}};CompareGtmPage.prototype.onGopButtonClick=function(event){var data=event.getData();var variant=null;if(this.variantCompareCollection.has(data["index"])){variant=this.variantCompareCollection.get(data["index"]);this.gtmService.pushData({event:"GAEvent",eventCategory:"Interaction",eventAction:"GetOnRoadPrice_button",eventContext:"Comparison",eventLabel:variant.getId(),priceFrom:variant.getPrice()})}};CompareGtmPage.prototype.onPopularChoicesClick=function(event){var selectedCars=this.dataService.getImpressionsFromSlots(window["slots"]["_values"]);this.variantCompareCollection=new CompareCollection;for(var i in selectedCars){if(selectedCars.hasOwnProperty(i)){var variant=selectedCars[i];this.variantCompareCollection.add(variant,variant.getPosition());this.gtmService.pushData({event:"GAEvent",eventCategory:"Ecommerce",eventAction:"AddToCompare",eventLabel:variant.getVariant(),ecommerce:this.dataService.getVariantAddEcommerce(variant)})}}};CompareGtmPage.prototype.getCompareResultBreadcrumbs=function(){var breadcrumbs=this.getBreadcrumbs();return[breadcrumbs[0],breadcrumbs[1],"Cars comparison"].join("/")};return CompareGtmPage}(GTM.GtmPage);GTM.CompareGtmPage=CompareGtmPage})(GTM||(GTM={}));;
var GTM;(function(GTM){var DataCallback=function(){function DataCallback(){}DataCallback.toPlainObject=function(){return function(item){return item.data&&item.data()}};return DataCallback}();GTM.DataCallback=DataCallback})(GTM||(GTM={}));;
var GTM;(function(GTM){var GoogleTagManagerService=function(){function GoogleTagManagerService(name,eventDispatcher){this.dataLayerName=name;this.dispatcher=new GTM.GtmEventDispatcher(eventDispatcher);this.pages=[];this.init()}GoogleTagManagerService.prototype.setGa=function(ga){this.ga=ga};GoogleTagManagerService.prototype.getGa=function(){return this.ga};GoogleTagManagerService.prototype.init=function(){this.pages.push(new GTM.FooterGtmPage(this,this.dispatcher));this.pages.push(new GTM.ModelGtmPage(this,this.dispatcher));this.pages.push(new GTM.CompareGtmPage(this,this.dispatcher));this.pages.push(new GTM.GopGtmPopup(this,this.dispatcher));this.pages.push(new GTM.VariantGtmPage(this,this.dispatcher));this.pages.push(new GTM.GopResultGtmPage(this,this.dispatcher));this.triggerReady()};GoogleTagManagerService.prototype.register=function(page){this.pages.push(page)};GoogleTagManagerService.prototype.pushData=function(data){this.getGtmDataLayer().push(data)};GoogleTagManagerService.prototype.pushEvent=function(event){this.pushData({event:event})};GoogleTagManagerService.prototype.getDispatcher=function(){return this.dispatcher};GoogleTagManagerService.prototype.getData=function(name){var result=[];this.getGtmDataLayer().forEach(function(item){for(var i in item){if(item.hasOwnProperty(i)&&i===name){result.push(item[i])}}});return result.length>1?result:result[0]};GoogleTagManagerService.prototype.triggerReady=function(){this.getDispatcher().publish(this.getGtmPageName()+":Ready")};GoogleTagManagerService.prototype.getGtmDataLayer=function(){return window[this.dataLayerName]};GoogleTagManagerService.prototype.getGtmPageName=function(){return window["gtmPageName"]};return GoogleTagManagerService}();GTM.GoogleTagManagerService=GoogleTagManagerService})(GTM||(GTM={}));;
var GTM;(function(GTM){var GtmEventDispatcher=function(){function GtmEventDispatcher(dispatcher){this.apDispatcher=dispatcher;this.init(dispatcher)}GtmEventDispatcher.prototype.init=function(dispatcher){var _this=this;$(document).on("click","[data-gtm-event]:not(:checkbox,:radio,select,textarea)",function(jEvent){_this.dispatchClickEvent(jEvent)});$(document).on("change","[data-gtm-event]",function(jEvent){_this.dispatchChangeEvent(jEvent)})};GtmEventDispatcher.prototype.publish=function(event,eventData){this.apDispatcher.publish(event,eventData)};GtmEventDispatcher.prototype.subscribe=function(event,callback){this.apDispatcher.subscribe(event,callback)};GtmEventDispatcher.prototype.once=function(event,callback){this.apDispatcher.once(event,callback)};GtmEventDispatcher.prototype.dispatchClickEvent=function(jEvent){var data=$(jEvent.currentTarget).data();if(data["gtmEvent"]){this.publish(data["gtmEvent"],data["gtmData"])}};GtmEventDispatcher.prototype.dispatchChangeEvent=function(jEvent){var data=$(jEvent.currentTarget).data();data["gtmData"]=data["gtmData"]?data["gtmData"]:$(jEvent.currentTarget).find(":selected").data("gtmData");if(data["gtmEvent"]){this.publish(data["gtmEvent"],data["gtmData"])}};return GtmEventDispatcher}();GTM.GtmEventDispatcher=GtmEventDispatcher})(GTM||(GTM={}));;
var GTM;(function(GTM){var ModelDataProvider=function(){function ModelDataProvider(){this.purchaseDates={now:"Immediately","2week":"Withing 2 weeks","1month":"Withing a month",no:"Just Reserching"};this.products=[];this.collections=[]}ModelDataProvider.prototype.init=function(data){var productData=this.collectProductData(),additionalData=this.collectAdditionalData();if(data){Object.assign(productData,data["product"]);Object.assign(additionalData,data["collections"])}this.addProduct(productData);this.addCollections(additionalData)};ModelDataProvider.prototype.getEcommerceObject=function(){var impressions=[];if(this.collections["impressions"]){impressions=this.collections["impressions"].map(GTM.DataCallback.toPlainObject())}return{impressions:impressions}};ModelDataProvider.prototype.getContentObject=function(){return{content_ids:[this.getProduct().getKey().substring(0,100)],content_name:this.getProduct().getName(),value:this.getProduct().getPriceFrom(),content_type:"product",content_category:"Newcars",currency:"rupee"}};ModelDataProvider.prototype.getAdWordsData=function(){return{dynx_itemid:this.getProduct().getKey().substring(0,100),dynx_totalvalue:this.getProduct().getLowestPrice()}};ModelDataProvider.prototype.getGopSubmitEcommerce=function(leadData){var self=this,gopData=this.products.map(GTM.DataCallback.toPlainObject());gopData.forEach(function(value,index){value["category"]=self.products[index].getBodyType();value["quantity"]=1;value["planningToBuy"]=self.getPurchaseDate(leadData["purchase_date"])});return{checkout:{actionField:{step:"1",option:"GetOnRoadPrice saved"},products:gopData}}};ModelDataProvider.prototype.getBookingEcommerce=function(leadData){var bookingData=[];this.products.map(GTM.DataCallback.toPlainObject()).forEach(function(product){var bookingGtmObject={brand:product["brand"],category:product["category"],"class":product["class"],list:product["list"],model:product["model"],name:product["name"]+" "+leadData["variantName"],id:leadData["variant_id"],showroomName:leadData["showroomName"],showroomAddress:leadData["showroomAddress"],variant:leadData["variantName"],city:leadData["cityName"],price:leadData["price"]};bookingData.push(bookingGtmObject)});return this.getBookingTestdriveData(bookingData)};ModelDataProvider.prototype.getTestdriveEcommerce=function(leadData){var testdriveData=[];this.products.map(GTM.DataCallback.toPlainObject()).forEach(function(value){value["showroomName"]=leadData["showroomName"];value["showroomAddress"]=leadData["showroomAddress"];value["city"]=leadData["cityName"];testdriveData.push(value)});return this.getBookingTestdriveData(testdriveData)};ModelDataProvider.prototype.addProduct=function(product){this.products.push(product)};ModelDataProvider.prototype.getProducts=function(){return this.products};ModelDataProvider.prototype.getProduct=function(index){if(index===void 0){index=0}return this.getProducts()[index]};ModelDataProvider.prototype.addCollections=function(data){for(var prop in data){if(data.hasOwnProperty(prop)){this.collections[prop]=data[prop]}}};ModelDataProvider.prototype.collectAdditionalData=function(){var data={},self=this;$("[data-gtm-collection]").each(function(){var name=$(this).data("gtmCollection"),collection=[];$("[data-gtm-item]",this).each(function(){var item=self.parseItem($(this));collection.push(item)});data[name]=name in data?data[name].concat(collection):collection});return data};ModelDataProvider.prototype.collectProductData=function(){var product=new GTM.ModelProduct,productData=$("[data-gtm-product]").data("gtmData"),benefitsWorth=$("[data-gtm-product-assured-benefits]").data("gtmProductAssuredBenefits"),priceMin=$("[data-gtm-product-price-min]").data("gtmProductPriceMin"),priceMax=$("[data-gtm-product-price-max]").data("gtmProductPriceMax");product.setId(productData["id"]);product.setKey(productData["key"]);product.setBrand(productData["brand"]);product.setModel(productData["model"]);product.setName(productData["name"]);product.setClass(productData["class"]);product.setList(productData["list"]);product.setBodyType(productData["category"]);product.setMileageMin(productData["min mileAge"]);product.setMileageMax(productData["max mileAge"]);product.setLowestPrice(productData["lowestprice"]);product.setAssuredBenefits(benefitsWorth);product.setPriceFrom(priceMin);product.setPriceTo(priceMax);return product};ModelDataProvider.prototype.parseItem=function($dom){var item=new GTM.ModelItem;item.setId($dom.data("gtmItemId"));item.setBrand($dom.data("gtmItemBrand"));item.setModel($dom.data("gtmItemModel"));item.setName($dom.data("gtmItemName"));item.setPriceFrom($dom.children("[data-gtm-item-price-min]").data("gtmItemPriceMin"));item.setPriceTo($dom.children("[data-gtm-item-price-max]").data("gtmItemPriceMax"));item.setClass($dom.data("gtmItemClass"));item.setStatus($dom.data("gtmItemStatus"));item.setList($dom.data("gtmItemList"));item.setPosition($dom.data("gtmItemPosition"));return item};ModelDataProvider.prototype.getBookingTestdriveData=function(productsData){return{checkout:{actionField:{step:"1",option:"BookTestDrive"},products:productsData}}};ModelDataProvider.prototype.getPurchaseDate=function(key){return this.purchaseDates[key]};return ModelDataProvider}();GTM.ModelDataProvider=ModelDataProvider})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var VariantDataProvider=function(_super){__extends(VariantDataProvider,_super);function VariantDataProvider(){return _super!==null&&_super.apply(this,arguments)||this}VariantDataProvider.prototype.getContentObject=function(){return{content_ids:[this.getProduct().getKey().substring(0,100)],content_name:this.getProduct().getName(),value:this.getProduct().getPrice(),content_type:"product",content_category:"Newcars",currency:"rupee"}};VariantDataProvider.prototype.getAdWordsData=function(){return{dynx_itemid:this.getProduct().getKey().substring(0,100),dynx_totalvalue:this.getProduct().getDefaultPrice()}};VariantDataProvider.prototype.getProduct=function(index){if(index===void 0){index=0}return this.getProducts()[index]};VariantDataProvider.prototype.collectProductData=function(){var product=new GTM.VariantProduct,productData=$("[data-gtm-product]").data("gtmData"),benefitsWorth=$("[data-gtm-product-assured-benefits]").data("gtmProductAssuredBenefits"),priceMin=$("[data-gtm-product-price-min]").data("gtmProductPriceMin");product.setId(productData["id"]);product.setKey(productData["key"]);product.setBrand(productData["brand"]);product.setModel(productData["model"]);product.setVariant(productData["variant"]);product.setName(productData["name"]);product.setList(productData["list"]);product.setAssuredBenefits(benefitsWorth);product.setPrice(priceMin);product.setMileage(productData["mileAge"]);product.setCarType(productData["carType"]);product.setFuelType(productData["fuelType"]);product.setEngine(productData["engine"]);product.setDefaultPrice(productData["lowestprice"]);return product};return VariantDataProvider}(GTM.ModelDataProvider);GTM.VariantDataProvider=VariantDataProvider})(GTM||(GTM={}));;
var GTM;(function(GTM){var CompareDataProvider=function(){function CompareDataProvider(){this.pageTypes={"catalog~CompareForm":"Comparison page","finder~compare1":"Comparison Result page"}}CompareDataProvider.prototype.getPageType=function(key){return this.pageTypes[key]};CompareDataProvider.prototype.getVariantAddEcommerce=function(variant){return{add:{products:[variant].map(GTM.DataCallback.toPlainObject())}}};CompareDataProvider.prototype.getVariantRemoveEcommerce=function(variant){return{remove:{products:[variant].map(GTM.DataCallback.toPlainObject())}}};CompareDataProvider.prototype.getModelClickEcommerce=function(model){return{click:{actionField:{list:"Comparison page"}},products:[model].map(GTM.DataCallback.toPlainObject())}};CompareDataProvider.prototype.getVariantClickEcommerce=function(variant){return{click:{actionField:{list:"Comparison page"}},products:[variant].map(GTM.DataCallback.toPlainObject())}};CompareDataProvider.prototype.getImpressionsFromSlots=function(slotModels){var impressions=new Array,self=this;slotModels.forEach(function(item){if(!self.checkSlotData(item)){return}var variant=new GTM.VariantCompareItem,variantName=[item["brand"]["brand_name"],item["vehicle"]["complect_name"],item["model"]["model_name"]].join(" ");variant.setId(item["model"]["model_id"]);variant.setBrand(item["brand"]["brand_name"]);variant.setModel(item["vehicle"]["complect_name"]);variant.setVariant(item["model"]["model_name"]);variant.setName(variantName);variant.setPrice(item["model"]["price_min"]);variant.setQuantity("1");variant.setPosition(item["index"]+1);impressions.push(variant)});return impressions};CompareDataProvider.prototype.getVariantProduct=function(dataset){var item=new GTM.VariantCompareItem;item.setId(dataset["id"]);item.setBrand(dataset["brand"]);item.setModel(dataset["model"]);item.setVariant(dataset["variant"]);item.setName(dataset["name"]);item.setPrice(dataset["price"]);item.setQuantity(dataset["quantity"]);item.setPosition(dataset["position"]);return item};CompareDataProvider.prototype.checkSlotData=function(data){return data["brand"]&&data["vehicle"]&&data["model"]};return CompareDataProvider}();GTM.CompareDataProvider=CompareDataProvider})(GTM||(GTM={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var GopGtmPopup=function(_super){__extends(GopGtmPopup,_super);function GopGtmPopup(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.attachEventListeners();return _this}GopGtmPopup.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe("GopPopup:leadSaved",this.onLeadSavedCallback.bind(this));this.eventDispatcher.subscribe("GopPopup:leadVerifiedSaved",this.onVerifiedSavedCallback.bind(this));this.eventDispatcher.subscribe("GopPopup:leadVerifiedSavedNew",this.onVerifiedSavedNewCallback.bind(this));this.eventDispatcher.subscribe("GopPopup:formSubmit",this.onFormSubmitCallback.bind(this))};GopGtmPopup.prototype.onLeadSavedCallback=function(event){this.gtmService.pushData(this.withUserId({event:"GORP_Lead_Saved"}))};GopGtmPopup.prototype.onVerifiedSavedCallback=function(event){this.gtmService.pushEvent("GORP_Lead_Verified_Saved")};GopGtmPopup.prototype.onVerifiedSavedNewCallback=function(event){this.gtmService.pushEvent("GORP_Lead_Verified_Saved_New")};GopGtmPopup.prototype.onFormSubmitCallback=function(event){};return GopGtmPopup}(GTM.GtmPage);GTM.GopGtmPopup=GopGtmPopup})(GTM||(GTM={}));;
var Leads;(function(Leads){var Lead=function(){function Lead(){}return Lead}();Leads.Lead=Lead})(Leads||(Leads={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Diwali;(function(Diwali){var AlertFormView=function(_super){__extends(AlertFormView,_super);function AlertFormView(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.disableHalt=false;return _this}AlertFormView.prototype.holdDisabled=function(){this.disableHalt=true};AlertFormView.prototype.unholdDisabled=function(){this.disableHalt=false};AlertFormView.prototype.enableSubmit=function(){if(!this.disableHalt){this.getSubmitButton().removeAttr("disabled")}};AlertFormView.prototype.getUserName=function(){return this.find('[data-diwali="name"]').val()};AlertFormView.prototype.getUserPhone=function(){return this.find('[data-diwali="phone"]').val()};AlertFormView.prototype.getUserEmail=function(){return this.find('[data-diwali="email"]').val()};AlertFormView.prototype.setUserName=function(value){return this.find('[data-diwali="name"]').val(value)};AlertFormView.prototype.setUserPhone=function(value){return this.find('[data-diwali="phone"]').val(value)};AlertFormView.prototype.setUserEmail=function(value){return this.find('[data-diwali="email"]').val(value)};return AlertFormView}(General.FormView);Diwali.AlertFormView=AlertFormView})(Diwali||(Diwali={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Diwali;(function(Diwali){var AlertFormValidator=function(_super){__extends(AlertFormValidator,_super);function AlertFormValidator(){return _super!==null&&_super.apply(this,arguments)||this}AlertFormValidator.prototype.getRules=function(){return{"diwali_subscribe_alert[userName]":{required:true,autoportalName:true},"diwali_subscribe_alert[userEmail]":{required:true,email:true,emailNoTopLevelDomains:true},"diwali_subscribe_alert[phone]":{required:true,sellCarPhone:true}}};AlertFormValidator.prototype.getMessages=function(){return{"diwali_subscribe_alert[userName]":"Please enter valid Name.","diwali_subscribe_alert[userEmail]":"Please enter valid Email.","diwali_subscribe_alert[phone]":"Please enter valid Number."}};return AlertFormValidator}(General.FormValidator);Diwali.AlertFormValidator=AlertFormValidator})(Diwali||(Diwali={}));;
var Diwali;(function(Diwali){var AlertFormController=function(){function AlertFormController($form,container){this.eventDispatcher=container.get("event_dispatcher");this.userInfoService=container.get("user_info_service");this.ga=container.get("ga");this.notificationService=container.get("notification_service");this.userInfo=container.get("user_info_service");this.view=this.createView($form);this.model=this.createModel();this.validator=this.createValidator();this.successSubmitAction="Landing"}AlertFormController.prototype.init=function(){this.handleValidation();this.handleModel();this.handleView()};AlertFormController.prototype.handleView=function(){this.view.setUserPhone(this.userInfoService.getPhone());this.view.setUserEmail(this.userInfoService.getEmail());this.view.setUserName(this.userInfoService.getName())};AlertFormController.prototype.handleValidation=function(){var _this=this;this.validator.init();this.validator.onFormValid(function(){_this.view.enableSubmit()});this.validator.onFormInvalid(function(){_this.view.disableSubmit()})};AlertFormController.prototype.handleModel=function(){var _this=this;this.model.beforeSubmit(function(model){if(!_this.validator.validate()){model.cancelSubmit()}});this.model.onFormSubmit(function(){_this.view.disableSubmit()});this.model.onFormSubmit(function(){_this.view.holdDisabled()});this.model.onFormSubmit(function(){_this.saveUserInfo()});this.model.afterSubmit(function(){_this.view.unholdDisabled()});this.model.onFormSubmit(function(){_this.userInfoService.setName(_this.view.getUserName());_this.userInfoService.setPhone(_this.view.getUserPhone());_this.userInfoService.setEmail(_this.view.getUserEmail());_this.userInfoService.saveClientId()});this.model.afterSubmit(function(response){_this.trackGa().done(function(){switch(true){case response.status===Diwali.AlertResponseStatus.OK:_this.triggerSuccessEvent();break;case response.status===Diwali.AlertResponseStatus.ERROR:_this.view.disableSubmit();_this.notificationService.alert(response.message);break;default:_this.view.disableSubmit();_this.notificationService.alert("Server Error.")}})})};AlertFormController.prototype.saveUserInfo=function(){this.userInfo.setEmail(this.view.getUserEmail());this.userInfo.setName(this.view.getUserName());this.userInfo.setPhone(this.view.getUserPhone())};AlertFormController.prototype.triggerSuccessEvent=function(){this.eventDispatcher.publish("diwaliLead:saved")};AlertFormController.prototype.trackGa=function(){return this.ga.sendEvent("Diwali",this.successSubmitAction,"Subscribe for Alert")};AlertFormController.prototype.setSuccessAction=function(action){this.successSubmitAction=action};AlertFormController.prototype.createView=function($form){return new Diwali.AlertFormView($form)};AlertFormController.prototype.createModel=function(){return new Diwali.AlertFormModel(this.view)};AlertFormController.prototype.createValidator=function(){return new Diwali.AlertFormValidator(this.view)};return AlertFormController}();Diwali.AlertFormController=AlertFormController})(Diwali||(Diwali={}));;
var Diwali;(function(Diwali){var AlertResponseStatus;(function(AlertResponseStatus){AlertResponseStatus[AlertResponseStatus["OK"]="ok"]="OK";AlertResponseStatus[AlertResponseStatus["ERROR"]="error"]="ERROR"})(AlertResponseStatus=Diwali.AlertResponseStatus||(Diwali.AlertResponseStatus={}));var AlertFormModel=function(){function AlertFormModel(view){this.view=view;this._beforeSubmit=$.Callbacks();this._afterSubmit=$.Callbacks();this._onSubmit=$.Callbacks();this._beforeRedirect=$.Callbacks();this.submitionCanceled=false;this.addListeners()}AlertFormModel.prototype.getView=function(){return this.view};AlertFormModel.prototype.addListeners=function(){var _this=this;this.view.getForm().on("submit",function(event){_this.onSubmit(event)})};AlertFormModel.prototype.beforeSubmit=function(callback){this._beforeSubmit.add(callback)};AlertFormModel.prototype.afterSubmit=function(callback){this._afterSubmit.add(callback)};AlertFormModel.prototype.onFormSubmit=function(callback){this._onSubmit.add(callback)};AlertFormModel.prototype.beforeRedirect=function(callback){this._beforeRedirect.add(callback)};AlertFormModel.prototype.cancelSubmit=function(){this.submitionCanceled=true};AlertFormModel.prototype.onSubmit=function(event){event.preventDefault();this._beforeSubmit.fire(this);if(!this.submitionCanceled){this.submit(this.buildLead())}this.submitionCanceled=false};AlertFormModel.prototype.submit=function(lead){var _this=this;this._onSubmit.fire(this);$.post(this.view.getAction(),lead,function(response){_this._afterSubmit.fire(response,_this)},"json")};AlertFormModel.prototype.buildLead=function(){var lead=this.createLead();return lead.build(this.view)};AlertFormModel.prototype.createLead=function(){return new Leads.DiwaliSubscribeAlertLead};return AlertFormModel}();Diwali.AlertFormModel=AlertFormModel})(Diwali||(Diwali={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Leads;(function(Leads){var DiwaliSubscribeAlertLead=function(_super){__extends(DiwaliSubscribeAlertLead,_super);function DiwaliSubscribeAlertLead(){return _super!==null&&_super.apply(this,arguments)||this}DiwaliSubscribeAlertLead.prototype.build=function(view){return{"diwali_subscribe_alert[userName]":""+view.getUserName(),"diwali_subscribe_alert[userEmail]":""+view.getUserEmail(),"diwali_subscribe_alert[phone]":""+view.getUserPhone()}};return DiwaliSubscribeAlertLead}(Leads.Lead);Leads.DiwaliSubscribeAlertLead=DiwaliSubscribeAlertLead})(Leads||(Leads={}));;
var ElementTypes;(function(ElementTypes){ElementTypes[ElementTypes["Block"]=0]="Block";ElementTypes[ElementTypes["Input"]=1]="Input";ElementTypes[ElementTypes["CheckBox"]=2]="CheckBox";ElementTypes[ElementTypes["Radio"]=3]="Radio"})(ElementTypes||(ElementTypes={}));var BlockElement;(function(BlockElement){BlockElement[BlockElement["SPAN"]=1]="SPAN";BlockElement[BlockElement["DIV"]=2]="DIV";BlockElement[BlockElement["P"]=3]="P";BlockElement[BlockElement["TEXTAREA"]=4]="TEXTAREA";BlockElement[BlockElement["BUTTON"]=5]="BUTTON";BlockElement[BlockElement["CODE"]=6]="CODE";BlockElement[BlockElement["A"]=7]="A";BlockElement[BlockElement["H1"]=8]="H1";BlockElement[BlockElement["H2"]=9]="H2";BlockElement[BlockElement["H3"]=10]="H3";BlockElement[BlockElement["H4"]=11]="H4";BlockElement[BlockElement["H5"]=12]="H5";BlockElement[BlockElement["H6"]=13]="H6";BlockElement[BlockElement["PRE"]=14]="PRE";BlockElement[BlockElement["SCRIPT"]=15]="SCRIPT";BlockElement[BlockElement["TD"]=16]="TD"})(BlockElement||(BlockElement={}));var Dom=function(){function Dom(){}Dom.setValue=function($element,value){switch(this.getType($element)){case ElementTypes.CheckBox:$element.attr("checked",value);break;case ElementTypes.Radio:$element.filter('[value="'+value+'"]').prop("checked",true);break;case ElementTypes.Input:Dom.setInputValue($element,value);break;case ElementTypes.Block:Dom.setHtmlValue($element,value);break}};Dom.setHtmlValue=function($collection,value){$.each($collection,function(index){if($collection.hasOwnProperty(index)){var element=$collection.get(index);element.innerHTML=value}})};Dom.setInputValue=function($collection,value){$.each($collection,function(index){if($collection.hasOwnProperty(index)){var element=$collection.get(index);element.value=value}})};Dom.getValue=function($element){var result;switch(this.getType($element)){case ElementTypes.CheckBox:result=$element.is(":checked");break;case ElementTypes.Radio:result=$element.filter(":checked").val();break;case ElementTypes.Input:result=$element.val();break;case ElementTypes.Block:result=$element.html();break}return result};Dom.getType=function($element){var result=ElementTypes.Input;var elementTagName=$element.prop("nodeName").toUpperCase();if($element.attr("type")==="checkbox"){result=ElementTypes.CheckBox}else if($element.attr("type")==="radio"){result=ElementTypes.Radio}else if(BlockElement[elementTagName]){result=ElementTypes.Block}return result};return Dom}();;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Form;(function(Form){var SmsVerifyForm=function(_super){__extends(SmsVerifyForm,_super);function SmsVerifyForm(){return _super!==null&&_super.apply(this,arguments)||this}SmsVerifyForm.prototype.onSkipLink=function(){this.eventDispatcher.publish("gop:skipSmsVerify",this)};SmsVerifyForm.prototype.onSubmitCallback=function(data){this.currentValidateCodeResult=data;if(typeof data!=="undefined"){if(data.status==="verified"){if(data.result==="ok"){this.eventDispatcher.publish(this.getEventKeyByName("success"))}else{this.eventDispatcher.publish(this.getEventKeyByName("response"))}}else{this.eventDispatcher.publish(this.getEventKeyByName("fail"))}}};return SmsVerifyForm}(Form.AbstractSmsVerifyForm);Form.SmsVerifyForm=SmsVerifyForm})(Form||(Form={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Form;(function(Form){var BookTestDriveForm=function(_super){__extends(BookTestDriveForm,_super);function BookTestDriveForm(){return _super!==null&&_super.apply(this,arguments)||this}BookTestDriveForm.prototype.buildLead=function(){var lead=new BookTestDriveLead(this.container);return lead.build()};return BookTestDriveForm}(Form.Form);Form.BookTestDriveForm=BookTestDriveForm})(Form||(Form={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Gop;(function(Gop){var SmsVerification=function(_super){__extends(SmsVerification,_super);function SmsVerification(container){var _this=_super.call(this,container)||this;_this._onSkip=$.Callbacks();return _this}SmsVerification.prototype.buildData=function(){return{phone:this.phone,code:this.getVerificationCodeElement().val()}};SmsVerification.prototype.updateByDataSet=function(dataset){this.getChangePhoneElement().attr("data-trackevent-label",dataset.title)};SmsVerification.prototype.onSkip=function(callback){this._onSkip.add(callback)};SmsVerification.prototype.onSkipLink=function(){this._onSkip.fire()};return SmsVerification}(Form.AbstractSmsVerifyForm);Gop.SmsVerification=SmsVerification})(Gop||(Gop={}));;
function BookingForm(container){return{userCity:null,dealersUrl:"/calls/ajax/premium_dealers_showrooms/",dealersTestDriveUrl:"/calls/ajax/dealers_showrooms/",checkModelDealersUrl:null,requestButtonBlock:null,$requestBlockContainer:null,$requestBlock:null,$offerBlock:null,$mainBlock:null,showButton:false,$dealerSelect:null,$variantSelect:null,$form:null,bookTestDrive:null,validator:null,requestType:null,brandId:null,modelId:null,cityId:0,modelListUrl:"/calls/ajax/brand_model_with_prices/",variantListUrl:"/calls/ajax/model_variant_with_prices/",previousRequestType:null,previousBrandId:null,previousModelId:null,previousVariantId:null,previousVariantCityId:null,previousCityId:null,previousCityModelId:null,previousDealerBrandId:null,previousDealerCityId:null,previousPriceCityId:null,previousPriceModelId:null,previousPriceVariantId:null,previousShowroomRequestType:null,requestPopUp:null,gopPopUp:null,isPopUpBody:false,isGopResult:false,images:{},validateOptions:{validClass:"valid",errorClass:"active",validateOptions:{rules:{localityBlockModel:{required:true,requiredLocationAutocompleteCity:true}},messages:{localityBlockModel:"Please Enter Valid Location."}}},gtmService:null,variantSelectable:null,notificationService:null,ga:null,trackeventCategory:"Booking",trackeventLabel:"",analyticsUserBehavior:null,smartechPopupCloseHandler:null,onCloseAnalyticsTracking:true,onElementInvalidCallbacks:$.Callbacks(),analyticsCanonicalTestDriveMap:{name:"name",email:"email",phone:"phone",localityBlockModel:"modelCity",modelCity:"modelCity",showroom:"showroomId",showroomId:"showroomId",agree:"terms",terms:"terms",variantId:"variantId"},analyticsInteractionCanonicalTestDriveMap:{name:"Name",email:"Email",phone:"Phone",showroomId:"Dealer",showroom:"Dealer",localityBlockModel:"City",modelCity:"City",agree:"terms",terms:"terms"},analyticsCanonicalBookingMap:{name:"name",email:"email",phone:"phone",localityBlockModel:"bookingModelCity",bookingModelCity:"bookingModelCity",variantId:"modelVariant",modelVariant:"modelVariant",showroomId:"showroomId",showroom:"showroomId",terms:"terms"},analyticsInteractionCanonicalBookingMap:{name:"Name",email:"Email",phone:"Phone",showroomId:"Dealer",showroom:"Dealer",localityBlockModel:"City",bookingModelCity:"City",terms:"terms",variantId:"modelVariant",modelVariant:"modelVariant"},init:function(parameters){this.isGopResult=parameters.isGopResult||false;this.modelId=parameters.options.modelId;this.brandId=parameters.options.brandId;this.requestType=parameters.options.requestType;this.defaultCityId=parameters.options.defaultCityId;this.dealersUrl=parameters.options.dealersUrl;this.checkModelDealersUrl=parameters.options.checkModelDealersUrl;this.modelId=parameters.options.modelId;this.brandId=parameters.options.brandId;this.$mainBlock=parameters.$mainBlock;this.requestButtonBlock=parameters.requestButtonBlock;this.$requestBlockContainer=parameters.$requestBlockContainer;this.$requestBlock=parameters.$requestBlock;this.$offerBlock=parameters.$offerBlock;this.$form=this.getForm();this.$dealerSelect=this.getDealerElement();this.$variantSelect=this.getVariantElement();this.$document=$(document);this.smsVerifyForm=parameters.smsVerifyForm;this.variantSelectable=parameters.variantSelectable||false;this.smartechPopupCloseHandler=container.get("smartech.popup_close.handler");if(this.smsVerifyForm){this.attachSmsVerifyEvents()}this.validateOptions=$.extend(true,this.validateOptions,parameters.validateOptions);this.requestType=parameters.options.requestType;this.bookTestDrive=new Form.BookTestDriveForm(container);this.requestPopUp=new Popup.ConfirmableFormPopup(this.$requestBlock.get(0),container.get("event_dispatcher"));this.gopPopUp=new Popup.ConfirmableFormPopup(this.getGopPopupForm().get(0),container.get("event_dispatcher"));this.isPopUpBody=parameters.isPopUpBody||false;this.gopPopUp.onOpen(function(){var userInfoService=container.get("user_info_service");this.getGopPopupForm().find('[data-bind="userName"]').val(userInfoService.getName());this.getGopPopupForm().find('[data-bind="userPhone"]').val(userInfoService.getPhone())}.bind(this));var popupService=container.get("popup_service");if(!popupService.isExist("request_popup")){popupService.add("request_popup",this.requestPopUp)}if(!popupService.isExist("booking_gop_popup")){popupService.add("booking_gop_popup",this.gopPopUp)}this.gtmService=container.get("gtm_service");this.notificationService=container.get("notification_service");this.ga=container.get("ga");this.analyticsUserBehavior=container.get("analytics_user_behavior");this.modelSelectLocation=this.createLocationView('[data-block="localityBlockModel"]');this.toggleRequestButton();this.attachListeners();this.setUserInfo();this.initData();this.setGtmPrefix();this.trackValidationErrors();this.trackFieldsInteraction()},createLocationView:function(selector){var _this=this;var result=new Forms.SelectLocationView(this,selector);result.addParameter("model",function(){return _this.getModelId()});result.addParameter("with_premium_showroom",function(){return true});return result},initData:function(){var requestType=this.$form.find("[name=request_type]").first().val();var brandId=this.$form.find("[name=brand_id]").first().val();var modelId=this.$form.find("[name=model_id]").first().val();var cityId=this.getCityId();if(this.requestType||requestType){this.setRequestType(this.requestType?this.requestType:requestType)}if(this.brandId||!isNaN(parseInt(brandId))){this.setBrandId(this.brandId?this.brandId:brandId)}if(this.modelId||!isNaN(parseInt(modelId))){this.setModelId(this.modelId?this.modelId:modelId)}this.cityId=container.get("user_info_service").getLocation().getCityId();if(!this.cityId){this.cityId=parseInt($.cookie("cityId"),10)||0}if(this.cityId||!isNaN(parseInt(cityId))){this.setCityId(cityId?cityId:this.cityId)}this.setAnalyticsInteractionBuffer()},setUserInfo:function(){var userInfoService=container.get("user_info_service");this.setName(userInfoService.getName());this.setEmail(userInfoService.getEmail());this.setPhone(userInfoService.getPhone());this.initDetectedCity();this.modelSelectLocation.restore(userInfoService.getLocation());this.triggerChangeLocation()},triggerChangeLocation:function(){this.modelSelectLocation.getDom().find("[data-bind]").each(function(){$(this).trigger("change")})},handleTyPopup:function(){var tyPopup=this.getTyPopup();var self=this;tyPopup.onOpen(function(){self.getTyMessage().show();self.updateTyMessageByRequestType();self.updateTyHowCanBuyData();if(self.isPopUpBody){$("body").removeClass("fade-body")}});tyPopup.onClose(function(){self.getTyMessage().hide()})},getTyPopup:function(){var tyPopup;if(this.isExistTyPopup()){tyPopup=container.get("popup_service").get(this.getTyPopupId())}else{tyPopup=new Popup.BasePopup(this.getTyMessage());container.get("popup_service").add(this.getTyPopupId(),tyPopup)}return tyPopup},isExistTyPopup:function(){return container.get("popup_service").isExist(this.getTyPopupId())},attachListeners:function(){this.handleTyPopup();this.requestButtonEventListeners();this.attachValidationEvents();this.GopButtonEventListeners();this.onUpdateModel();var self=this;this.requestPopUp.onOpen(function(){this.onCloseAnalyticsTracking=true;self.unlockForm();self.$requestBlock.show();self.updateAnalyticsInteractionBuffer()});this.requestPopUp.onClose(function(){self.onRequestPopupClose(self.requestPopUp);self.$requestBlock.hide()});this.requestPopUp.afterUserClose(function(){var event=null;if(self.isBookingRequest()){event=Smartech.SmartechActivity.BkFormClosed}else{event=Smartech.SmartechActivity.TdFormClosed}var modelId=self.getModelId();if(!modelId){return}self.smartechPopupCloseHandler.send({eventId:event,modelId:modelId})});this.gopPopUp.onOpen(function(){self.getGopPopupForm().show()});this.gopPopUp.onClose(function(){self.getGopPopupForm().hide()});this.$document.on("afterCityInitialize.cityDetection",this.onAfterCityInitialize.bind(this));if(this.isBookingRequest()){this.$form.on("input keydown",function(event){var $element=$(event.target);if(this.isBookingRequest()){var name=this.getAnalyticsCanonicalName($element,this.analyticsInteractionCanonicalBookingMap);this.analyticsUserBehavior.registerBookingElementChanged(name)}if(this.isTestDriveRequest()){var name=this.getAnalyticsCanonicalName($element,this.analyticsInteractionCanonicalTestDriveMap);this.analyticsUserBehavior.registerTestDriveElementChanged(name)}}.bind(this))}var eventDispatcher=container.get("event_dispatcher");eventDispatcher.subscribe("name:change",this.onChangeName.bind(this));eventDispatcher.subscribe("phone:change",this.onChangePhone.bind(this));eventDispatcher.subscribe("cityId:change",this.onChangeCity.bind(this));eventDispatcher.subscribe("cityId:update",this.onUpdateCity.bind(this));eventDispatcher.subscribe("modelId:change",this.onChangeModel.bind(this));eventDispatcher.subscribe("modelId:update",this.onUpdateModel.bind(this));eventDispatcher.subscribe("variantId:change",this.onChangeVariant.bind(this));eventDispatcher.subscribe("variantId:update",this.onUpdateVariant.bind(this));eventDispatcher.subscribe("showroomId:change",this.onChangeShowroom.bind(this));eventDispatcher.subscribe("showroomId:update",function(){self.onUpdateShowroom(self.getCityId())});eventDispatcher.subscribe("requestType:change",this.onChangeRequestType.bind(this));eventDispatcher.subscribe("requestType:update",this.onUpdateRequestType.bind(this));eventDispatcher.subscribe("price:update",this.onUpdatePrice.bind(this));eventDispatcher.subscribe("bookingFormCity:change",this.onUpdateCity.bind(this))},updateFromDataset:function(dataset){dataset.cityId&&this.setCityId(dataset.cityId);this.initDetectedCity();dataset.brandId&&this.setBrandId(dataset.brandId);dataset.modelId&&this.setModelId(dataset.modelId);dataset.variantId&&this.setVariantId(dataset.variantId);dataset.title&&this.setTitle(dataset.title);dataset.requestType&&this.setRequestType(dataset.requestType);dataset.partnerId&&this.setPartnerId(dataset.partnerId);dataset.trackeventCategory&&this.setTrackeventCategory(dataset.trackeventCategory)},initDetectedCity:function(){var cityId=this.getSelectedInTabCityId();var cityName=this.getSelectedInTabCityName();this.onUpdateShowroom(cityId);this.setCitySelection(cityId,cityName);this.setCityId(cityId);var self=this;try{this.loadPrices(cityId,this.getModelId(),function(variants){var prices=[];for(var i in variants){prices.push(variants[i].min)}var $city=self.$form.find("span[data-type=cityPrice]");var $price=self.$form.find("span[data-type=price]");$city.html(cityName);$price.html(Helper.Price.formatPriceRange(Math.min.apply(null,prices),Math.max.apply(null,prices)))})}catch(e){}},requestButtonEventListeners:function(){var self=this;self.$document.on("click",self.requestButtonBlock,function(){if(self.requestButtonBlock){var $b=jQuery(this);var dataset=$(this).data();if(!$b.hasClass("disabled")){self.enableSubmitButton();self.updateFromDataset(dataset);self.attachValidationEvents();if(self.$requestBlockContainer){self.$requestBlock.detach().appendTo(self.$requestBlockContainer)}else{self.$requestBlock.detach().appendTo($b.parent())}self.requestPopUp.open()}}})},attachValidationEvents:function(){var self=this;var options={rules:{name:{required:true,autoportalName:true},email:{required:true,email:true,emailNoTopLevelDomains:true},phone:{required:true,sellCarPhone:true},localityBlockModel:{required:true,requiredLocationAutocompleteCity:true},terms:"required",cityId:"required",showroomId:"required"},messages:{name:"Please enter valid Name.",email:"Please enter valid Email.",phone:"Please enter valid Number.",terms:"Please agree with Terms and Conditions.",cityId:"Please select City.",showroomId:"Please select Dealer",localityBlockModel:"Please Enter Valid Location"},highlight:function(element,errorClass,validClass){self.getErrorBlock($(element).attr("name")).removeClass(validClass).addClass(errorClass)},unhighlight:function(element,errorClass,validClass){self.getErrorBlock($(element).attr("name")).removeClass(errorClass).addClass(validClass)},errorPlacement:function(error,element){self.getErrorBlock(element.attr("name")).html(error.text())},submitHandler:function(form){self.disableSubmitButton();self.onSubmit()},showErrors:function(errorMap,errorList){if(errorList.length){self.disableSubmitButton()}this.defaultShowErrors()},success:function(){self.enableSubmitButton()}};options=jQuery.extend(options,this.validateOptions);options.errorPlacement=function(self,originalErrorPlacement){return function($error,$element){var errorMessage=$error.text();if(errorMessage.length){self.onElementInvalidCallbacks.fire(errorMessage,$element)}originalErrorPlacement($error,$element)}}(this,options.errorPlacement);this.validator=this.$form.validate(options)},trackValidationErrors:function(){if(this.isTestDriveRequest()){this.onElementInvalid(function(error,$element){this.analyticsUserBehavior.onTestDriveElementError(this.getTrackeventCategory(),this.getAnalyticsCanonicalName($element,this.analyticsCanonicalTestDriveMap),error)}.bind(this))}if(this.isBookingRequest()){this.onElementInvalid(function(error,$element){this.analyticsUserBehavior.onBookingElementError(this.getTrackeventCategory(),this.getAnalyticsCanonicalName($element,this.analyticsCanonicalBookingMap),error)}.bind(this))}},onElementInvalid:function(callback){this.onElementInvalidCallbacks.add(callback)},attachSmsVerifyEvents:function(){var eventDispatcher=container.get("event_dispatcher");var smsVerifyNamespace=this.smsVerifyForm.getNamespace();eventDispatcher.subscribe(smsVerifyNamespace+":success",this.onSmsSuccessVerify.bind(this));eventDispatcher.subscribe(smsVerifyNamespace+":response",this.onSmsSuccessVerify.bind(this));eventDispatcher.subscribe(smsVerifyNamespace+":fail",this.onFailSmsVerify.bind(this));eventDispatcher.subscribe(smsVerifyNamespace+":updatePhone",this.onChangePhone.bind(this))},getRequestType:function(){return container.get("binding").has("requestType")?container.get("binding").get("requestType").get():this.requestType},setRequestType:function(requestType){if(container.get("binding").has("requestType")){container.get("binding").get("requestType").set(requestType)}this.requestType=requestType;container.get("event_dispatcher").publish("requestType:update")},setTitle:function(title){this.$requestBlock.find('[data-type="brand-model-title"]').html(title);this.getTyMessage().find('[data-type="brand-model-title"]').html(title)},updateTyMessageByRequestType:function(){var $content=$();var $tyMessage=this.getTyMessage();switch(true){case this.isBookingRequest():$content=$tyMessage.find('[data-ty-content-for="booking"]');break;case this.isTestDriveRequest():$content=$tyMessage.find('[data-ty-content-for="testdrive"]');break}$tyMessage.find("[data-ty-content-for]").addClass("d_n");$content.removeClass("d_n")},updateTyHowCanBuyData:function(){var gaCategory="Model";switch(true){case this.isTestDriveRequest():gaCategory="Test Drive";break;case this.isBookingRequest():gaCategory="Booking";break}this.getTyMessage().find('[data-type="know-more-link"]').attr("data-trackevent-category",gaCategory).attr("data-trackevent-action","How-"+this.getGaPrefix()).attr("data-trackevent-label",this.getTitle())},getTitle:function(){var title=this.$requestBlock.find('[data-type="brand-model-title"]').html();return title||""},isTestDriveRequest:function(){return this.getRequestType()=="Testdrive"},isBookingRequest:function(){return this.getRequestType()=="Booking"},isAppointmentRequest:function(){return this.getRequestType()=="Appointment"},getBrandId:function(){var brandId=container.get("binding").has("brandId")?container.get("binding").get("brandId").get():null;var result=parseInt(brandId);return!isNaN(parseInt(result))?result:0},setBrandId:function(brandId){brandId=parseInt(brandId);if(brandId>0){if(container.get("binding").has("brandId")){container.get("binding").get("brandId").set(brandId)}else{container.get("binding").set("brandId",brandId)}}},getModelId:function(){var modelId=container.get("binding").has("modelId")?container.get("binding").get("modelId").get():null;var result=parseInt(modelId);return!isNaN(parseInt(result))?result:0},setModelId:function(modelId){modelId=parseInt(modelId);if(!isNaN(modelId)){if(container.get("binding").has("modelId")){container.get("binding").get("modelId").set(modelId)}else{container.get("binding").set("modelId",modelId)}}},getVariantId:function(){var variantId=container.get("binding").has("variantId")?container.get("binding").get("variantId").get():null;var result=parseInt(variantId);return!isNaN(parseInt(result))?result:0},setVariantId:function(variantId){variantId=parseInt(variantId);if(!isNaN(variantId)){if(container.get("binding").has("variantId")){container.get("binding").get("variantId").set(variantId)}else{container.get("binding").set("variantId",variantId)}}},setPartnerId:function(partnerId){partnerId=parseInt(partnerId);if(!isNaN(partnerId)){if(container.get("binding").has("partnerId")){container.get("binding").get("partnerId").set(partnerId)}else{container.get("binding").set("partnerId",partnerId)}}},setTrackeventCategory:function(category){this.trackeventCategory=category},getTrackeventCategory:function(){return this.trackeventCategory},setTrackeventLabel:function(label){this.trackeventLabel=label},getTrackeventLabel:function(){return this.trackeventLabel||this.getTitle()},getCityId:function(){return this.modelSelectLocation.getCityId()},getSelectedInTabCityId:function(){return $('[data-type="model_block"]:visible [data-type="cityInput"]').data("typeId")},getSelectedInTabCityName:function(){return $('[data-type="model_block"]:visible [data-type="cityName"]').html()},setCityId:function(cityId){cityId=parseInt(cityId);if(!isNaN(cityId)){if(container.get("binding").has("cityId")){container.get("binding").get("cityId").set(cityId)}else{container.get("binding").set("cityId",cityId)}}},setCitySelection:function(cityId,cityName){if(typeof this.modelSelectLocation.getSelectLocality()!=="undefined"){this.modelSelectLocation.getSelectLocality().setCityId(cityId);this.modelSelectLocation.getSelectLocality().setCityName(cityName);this.modelSelectLocation.getSelectLocality().setSelectedValue(cityName);this.modelSelectLocation.update()}},getDealerId:function(){var result=null;if(container.get("binding").has("dealerId")){result=parseInt(container.get("binding").get("dealerId").get())}return!isNaN(parseInt(result))?result:0},setDealerId:function(dealerId){container.get("binding").get("dealerId").set(dealerId)},unsetDealerId:function(){container.get("binding").get("dealerId").set("")},getShowroomId:function(){var result=container.get("binding").has("showroomId")?parseInt(container.get("binding").get("showroomId").get()):0;return!isNaN(result)?result:0},setShowroomId:function(showroomId){container.get("binding").get("showroomId").set(parseInt(showroomId))},unsetShowroomId:function(){container.get("binding").get("showroomId").set("")},getName:function(){return this.$form.find('[data-bind="userName"]').val()},getEmail:function(){return this.$form.find('[data-bind="userEmail"]').val()},getPhone:function(){return this.$form.find('[data-bind="userPhone"]').val()},setPhone:function(phone){this.$form.find('[data-bind="userPhone"]').val(phone).trigger("change");container.get("user_info_service").setPhone(phone)},setEmail:function(value){return this.$form.find('[data-bind="userEmail"]').val(value).trigger("change")},setName:function(value){return this.$form.find('[data-bind="userName"]').val(value).trigger("change")},getModelElement:function(){return this.$form.find("[name=modelId]")},getVariantElement:function(){return this.$form.find("[name=variantId]")},getCityElement:function(){return this.$form.find("[name=cityId]")},getDealerElement:function(){return this.$form.find("[name=showroomId]")},getLocation:function(){return this.modelSelectLocation.getSelectedValue()},getTermsElement:function(){return this.$form.find('[data-bind="terms"]')},lockForm:function(){this.lockSubmitButton=true;this.$form.find("input, select").not(this.smsVerifyForm.$form.find("input")).prop("disabled",true)},unlockForm:function(){this.lockSubmitButton=false;this.$form.find("input, select").prop("disabled",false)},onChangeRequestType:function(event){event.stopPropagation();container.get("event_dispatcher").publish("cityId:update");container.get("event_dispatcher").publish("variantId:update");container.get("event_dispatcher").publish("price:update")},onChangeName:function(){this.getTyMessage().find('span[data-type="ty-name"]').html(this.getName())},onChangePhone:function(event){var phone=this.smsVerifyForm.getPhone();this.setPhone(phone);this.hideOtpErrorMsq();this.$form.submit()},onChangeCity:function(){if(!this.isCityListEmpty()){this.enableCityList()}container.get("event_dispatcher").publish("modelId:update");container.get("event_dispatcher").publish("variantId:update");container.get("event_dispatcher").publish("showroomId:update")},onChangeBrand:function(){container.get("event_dispatcher").publish("modelId:update")},onChangeModel:function(){var $modelList=this.getModelElement();if($modelList.children('[value!=""]').size()>0){$modelList.attr("disabled",false)}this.updateImage();container.get("event_dispatcher").publish("cityId:update");container.get("event_dispatcher").publish("variantId:update");container.get("event_dispatcher").publish("price:update")},onChangeVariant:function(){var $variantList=this.getVariantElement();if($variantList.children('[value!=""]').size()>0){$variantList.attr("disabled",false)}container.get("event_dispatcher").publish("price:update")},onChangeShowroom:function(){var $dealerList=this.getDealerElement();if($dealerList.children('[value!=""]').size()>0){$dealerList.attr("disabled",false)}var $dealer=$dealerList.find("option:selected").first();this.setDealerId($dealer.data("dealerId"));this.getTyMessage().find('span[data-type="ty-dealer-contact"]').text($dealer.data("contact"));this.getTyMessage().find('span[data-type="ty-dealer"]').text($dealer.data("dealerName"))},onUpdateRequestType:function(){if(this.previousRequestType==this.getRequestType()){return false}this.setGtmPrefix();this.previousRequestType=this.getRequestType();window.currentRequest=this.getRequestType();var $variantList=this.getVariantElement();$variantList.show();$variantList.prop("disabled",false);if(this.isTestDriveRequest()||this.isAppointmentRequest()){$variantList.prop("disabled",true);$variantList.hide()}this.$document.find('span[data-type="request-title"]').text(this.getRequestTitle());this.smsVerifyForm.getChangePhoneElement().attr("data-trackevent-category",this.getRequestTitle()+" Request").attr("data-trackevent-label",this.getTitle());container.get("event_dispatcher").publish("requestType:change")},updateImage:function(){var self=this;var modelId=this.getModelId();var $img=this.$requestBlock.find('img[data-type="model-image"]');if(!modelId){}else if(this.images.hasOwnProperty(modelId)){if(container.get("mobile_detect").mobile()){$img.attr("src",this.images[modelId]["small"])}else{$img.attr("src",this.images[modelId]["normal"])}}else{$img.parent().addClass("busy");$.getJSON("/?a=catalog~getModelImage",{model_id:this.getModelId()}).done(function(data){self.images[modelId]={normal:data.image.src,small:data.imageSmall.src};$img.parent().removeClass("busy");if(container.get("mobile_detect").mobile()){$img.attr("src",self.images[modelId]["small"])}else{$img.attr("src",self.images[modelId]["normal"])}})}},onUpdateModel:function(){var self=this;var brandId=this.getBrandId();var cityId=this.getCityId();var modelId=this.getModelId();if(this.previousBrandId==brandId&&this.previousCityId==cityId){return false}this.previousBrandId=brandId;this.previousCityId=cityId;var $modelList=this.getModelElement();$modelList.attr("disabled",true);if(this.modelListUrl&&brandId&&cityId){container.get("data_proxy_service").getDataProxy().loadBrandModelWithPrices(brandId,cityId).done(function(data){$modelList.children('[value!=""]').remove();$.each(data,function(idx,elem){if(modelId===0&&elem.id>0){self.setModelId(elem.id)}$modelList.append($("<option/>").val(elem.id).text(elem.name).attr("data-price-min",elem.min).attr("data-price-max",elem.max))});if($modelList.children('[value!=""]').size()>0){$modelList.attr("disabled",false)}container.get("event_dispatcher").publish("showroomId:update");container.get("event_dispatcher").publish("variantId:update");container.get("event_dispatcher").publish("price:update")})}},onUpdateVariant:function(){this.trackElementChanges(this.getVariantElement());var self=this;var modelId=this.getModelId();var cityId=this.getCityId();var variantId=this.getVariantId();if(!this.isBookingRequest()){return false}if(this.previousModelId==modelId&&this.previousVariantCityId==cityId){return false}this.previousModelId=modelId;this.previousVariantCityId=cityId;var $variantList=this.getVariantElement();$variantList.attr("disabled",true);if(this.variantListUrl&&cityId&&modelId){container.get("data_proxy_service").getDataProxy().loadModelVariantWithPrices(modelId,cityId).done(function(data){$variantList.children('[value!=""]').remove();$.each(data,function(idx,elem){if(idx===0&&elem.id>0){variantId=elem.id}var $elem=$("<option/>").val(elem.id).text(elem.name).attr("data-price-min",elem.min).attr("data-price-max",elem.max);if(!elem.min){$elem.attr("disabled",true)}if(variantId==elem.id){$elem.attr("selected","selected")}$variantList.append($elem)});if($variantList.children('[value!=""]').size()>0){$variantList.attr("disabled",false)}if($variantList.find("option:selected").length==0){$variantList.find("option").first().attr("selected","selected");variantId=$variantList.val()}self.setVariantId(variantId);container.get("event_dispatcher").publish("showroomId:update");container.get("event_dispatcher").publish("variantId:change");container.get("event_dispatcher").publish("price:update")})}},onUpdateCity:function(){var self=this;var brandId=this.getBrandId();var modelId=this.getModelId();this.previousCityModelId=modelId;this.disableCityList();if(brandId&&modelId){this.getCitiesWithModelPricesPromise().done(function(data){var renderData=[];$.each(data,function(idx,elem){var item={};item["value"]=elem.id;item["label"]=elem.name;item["attrs"]={};item["attrs"]["data-price-min"]=elem.min;item["attrs"]["data-price-max"]=elem.max;if(!elem.min){item["disabled"]=true}renderData.push(item)});self.renderCityList(renderData)}).then(function(data){var cityId=self.getCityId();var cityFound=0;$.each(data,function(idx,elem){if(cityId===0&&elem.id>0){cityId=elem.id}if(cityId>0&&cityId==elem.id){cityFound=1}});if(!self.isCityListEmpty()){self.enableCityList();if(!cityFound){var newCityId=self.getFirstCityListItemValue();if(newCityId){cityId=newCityId}}}self.setCityId(cityId);container.get("event_dispatcher").publish("cityId:change");container.get("event_dispatcher").publish("modelId:update");container.get("event_dispatcher").publish("variantId:update");container.get("event_dispatcher").publish("showroomId:update");container.get("event_dispatcher").publish("price:update")})}},getCitiesWithModelPricesPromise:function(){var brandId=this.getBrandId();var modelId=this.getModelId();return container.get("data_proxy_service").getDataProxy().loadPremiumDealerWithOffersAndPriceCities(brandId,modelId)},updateTestDriveOffer:function(modelId,cityId){var self=this;container.get("data_proxy_service").getDataProxy().loadTestDriveOffer(modelId,cityId).done(function(data){self.getAfterPriceBlock().html(data);self.termConditionsAccordion()})},termConditionsAccordion:function(){if(container.get("mobile_detect").mobile()){$("[data-tc-btn]").on("click",function(){$(this).parent().find("[data-tc-body]").slideToggle()})}},onUpdateShowroom:function(cityId){var self=this;var brandId=this.getBrandId();var modelId=this.getModelId();var requestType=this.getRequestType();if(this.previousDealerBrandId==brandId&&this.previousDealerCityId==cityId&&this.previousShowroomRequestType==requestType){return false}this.previousDealerBrandId=brandId;this.previousDealerCityId=cityId;this.previousShowroomRequestType=requestType;var $dealerList=this.getDealerElement();$dealerList.children('[value!=""]').remove();$dealerList.attr("disabled",true);if(brandId&&cityId){var dealersUrl;if(this.isTestDriveRequest()){dealersUrl=this.dealersTestDriveUrl;this.updateTestDriveOffer(modelId,cityId)}else{dealersUrl=this.dealersUrl;self.getAfterPriceBlock().html("")}if(!dealersUrl){return}$.getJSON(dealersUrl,{city_id:cityId,brand_id:brandId,model_id:modelId},function(data){var options={};$.each(data,function(){if(!options.hasOwnProperty(this.dealer_name)){options[this.dealer_name]=$("<optgroup/>").attr("label",this.dealer_name)}var $option=$("<option/>").val(this.showroom_id).text(this.showroom_address).data("contact",this.dealer_contact_name).data("dealerName",this.dealer_name).data("dealerId",this.showroom_dealer_id);options[this.dealer_name].append($option)});$dealerList.find('option[value!=""], optgroup').remove();for(var index in options){$dealerList.append(options[index])}if($dealerList.children('[value!=""]').size()>0){$dealerList.attr("disabled",false)}self.unsetDealerId();self.unsetShowroomId()})}},onUpdatePrice:function(){try{var self=this;this.loadPrices(this.getCityId(),this.getModelId(),function(variants){var prices=[];for(var i in variants){prices.push(variants[i].min)}var $city=self.$form.find("span[data-type=cityPrice]");var $price=self.$form.find("span[data-type=price]");var priceData=self.formatPrice(self.formatRawPrice(Math.min.apply(null,prices),Math.max.apply(null,prices)));$city.text(self.getCityListLabel()||container.get("city_detect").getCityName());$price.html(priceData)})}catch(e){}},formatPrice:function(price){var result="";if(typeof price.min!=="undefined"&&price.max!=="undefined"){if(price.min.money==price.max.money&&price.min.sym==price.max.sym){return this.formatPrice(price.min)}if(price.min.money!=price.max.money&&price.min.sym==price.max.sym){result=price.min.money+" - "+price.max.money+" "+price.min.sym}else{result=price.min.money+" "+price.min.sym+" - "+price.max.money+" "+price.max.sym}}else if(typeof price.money!=="undefined"){result=price.money+" "+price.sym}return result},formatPriceNum:function(num){var lac=1e5,cr=1e7,currencySymbol="",currencyDivider=1,price={};if(num>=lac){currencySymbol=num>=cr?"Cr":"Lakh";currencyDivider=num>=cr?cr:lac;price={money:Math.round(num*100/currencyDivider)/100,sym:currencySymbol}}else{price={money:num,sym:""}}return price},formatRawPrice:function(price_min,price_max){var price={};if(parseInt(price_min)<parseInt(price_max)){price={min:this.formatPriceNum(price_min),max:this.formatPriceNum(price_max)}}else{price=this.formatPriceNum(price_min)}return price},updateUserInfo:function(){var userInfoService=container.get("user_info_service");userInfoService.setName(this.getName());userInfoService.setEmail(this.getEmail());userInfoService.setPhone(this.getPhone());userInfoService.setLocation(this.modelSelectLocation);userInfoService.saveClientId()},onSubmit:function(){this.onCloseAnalyticsTracking=false;this.lockForm();this.hideOtpErrorMsq();this.updateUserInfo();this.setRequestPriority(this.getModelId());var leadData=this.bookTestDrive.buildLead();this.onSubmitPushGtmData(leadData);this.$form.addClass("busy");container.get("lead_submit.service").submit(this.$form.attr("action"),this.bookTestDrive.buildLead(),"json").then(this.onSubmitCallback.bind(this))},onSubmitCallback:function(data){this.$form.removeClass("busy");if(typeof data.leadId!=="undefined"){this.saveLeadId(data.leadId)}if(data.tyMessage){this.updateTyMessage(data.tyMessage)}if(data.errors){this.onCloseAnalyticsTracking=true;this.unlockForm();$.each(data.errors,function(idx,field){this.getErrorBlock(field).removeClass(this.validateOptions["validClass"]).addClass(this.validateOptions["errorClass"])}.bind(this))}else if(data.status=="not_verified"&&this.smsVerifyForm){this.gtmService.pushData({event:this.gtmPrefix+"_Lead_Saved"});
this.smsVerifyForm.start(this.getPhone(),this.getName());this.$document.find("body").removeAttr("style")}else if(data.status==="error"){this.onCloseAnalyticsTracking=true;this.unlockForm();this.notificationService.alert(data.message)}else{this.onCloseAnalyticsTracking=false;this.gtmService.pushData({event:this.gtmPrefix+"_Lead_Saved"});this.gtmService.pushData({event:this.gtmPrefix+"_Lead_Verified_Saved"});this.requestPopUp.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.requestPopUp.close();this.trackGa();this.showSuccessMessage()}},trackGa:function(){var gaCategory=this.getTrackeventCategory();switch(true){case this.isTestDriveRequest():this.ga.sendEvent(gaCategory,"TestDrive lead saved",this.getTrackeventLabel());break;case this.isBookingRequest():this.ga.sendEvent(gaCategory,"Booking lead saved",this.getTrackeventLabel());break;default:this.ga.sendEvent(gaCategory,"BookingModel_Form-"+this.getRequestType()+"-button",(this.isGopResult?"GOPResult ":"")+this.getTrackeventLabel())}},updateTyMessage:function(message){var $tyBlock=this.getTyMessage();$tyBlock.find('[data-type="userMessage"]').html(message)},onSubmitPushGtmData:function(leadData){var $selectedDealer=this.getDealerElement().find(":selected"),$selectedVariant=this.getVariantElement().find(":selected");leadData.showroomName=$selectedDealer.parent().prop("label");leadData.showroomAddress=$selectedDealer.text();leadData.cityName=this.getCityListLabel();leadData.variantId=leadData.variant_id;leadData.variantName=$selectedVariant.text();if(this.isBookingRequest()){container.get("event_dispatcher").publish("ModelPage:Booking_Submit",leadData)}else{container.get("event_dispatcher").publish("ModelPage:TestDrive_Submit",leadData)}},onFailSmsVerify:function(event){this.lockForm();this.showOtpErrorMsq()},showOtpErrorMsq:function(){this.smsVerifyForm.$form.find("[data-action=invalidOtp]").show()},hideOtpErrorMsq:function(){this.smsVerifyForm.$form.find("[data-action=invalidOtp]").hide()},saveLeadId:function(leadId){this.leadId=leadId;var storage=new Storages.CookieStorage;storage.set("GopLeadId",leadId);try{container.get("binding").get("leadId").set(leadId)}catch(e){}},setRequestPriority:function(modelId){var gopFilled=[];var requestPriority="WARM";if($.cookie("gop_filled")){gopFilled=JSON.parse($.cookie("gop_filled"))}$.each(gopFilled,function(index,elem){if(elem==modelId){requestPriority="HOT"}});if(container.get("binding").has("requestPriority")){container.get("binding").get("requestPriority").set(requestPriority)}},onAfterCityInitialize:function(event,city){this.userCity=city.cityId},onSmsSuccessVerify:function(event){this.onCloseAnalyticsTracking=false;this.unlockForm();if(this.isTestDriveRequest()||this.isBookingRequest()||this.isAppointmentRequest()){this.gtmService.pushData({event:this.gtmPrefix+"_Lead_Verified_Saved_New"});this.trackGa();this.smsVerifyForm.hide();this.showSuccessMessage()}},showSuccessMessage:function(){this.$offerBlock.hide();this.requestPopUp.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.requestPopUp.close();var $tyBlock=this.getTyMessage();this.updateTyMessageCarLink();var popupService=container.get("popup_service");if(popupService.getActivePopup()){var popup=popupService.getActivePopup();popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);popup.close()}popupService.showPopup(this.getTyPopupId())},updateTyMessageCarLink:function(){var variantName;var variantPath;var $tyBlock=this.getTyMessage();if(this.isBookingRequest()||this.variantSelectable){var $selected=this.getVariantSelect().find("option:selected");if($selected.val()){variantName=$selected.data("variantName")||$selected.text();variantPath=$selected.data("path");$tyBlock.find('span[data-type="ty-variant"]').html(variantName)}}if($tyBlock.find("[data-car-link]")){var $link=$tyBlock.find("[data-car-link]");var originalLink=$link.data("original");if(variantPath){$link.attr("href",originalLink+variantPath+".html")}else{$link.attr("href",originalLink)}}},getRequestTitle:function(){switch(true){case this.isTestDriveRequest():return"Test Drive";case this.isBookingRequest():return"Booking";case this.isAppointmentRequest():return"Appointment";default:return"***"}},getTyPopupId:function(){return"thank-you-popup"},getForm:function(){return $("#booking_form")},getTyMessage:function(){return $("#thank_you_message")},getErrorBlock:function(fieldName){return this.$form.find('[data-error-name="'+fieldName+'"]')},getVariantSelect:function(){return this.$form.find('select[data-type="variant"]')},getAfterPriceBlock:function(){return this.$form.find('[data-type="afterPriceBlock"]')},getGopVariantField:function(){return this.getGopPopupForm().find('input[data-type="variant"]')},getGopPopupForm:function(){return $("#popup_gop_form")},getGopShowButton:function(){return this.$document.find('[data-type="gop_button"]')},GopButtonEventListeners:function(){var self=this;self.getGopShowButton().click(function(e){e.preventDefault();var $selected=jQuery(this);if(!$selected.hasClass("disabled")){window.currentRequest="GOP";self.updateFromDataset(this.dataset);self.setRequestType(window.currentRequest);var variantId=jQuery(this).attr("data-variant-id");if(variantId>0){self.getVariantSelect().val(variantId)}self.getGopVariantField().val(variantId?variantId:"");self.$offerBlock.hide();self.getGopPopupForm().find('[data-type="brand-model-title"]').html(this.dataset.title);self.getGopPopupForm().find("form").attr("action",this.dataset.action);self.getGopPopupForm().find(".change_phone").attr("data-trackevent-category","GOP Request").attr("data-trackevent-label",this.dataset.title);self.gopPopUp.open()}})},toggleRequestButton:function(){var self=this;if(!this.checkModelDealersUrl){return}jQuery.getJSON(this.checkModelDealersUrl,function(data){if(data.result==true){self.$mainBlock.show()}})},getGtmPrefix:function(){switch(true){case this.isTestDriveRequest():return"TD";case this.isBookingRequest():return"BK";case this.isAppointmentRequest():return"AP";default:return"**"}},getGaPrefix:function(){return this.getGtmPrefix()},setGtmPrefix:function(){this.gtmPrefix=this.getGtmPrefix()},disableSubmitButton:function(){this.$form.find(":submit").prop("disabled",true)},enableSubmitButton:function(){if(this.lockSubmitButton){return}this.$form.find(":submit").prop("disabled",false)},getPriceMin:function(){var $elem;if(this.isTestDriveRequest()){return this.getCityPriceMin()}else if(this.isAppointmentRequest()){return this.getCityPriceMin()}else if(this.isBookingRequest()){$elem=this.getVariantElement().children("option:selected").first()}else{$elem=$(document)}return $elem.data("priceMin")},getPriceMax:function(){if(this.isTestDriveRequest()){return this.getCityPriceMax()}else if(this.isAppointmentRequest()){return this.getCityPriceMax()}else if(this.isBookingRequest()){$elem=this.getVariantElement().children("option:selected").first()}else{$elem=$(document)}return $elem.data("priceMax")},getFirstCityListItemValue:function(){return this.getCityElement().children('[value!=""]').first().val()},getCityListLabel:function(){var name=this.modelSelectLocation.getSelectLocality().getSelectedValue();if(!name){return false}if(-1!==name.indexOf(",")){return name.substring(0,name.indexOf(","))}else{return name}},isCityListEmpty:function(){return this.getCityElement().children('[value!=""]').size()===0},enableCityList:function(){this.getCityElement().attr("disabled",false)},disableCityList:function(){this.getCityElement().attr("disabled",true)},cleanCityList:function(){this.getCityElement().children('[value!=""]').remove()},renderCityList:function(data){var $cityList=this.getCityElement();this.cleanCityList();$.each(data,function(idx,item){var $item=this.buildCityListItem(item);$cityList.append($item)}.bind(this))},buildCityListItem:function(data){var $item=$("<option/>");$item.val(data.value);$item.text(data.label);$item.attr(data.attrs);if(typeof data.disabled!=="undefined"){$item.attr("disabled",true)}return $item},getCityPriceMin:function(){var $selectedItem=this.getCityElement().children("option:selected").first();return $selectedItem.data("priceMin")},getCityPriceMax:function(){var $selectedItem=this.getCityElement().children("option:selected").first();return $selectedItem.data("priceMax")},loadPrices:function(cityId,modelId,callback){container.get("data_proxy_service").getDataProxy().loadModelVariantWithPrices(this.getModelId(),cityId).done(function(variants){callback(variants)})},onRequestPopupClose:function(popup){if(!this.onCloseAnalyticsTracking){return}var title=this.getTitle();if(this.isBookingRequest()){this.analyticsUserBehavior.onBookingPopUpClose(title)}if(this.isTestDriveRequest()){this.analyticsUserBehavior.onTestDrivePopUpClose(title)}},trackFieldsInteraction:function(){this.$form.on("keydown input change",function(event){var $element=$(event.target);this.trackElementChanges($element)}.bind(this))},trackElementChanges:function($element){if(this.isTestDriveRequest()){var name=this.getAnalyticsCanonicalName($element,this.analyticsInteractionCanonicalTestDriveMap);this.analyticsUserBehavior.registerTestDriveElementChanged(name)}if(this.isBookingRequest()){var name=this.getAnalyticsCanonicalName($element,this.analyticsInteractionCanonicalBookingMap);this.analyticsUserBehavior.registerBookingElementChanged(name)}},getFormFieldsStateDto:function(map){var dto={},formFields=this.$form.find(":input"),self=this,UserInfoService=container.get("user_info_service");$.each(formFields,function(){var $element=$(this),nameProperty=$element.attr("name");if(!nameProperty){nameProperty=$element.data("canonicalName")}if(map.hasOwnProperty(nameProperty)){var empty=!Boolean($element.val()),name=map[nameProperty];if(name==="City"){empty=!Boolean(UserInfoService.getLocation().getCityId())}if(!dto.hasOwnProperty(name)){dto[name]={name:name,empty:empty}}}});return dto},getAnalyticsCanonicalName:function($element,map){var nameProperty=$element.attr("name");if(!nameProperty){nameProperty=$element.data("canonicalName")}if(map.hasOwnProperty(nameProperty)){return map[nameProperty]}return null},setAnalyticsInteractionBuffer:function(){var isVisible=this.$form.is(":visible");if(this.isBookingRequest()&&isVisible){var dto=this.getFormFieldsStateDto(this.analyticsInteractionCanonicalBookingMap);this.analyticsUserBehavior.setBookingFormInteractionBuffer(dto)}if(this.isTestDriveRequest()&&isVisible){var dto=this.getFormFieldsStateDto(this.analyticsInteractionCanonicalTestDriveMap);this.analyticsUserBehavior.setTestDriveFormInteractionBuffer(dto)}},updateAnalyticsInteractionBuffer:function(){if(this.isBookingRequest()){var dto=this.getFormFieldsStateDto(this.analyticsInteractionCanonicalBookingMap);this.analyticsUserBehavior.eraseBookingFormInteractionBuffer();this.analyticsUserBehavior.setBookingFormInteractionBuffer(dto)}if(this.isTestDriveRequest()){var dto=this.getFormFieldsStateDto(this.analyticsInteractionCanonicalTestDriveMap);this.analyticsUserBehavior.eraseTestDriveFormInteractionBuffer();this.analyticsUserBehavior.setTestDriveFormInteractionBuffer(dto)}}}};
var AP;(function(AP){var Entity=function(){function Entity(value){this.callbacks=$.Callbacks();this.value=value}Entity.prototype.set=function(value){if(this.value!==value){var oldValue=this.value;this.value=value;this.update(oldValue)}return this};Entity.prototype.update=function(oldValue){this.callbacks.fire(oldValue)};Entity.prototype.get=function(){return this.value};Entity.prototype.addCallback=function(callback){this.callbacks.add(callback)};Entity.prototype.toString=function(){return JSON.stringify(this.value)};return Entity}();AP.Entity=Entity})(AP||(AP={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Gop;(function(Gop){var GopView=function(_super){__extends(GopView,_super);function GopView(){return _super!==null&&_super.apply(this,arguments)||this}GopView.prototype.getForm=function(){return this.$form};GopView.prototype.getFormRow=function(){return this.$form.parents(".row")};GopView.prototype.getFormAction=function(){return this.getForm().attr("action")};GopView.prototype.setFormAction=function(action){this.getForm().attr("action",action)};GopView.prototype.getBrandDom=function(){return this.$form.find('[name="brand"]')};GopView.prototype.getBrandId=function(){return this.getBrandDom().val()};GopView.prototype.getBrandPath=function(){return this.getBrandDom().find(":selected").data("brandPath")};GopView.prototype.getModelDom=function(){return this.$form.find('[name="model"]')};GopView.prototype.getModelId=function(){return this.getModelDom().val()};GopView.prototype.getUserNameDom=function(){return this.$form.find('[name="name"]')};GopView.prototype.getUserName=function(){return this.getUserNameDom().val()};GopView.prototype.setUserName=function(value){return this.getUserNameDom().val(value)};GopView.prototype.getUserPhoneDom=function(){return this.$form.find('[name="phone"]')};GopView.prototype.getUserPhone=function(){return this.getUserPhoneDom().val()};GopView.prototype.setUserPhone=function(phone){this.getUserPhoneDom().val(phone)};GopView.prototype.getCityDom=function(){return this.$form.find('[name="city"]')};GopView.prototype.getCityName=function(){return this.getCityDom().find(":selected").text()};GopView.prototype.getPostCodeDom=function(){return this.$form.find('[name="postcode"]')};GopView.prototype.getPostCode=function(){return this.getPostCodeDom().val()};GopView.prototype.getSbiAugustValue=function(){return this.getSbiAugustDom().is(":checked")};GopView.prototype.getSbiAugustDom=function(){return this.$form.find('[name="sbi_august"]')};GopView.prototype.getNeedAssistanceDom=function(){return this.$form.find('[name="car_loan"]')};GopView.prototype.getNeedAssistance=function(){return this.getNeedAssistanceDom().is(":checked")};GopView.prototype.getVariantIdInput=function(){return this.$form.find('[name="variant_id"]')};GopView.prototype.getVariantId=function(){return this.getVariantIdInput().val()};GopView.prototype.setVariantId=function(id){this.getVariantIdInput().val(id)};GopView.prototype.getVariantNameInput=function(){return this.$form.find('[name="variant_name"]')};GopView.prototype.getVariantName=function(){return this.getVariantNameInput().val()};GopView.prototype.getPartnerIdDom=function(){return this.$form.find('[name="partner_id"]')};GopView.prototype.getPartnerId=function(){return this.getPartnerIdDom().val()};GopView.prototype.getPurchaseDateDom=function(){return this.$form.find('[name="purchaseDate"]')};GopView.prototype.getPurchaseDate=function(){return this.getPurchaseDateDom().val()};GopView.prototype.getInsuranceBlock=function(){return this.$form.find('[data-type="insurance-checkbox-block"]')};GopView.prototype.getInsuranceDom=function(){return this.$form.find('[data-type="insurance-checkbox"]')};GopView.prototype.getInsurance=function(){return this.$form.find('[data-type="insurance-checkbox"]').prop("checked")};GopView.prototype.setPurchaseDate=function(value){return this.getPurchaseDateDom().val(value)};GopView.prototype.getSubmitButton=function(){return this.$form.find('[type="submit"]')};GopView.prototype.disableSubmit=function(){this.getSubmitButton().attr("disabled","disabled")};GopView.prototype.enableSubmit=function(){this.getSubmitButton().removeAttr("disabled")};return GopView}(General.FormView);Gop.GopView=GopView})(Gop||(Gop={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Gop;(function(Gop){var BUFFER_INTERACTION_MAP="analyticsInteractionCanonicalMap";var ModelGopView=function(_super){__extends(ModelGopView,_super);function ModelGopView($form,dataProxyService,cityService,userInfoService,isMobile,ga){var _this=_super.call(this,$form)||this;_this.analyticsCanonicalMap={name:"username",phone:"phone",purchaseDate:"purchase",gop_type_address:"address",shortGopLocality:"address",brand:"brand",model:"model"};_this.analyticsInteractionCanonicalMap={name:"Name",phone:"Phone",purchaseDate:"When Buy",gop_type_address:"City",shortGopLocality:"City"};_this.isMobile=Boolean(isMobile);_this.dataProxy=dataProxyService.getDataProxy();_this.modelId="";_this.brandId="";_this.cityService=cityService;_this.userInfoService=userInfoService;_this.ga=ga;_this._onBrandChanged=$.Callbacks();_this._onModelChanged=$.Callbacks();_this.initUserInfo();_this.initLocationView();_this.addListeners();return _this}ModelGopView.prototype.onBrandChanged=function(callback){this._onBrandChanged.add(callback)};ModelGopView.prototype.onModelChanged=function(callback){this._onModelChanged.add(callback)};ModelGopView.prototype.getLocationView=function(){return this.selectLocationView};ModelGopView.prototype.addListeners=function(){this.getModelDom().on("change",this.onModelChange.bind(this));this.getBrandDom().on("change",this.onBrandChange.bind(this));this.getBrandDom().on("change",this.updateInsuranceCheckbox.bind(this));this.getForm().on("autoportal.gop-form.popup.show",this.updateLocation.bind(this));if(!this.isMobile){this.getForm().on("autoportal.gop-form.popup.show",this.initModelInfo.bind(this))}};ModelGopView.prototype.updateLocation=function(){this.selectLocationView.restore(this.userInfoService.getLocation(),true)};ModelGopView.prototype.onModelChange=function(){var brandId=this.getBrandId();var modelId=this.getModelId();var $modelSelectedOption=this.getModelDom().find(":selected");if($modelSelectedOption.length){this.setModelName($modelSelectedOption.text().trim())}this.modelId=modelId||this.modelId;this._onModelChanged.fire(this.modelId);var $cityList=this.getCityDom();$cityList.children('[value!=""]').remove();$cityList.attr("disabled","disabled");var self=this;if(brandId&&modelId){this.dataProxy.loadCitiesWithModelPrices(brandId,modelId).done(function(data){$.each(data,function(idx,elem){$cityList.append($("<option/>").val(elem.id).text(elem.name))});$cityList.removeAttr("disabled");self.updateCityId()})}this.setTitle(this.getBrandName()+" "+this.getModelName())};ModelGopView.prototype.getCityId=function(){return this.selectLocationView.getCityId()};ModelGopView.prototype.getPostCode=function(){return this.selectLocationView.getPostCode()};ModelGopView.prototype.getLocalityId=function(){return this.selectLocationView.getLocalityId()};ModelGopView.prototype.onBrandChange=function(){var brandId=this.getBrandId();var catalogId=this.getCatalogId();var cityId=this.getCityId()||this.cityService.getCityId();if(this.brandId===brandId){return}var $brandSelectedOption=this.getBrandDom().find(":selected");if($brandSelectedOption.length){this.setBrandName($brandSelectedOption.text().trim())}this.brandId=brandId;this._onBrandChanged.fire(brandId);var $modelList=this.getModelDom();if($modelList.prop("tagName")!=="SELECT"){return}$modelList.children('[value!=""]').remove();$modelList.prop("disabled",true);var self=this;if(brandId&&cityId){this.dataProxy.loadBrandModelWithPrices(brandId,cityId,catalogId).done(function(data){$.each(data,function(idx,elem){$modelList.append($("<option/>").val(elem.id).text(elem.name).data("slug",elem.slug))});$modelList.removeAttr("disabled");self.updateModelId()})}};ModelGopView.prototype.updateCityId=function(){var cityId=this.cityService.getCityId();this.getCityDom().find('[value="'+cityId+'"]').attr("selected","selected")};ModelGopView.prototype.updateModelId=function(){this.getModelDom().val(this.modelId);this.getModelDom().trigger("change")};ModelGopView.prototype.setTitle=function(title){this.title=title};ModelGopView.prototype.getTitle=function(){return this.title};ModelGopView.prototype.setPartnerId=function(partnerId){this.partnerId=partnerId};ModelGopView.prototype.getPartnerId=function(){return this.partnerId};ModelGopView.prototype.getBrandDom=function(){return this.getForm().find('[name="brand"]')};ModelGopView.prototype.getModelDom=function(){return this.getForm().find('[name="model"]')};ModelGopView.prototype.getModelId=function(){return this.getModelDom().val()};ModelGopView.prototype.setModelId=function(modelId){this.modelId=modelId;this.getModelDom().val(modelId).trigger("change")};ModelGopView.prototype.getModelName=function(){return this.getForm().find('[name="modelName"]').val()};ModelGopView.prototype.setModelName=function(modelName){this.getForm().find('[name="modelName"]').val(modelName).trigger("change")};ModelGopView.prototype.getModelSlug=function(){return this.getForm().find('[name="modelSlug"]').val()};ModelGopView.prototype.setModelSlug=function(modelSlug){this.getForm().find('[name="modelSlug"]').val(modelSlug).trigger("change")};ModelGopView.prototype.getCatalogId=function(){return this.getForm().find('[name="catalogId"]').val()};ModelGopView.prototype.getBrandId=function(){return this.getForm().find('[name="brand"]').val()};ModelGopView.prototype.setBrandId=function(brandId){this.getForm().find('[name="brand"]').val(brandId).trigger("change")};ModelGopView.prototype.getBrandName=function(){return this.getForm().find('[name="brandName"]').val()};ModelGopView.prototype.setBrandName=function(brandName){this.getForm().find('[name="brandName"]').val(brandName).trigger("change")};ModelGopView.prototype.getBrandSlug=function(){return this.getForm().find('[name="brandSlug"]').val()};ModelGopView.prototype.setBrandSlug=function(brandSlug){this.getForm().find('[name="brandSlug"]').val(brandSlug).trigger("change")};ModelGopView.prototype.setTrackeventCategory=function(trackeventCategory){this.getSubmitButton().data("trackeventCategory",trackeventCategory)};ModelGopView.prototype.getTrackeventCategory=function(){return this.getSubmitButton().data("trackeventCategory")};ModelGopView.prototype.getLocation=function(){return this.selectLocationView.getSelectedValue()};ModelGopView.prototype.initUserInfo=function(){this.setUserPhone(this.userInfoService.getPhone());this.setUserName(this.userInfoService.getName());this.setEmail(this.userInfoService.getEmail())};ModelGopView.prototype.checkFormEmptyState=function(){return!(this.getUserPhone()||this.getUserName()||this.getLocation()||this.getPurchaseDate())};ModelGopView.prototype.initLocationView=function(){var _this=this;this.selectLocationView=new Forms.SelectLocationView(this);var locationCityInput=this.selectLocationView.getSelectLocality().getLocationSearch().getCityInputDom();locationCityInput.on("autoportal:location-search:selected",function(){locationCityInput.blur()});locationCityInput.on("autoportal:location-search:selected autoportal:location-search:set-selected",this.updateInsuranceCheckbox.bind(this));this.selectLocationView.addParameter("model",function(){return _this.getModelId()})};ModelGopView.prototype.showAigEvent=function(category,label){this.ga.sendEvent(category,"AIG unchecked default",label)};ModelGopView.prototype.updateInsuranceCheckbox=function(){var _this=this;var cityId=this.selectLocationView.getCityId();var brandId=Number(this.getBrandId());if(!cityId||!brandId){this.getInsuranceBlock().hide();this.getInsuranceDom().prop("checked",false);return}this.dataProxy.loadAigInsuranceAvailability(cityId,brandId).done(function(aigInsuranceAvailable){if(aigInsuranceAvailable){_this.getInsuranceBlock().show();_this.getInsuranceDom().prop("checked",false);_this.showAigEvent(_this.getTrackeventCategory(),_this.getTitle())}else{_this.getInsuranceBlock().hide();_this.getInsuranceDom().prop("checked",false)}})};ModelGopView.prototype.getAnalyticsCanonicalName=function($element,mapName){if(mapName===void 0){mapName=""}var nameProperty=$element.attr("name");var map=this.analyticsCanonicalMap;if(mapName===BUFFER_INTERACTION_MAP){map=this.analyticsInteractionCanonicalMap}if(map.hasOwnProperty(nameProperty)){return map[nameProperty]}return null};ModelGopView.prototype.getFormFieldsStateDto=function(){var dto={};var formFields=this.$form.find(":input").serializeArray();for(var key in formFields){var fieldName=formFields[key].name;if(this.analyticsInteractionCanonicalMap.hasOwnProperty(fieldName)){var empty=!Boolean(formFields[key].value);var name_1=this.analyticsInteractionCanonicalMap[fieldName];if(name_1==="City"){empty=!Boolean(this.userInfoService.getLocation().getCityId())}if(!dto.hasOwnProperty(name_1)){dto[name_1]={name:name_1,empty:empty}}}}return dto};ModelGopView.prototype.isFormVisible=function(){return this.$form.is(":visible")};ModelGopView.prototype.initModelInfo=function(){var model=new Gop.ModelInfoModel(this,this.dataProxy);var view=new Gop.ModelInfoView(this);this.getForm().off("autoportal.gop-form.model-info.data-received");this.getForm().on("autoportal.gop-form.model-info.data-received",function(event,data){view.render(model.getContext(data))}.bind(this));model.requestContext()};ModelGopView.prototype.showEmail=function(){this.getEmailBlock().removeClass("d_n")};ModelGopView.prototype.hideEmail=function(){this.getEmailBlock().addClass("d_n")};ModelGopView.prototype.getEmailBlock=function(){return this.find('[data-block="email"]')};ModelGopView.prototype.getEmailDom=function(){return this.getEmailBlock().find('[name="email"]')};ModelGopView.prototype.getEmail=function(){if(this.getEmailBlock()){return this.getEmailDom().val()}return""};ModelGopView.prototype.setEmail=function(value){if(this.getEmailBlock()){this.getEmailDom().val(value)}};ModelGopView.prototype.setVWLabelValue=function(value){this.getVWCheckBoxBlock().find("label").text(value)};ModelGopView.prototype.showVWCheckBox=function(){this.getVWCheckBoxBlock().removeClass("d_n")};ModelGopView.prototype.hideVWCheckBox=function(){this.getVWCheckBoxBlock().addClass("d_n")};ModelGopView.prototype.getVWCheckBoxBlock=function(){return this.find('[data-block="vw_checkbox"]')};ModelGopView.prototype.getVWCheckBoxDom=function(){return this.getVWCheckBoxBlock().find('[name="vw_checkbox"]')};ModelGopView.prototype.getVwCpl=function(){if(this.getVWCheckBoxBlock()){return this.getVWCheckBoxDom().is(":checked")}return false};ModelGopView.prototype.showSkipSmsVerification=function(){this.getSmsSkip().removeClass("d_n")};ModelGopView.prototype.hideSkipSmsVerification=function(){this.getSmsSkip().addClass("d_n")};ModelGopView.prototype.getSmsSkip=function(){return this.$form.find('[data-block="skip-block"]')};ModelGopView.prototype.showLibertyInsurance=function(){this.getLibertyInsuranceDom().removeClass("d_n")};ModelGopView.prototype.hideLibertyInshurance=function(){this.getLibertyInsuranceDom().addClass("d_n")};ModelGopView.prototype.getLibertyInsuranceDom=function(){return this.$form.find('[data-block="liberty_insurance"]')};ModelGopView.prototype.getLibertyInsurance=function(){if(this.getLibertyInsuranceDom()){return this.getLibertyInsuranceElement().is(":checked")}return false};ModelGopView.prototype.getLibertyInsuranceElement=function(){return this.getLibertyInsuranceDom().find('[name="liberty_insurance"]')};ModelGopView.prototype.setModelBodyType=function(bodyType){this.getForm().data("modelBodyType",bodyType)};ModelGopView.prototype.getModelBodyType=function(){return this.getForm().data("modelBodyType")||""};ModelGopView.prototype.setModelPriceRange=function(priceRange){this.getForm().data("modelPriceRange",priceRange)};ModelGopView.prototype.getModelPriceRange=function(){return this.getForm().data("modelPriceRange")||""};return ModelGopView}(Gop.GopView);Gop.ModelGopView=ModelGopView})(Gop||(Gop={}));;
var Gop;(function(Gop){var ModelInfoView=function(){function ModelInfoView(mainView){this.mainView=mainView}ModelInfoView.prototype.render=function(context){var $container=this.getContainer();$container.empty();this.getTemplate().tmpl({context:context}).appendTo($container);this.initColorsGallery()};ModelInfoView.prototype.initColorsGallery=function(){var $colorsContainer=this.getGalleryContainer();if(!$colorsContainer.length){return}new ColorsGallery($colorsContainer).init()};ModelInfoView.prototype.getTemplate=function(){return $("#template-gop-model-info")};ModelInfoView.prototype.getContainer=function(){return this.mainView.getFormRow().find("[data-model-info-container]")};ModelInfoView.prototype.getGalleryContainer=function(){return this.mainView.getFormRow().find("[data-model-info-gallery-container]")};return ModelInfoView}();Gop.ModelInfoView=ModelInfoView})(Gop||(Gop={}));;
var Gop;(function(Gop){var ModelInfoModel=function(){function ModelInfoModel(mainView,dataProxy){this.mainView=mainView;this.dataProxy=dataProxy}ModelInfoModel.prototype.requestContext=function(){var _this=this;var modelId=this.mainView.getModelId();var variantId=this.mainView.getVariantId();this.dataProxy.loadGopCarInfo(modelId,variantId).done(function(data){_this.mainView.getForm().trigger("autoportal.gop-form.model-info.data-received",data)})};ModelInfoModel.prototype.getContext=function(colorsFeaturesData){var context=this.createContext();context.carTitle=this.mainView.getTitle();context.thumbnail=colorsFeaturesData.thumbnail;if(!this.isValidGopCarInfoData(colorsFeaturesData)){throw new Error("Invalid colors and features data!")}context.colors=this.getColorsFromData(colorsFeaturesData.colors);context.features=this.getKeyFeaturesFromData(colorsFeaturesData.keyFeatures);return context};ModelInfoModel.prototype.createContext=function(){return new Gop.ModelInfoContext};ModelInfoModel.prototype.createColor=function(){return new Gop.ModelInfoColor};ModelInfoModel.prototype.createKeyFeature=function(){return new Gop.ModelInfoKeyFeature};ModelInfoModel.prototype.getColorsFromData=function(colorsData){var colors=[];for(var colorDataKey in colorsData){var color=this.createColor();var colorData=colorsData[colorDataKey];if(!this.isValidColorData(colorData)){throw new Error("Invalid colors data!")}color.hex=colorData.model_color_hex;color.id=colorData.model_color_id;color.name=colorData.model_color_name;color.image=colorData.model_color_img;colors.push(color)}return colors};ModelInfoModel.prototype.getKeyFeaturesFromData=function(data){var features=[];for(var key in data){var feature=this.createKeyFeature();var featureData=data[key];if(!this.isValidKeyFeatureData(featureData)){throw new Error("Invalid colors data!")}feature.title=featureData.title;features.push(feature)}return features};ModelInfoModel.prototype.isValidGopCarInfoData=function(data){if(!data.hasOwnProperty("thumbnail")||!data.hasOwnProperty("colors")||!data.hasOwnProperty("keyFeatures")){return false}return true};ModelInfoModel.prototype.isValidColorData=function(colorData){if(!colorData.hasOwnProperty("model_color_id")||!colorData.hasOwnProperty("model_color_name")||!colorData.hasOwnProperty("model_color_img")||!colorData.hasOwnProperty("model_color_hex")){return false}return true};ModelInfoModel.prototype.isValidKeyFeatureData=function(data){if(!data.hasOwnProperty("title")){return false}return true};return ModelInfoModel}();Gop.ModelInfoModel=ModelInfoModel})(Gop||(Gop={}));;
var Gop;(function(Gop){var ModelInfoContext=function(){function ModelInfoContext(){}Object.defineProperty(ModelInfoContext.prototype,"colors",{get:function(){return this._colors},set:function(value){this._colors=value},enumerable:true,configurable:true});Object.defineProperty(ModelInfoContext.prototype,"carTitle",{get:function(){return this._carTitle},set:function(value){this._carTitle=value},enumerable:true,configurable:true});Object.defineProperty(ModelInfoContext.prototype,"thumbnail",{get:function(){return this._thumbnail},set:function(value){this._thumbnail=value},enumerable:true,configurable:true});Object.defineProperty(ModelInfoContext.prototype,"features",{get:function(){return this._features},set:function(value){this._features=value},enumerable:true,configurable:true});return ModelInfoContext}();Gop.ModelInfoContext=ModelInfoContext})(Gop||(Gop={}));;
var Gop;(function(Gop){var ModelInfoColor=function(){function ModelInfoColor(){}Object.defineProperty(ModelInfoColor.prototype,"hex",{get:function(){return this._hex},set:function(value){this._hex=value},enumerable:true,configurable:true});Object.defineProperty(ModelInfoColor.prototype,"id",{get:function(){return this._id},set:function(value){this._id=value},enumerable:true,configurable:true});Object.defineProperty(ModelInfoColor.prototype,"name",{get:function(){return this._name},set:function(value){this._name=value},enumerable:true,configurable:true});Object.defineProperty(ModelInfoColor.prototype,"image",{get:function(){return this._image},set:function(value){this._image=value},enumerable:true,configurable:true});return ModelInfoColor}();Gop.ModelInfoColor=ModelInfoColor})(Gop||(Gop={}));;
var Gop;(function(Gop){var ModelInfoKeyFeature=function(){function ModelInfoKeyFeature(){}Object.defineProperty(ModelInfoKeyFeature.prototype,"title",{get:function(){return this._title},set:function(value){this._title=value},enumerable:true,configurable:true});return ModelInfoKeyFeature}();Gop.ModelInfoKeyFeature=ModelInfoKeyFeature})(Gop||(Gop={}));;
var Gop;(function(Gop){var CookieStorage=Storages.CookieStorage;var GopRequestStatus;(function(GopRequestStatus){GopRequestStatus[GopRequestStatus["STATUS_VERIFY_FAIL"]=10]="STATUS_VERIFY_FAIL";GopRequestStatus[GopRequestStatus["STATUS_OK"]=4]="STATUS_OK";GopRequestStatus[GopRequestStatus["STATUS_ERROR"]=2]="STATUS_ERROR";GopRequestStatus[GopRequestStatus["ERROR"]="error"]="ERROR"})(GopRequestStatus=Gop.GopRequestStatus||(Gop.GopRequestStatus={}));var GopModel=function(){function GopModel(view,leadSubmitService){this.view=view;this._beforeSubmit=$.Callbacks();this._afterSubmit=$.Callbacks();this._onSubmit=$.Callbacks();this._beforeRedirect=$.Callbacks();this.submitionCanceled=false;this.link="";this.leadSubmitService=leadSubmitService;this.addListeners()}GopModel.prototype.updateVariantId=function(dataset){if(this.view.getVariantIdInput().length){if(dataset.variantId){this.view.setVariantId(dataset.variantId)}else{this.view.setVariantId("")}}};GopModel.prototype.getView=function(){return this.view};GopModel.prototype.addListeners=function(){this.view.getForm().on("submit",this.onSubmit.bind(this))};GopModel.prototype.beforeSubmit=function(callback){this._beforeSubmit.add(callback)};GopModel.prototype.afterSubmit=function(callback){this._afterSubmit.add(callback)};GopModel.prototype.onFormSubmit=function(callback){this._onSubmit.add(callback)};GopModel.prototype.beforeRedirect=function(callback){this._beforeRedirect.add(callback)};GopModel.prototype.cancelSubmit=function(){this.submitionCanceled=true};GopModel.prototype.getGtmData=function(){return this.buildLead()};GopModel.prototype.onSubmit=function(event){event.preventDefault();this._beforeSubmit.fire(this);if(!this.submitionCanceled){this.submit(this.buildLead())}this.submitionCanceled=false};GopModel.prototype.submit=function(lead){var _this=this;this._onSubmit.fire(this);this.leadSubmitService.submit(this.view.getFormAction(),lead,"json").then(function(response){_this.handleResponse(response);_this._afterSubmit.fire(response,_this)})};GopModel.prototype.doRedirect=function(){this.view.disableSubmit();this._beforeRedirect.fire(this);var redirectLink=this.getRedirectLink();if(redirectLink){Helpers.RedirectHelper.redirect(redirectLink,this.getRedirectType())}};GopModel.prototype.getRedirectType=function(){return Helpers.RedirectType.CURRENT_TAB};GopModel.prototype.getRedirectLink=function(){return this.link};GopModel.prototype.handleResponse=function(response){switch(response.status){case Gop.GopRequestStatus.STATUS_VERIFY_FAIL:case Gop.GopRequestStatus.STATUS_OK:this.link=response.data;var storage=new CookieStorage;storage.set("GopLeadId",response.leadId);break}};GopModel.prototype.buildLead=function(){var lead=this.createLead();return lead.build(this.view)};GopModel.prototype.createLead=function(){return new Leads.GopLead};return GopModel}();Gop.GopModel=GopModel})(Gop||(Gop={}));;
var General;(function(General){var Pixel=function(){function Pixel(){this.storage=new Storages.CookieStorage}Pixel.prototype.send=function(){var $element=this.createElement();$element.attr("src",this.sourceBuilder());$element.appendTo("body");return $element};Pixel.prototype.createElement=function(){var $element=$("<"+this.elementType+"/>");$element.width(1);$element.height(1);return $element};return Pixel}();General.Pixel=Pixel})(General||(General={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var General;(function(General){var OfferstrackPixel=function(_super){__extends(OfferstrackPixel,_super);function OfferstrackPixel(){var _this=_super.call(this)||this;_this.elementType="img";return _this}OfferstrackPixel.prototype.criteria=function(){return this.storage.get("utm_source")=="mangomedia"&&this.storage.get("utm_campaign")=="cpl"};OfferstrackPixel.prototype.sourceBuilder=function(){return"https://mango.offerstrack.net/pixelBack.php?offer_id=51&adv_id=39"};return OfferstrackPixel}(General.Pixel);General.OfferstrackPixel=OfferstrackPixel})(General||(General={}));;
var Gop;(function(Gop){var PixelTracking=function(){function PixelTracking(){this.pixels=[]}PixelTracking.prototype.add=function(pixel){this.pixels.push(pixel)};PixelTracking.prototype.track=function(callback){if(callback===void 0){callback=function(){}}var pixels=this.getTrackingPixels();this.trackPixels(pixels).done(callback)};PixelTracking.prototype.trackPixels=function(pixels){var loaded=0;var dfr=$.Deferred();if(pixels.length==0){dfr.resolve()}for(var i=0;i<pixels.length;i++){pixels[i].send().on("load",function(){loaded++;if(loaded==pixels.length){dfr.resolve()}})}return dfr.promise()};PixelTracking.prototype.getTrackingPixels=function(){var result=[];for(var i=0;i<this.pixels.length;i++){if(this.pixels[i].criteria()){result.push(this.pixels[i])}}return result};return PixelTracking}();Gop.PixelTracking=PixelTracking})(Gop||(Gop={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Gop;(function(Gop){var ModelGopModel=function(_super){__extends(ModelGopModel,_super);function ModelGopModel(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.redirectType=Helpers.RedirectType.CURRENT_TAB;return _this}ModelGopModel.prototype.updateByDataSet=function(dataset){this.view.setBrandName(dataset.brandName);this.view.setBrandSlug(dataset.brandSlug);this.view.setBrandId(dataset.brandId);this.view.setModelName(dataset.modelName);this.view.setModelSlug(dataset.modelSlug);this.view.setModelId(dataset.modelId);this.view.setTitle(dataset.title);this.view.setTrackeventCategory(dataset.trackeventCategory);this.view.setModelBodyType(dataset.bodyType);this.view.setModelPriceRange(dataset.priceRange);this.updateVariantId(dataset);this.setPartnerId(dataset.partnerId);this.updateRedirectType(dataset.redirectType)};ModelGopModel.prototype.updateRedirectType=function(redirectType){if(redirectType){this.redirectType=redirectType}};ModelGopModel.prototype.getRedirectType=function(){return this.redirectType};ModelGopModel.prototype.setPartnerId=function(partnerId){this.view.setPartnerId(partnerId)};return ModelGopModel}(Gop.GopModel);Gop.ModelGopModel=ModelGopModel})(Gop||(Gop={}));;
var Gop;(function(Gop){var ModelGopValidator=function(){function ModelGopValidator(view){this.view=view;this.errorsCount=0;this._onValid=$.Callbacks();this._onInvalid=$.Callbacks();this.onElementInvalidCallbacks=$.Callbacks();this.initValidation()}ModelGopValidator.prototype.onFormValid=function(callback){this._onValid.add(callback)};ModelGopValidator.prototype.onFormInvalid=function(callback){this._onInvalid.add(callback)};ModelGopValidator.prototype.onElementInvalid=function(callback){this.onElementInvalidCallbacks.add(callback)};ModelGopValidator.prototype.getMessages=function(){return{name:{autoportalName:"Please enter valid Name.",required:"Please enter Name."},model:"Please choose Model.",brand:"Please choose Brand.",city:"Please choose City.",purchaseDate:"Please choose Purchase Period.",phone:"Please enter valid Number.",postcode:"Please enter valid Pincode.",gop_type_address:"Please Enter Valid Location.",email:"Please enter valid Email."}};ModelGopValidator.prototype.getRules=function(){return{name:{required:true,autoportalName:true},postcode:{required:false,digits:true,minlength:6},model:"required",brand:"required",city:"required",purchaseDate:"required",phone:{required:true,sellCarPhone:true},gop_type_address:{required:true,requiredLocationAutocompleteCity:true},email:{required:true,email:true,emailNoTopLevelDomains:true}}};ModelGopValidator.prototype.initValidation=function(){var self=this;var validator=this.view.getForm().validate({rules:this.getRules(),messages:this.getMessages(),highlight:function(element){self.getErrorBlock(element).addClass("active");self.errorsCount=validator.numberOfInvalids();if(self.errorsCount!==0){self._onInvalid.fire()}},unhighlight:function(element){self.getErrorBlock(element).removeClass("active");self.errorsCount=validator.numberOfInvalids();if(self.errorsCount===0){self._onValid.fire()}},errorPlacement:function($error,$element){var errorMessage=$error.text();self.onElementInvalidCallbacks.fire(errorMessage,$element);self.getErrorBlock($element).html(errorMessage)}});this.view.getPurchaseDateDom().on("change",function(event){validator.element(event.target)})};ModelGopValidator.prototype.getErrorBlock=function(element){var property=$(element).attr("name");return this.view.getForm().find('[data-error-name="'+property+'"]')};ModelGopValidator.prototype.validate=function(){return this.view.getForm().valid()};return ModelGopValidator}();Gop.ModelGopValidator=ModelGopValidator})(Gop||(Gop={}));;
var Gop;(function(Gop){var GopController=function(){function GopController($form,container){this.$form=$form;this.eventDispatcher=container.get("event_dispatcher");this.dataProxy=container.get("data_proxy_service");this.view=new Gop.ModelGopView(this.$form,this.dataProxy,container.get("city_detect"),container.get("user_info_service"),container.get("mobile_detect").mobile(),container.get("ga"));this.validator=new Gop.ModelGopValidator(this.view);this.model=new Gop.ModelGopModel(this.view,container.get("lead_submit.service"));this.smsVerification=new Gop.SmsVerification(container);this.ga=container.get("ga");this.notificationService=container.get("notification_service");this.pixelTracker=container.get("pixel");this.userInfoService=container.get("user_info_service");this.analyticsUserBehavior=container.get("analytics_user_behavior");this.mixinService=container.get("gop.mixin.service");this._onDataSetUpdated=$.Callbacks();this.init()}GopController.prototype.getUserInfoService=function(){return this.userInfoService};GopController.prototype.getView=function(){return this.view};GopController.prototype.getModel=function(){return this.model};GopController.prototype.updateByDataSet=function(dataset){this.model.updateByDataSet(dataset);this.smsVerification.updateByDataSet(dataset);this._onDataSetUpdated.fire(dataset)};GopController.prototype.onDataSetUpdated=function(callback){this._onDataSetUpdated.add(callback)};GopController.prototype.init=function(){this.handleSmsVerification();this.handleValidation();this.handleModel();this.setAnalyticsInteractionBuffer();this.trackFieldsInteraction();this.trackValidationErrors();this.aigClickEvent();this.applyMixins()};GopController.prototype.applyMixins=function(){this.mixinService.apply(this)};GopController.prototype.handleSmsVerification=function(){var _this=this;this.smsVerification.init({namespace:"sms_verify_"+this.$form.prop("name"),$form:this.$form.find("[data-sms-verification-block]")});this.smsVerification.onSkip(function(){if(_this.validator.validate()){_this.finishGop()}});var smsVerifyNamespace=this.smsVerification.getNamespace();this.eventDispatcher.subscribe(smsVerifyNamespace+":updatePhone",function(){var phone=_this.smsVerification.getPhone();_this.view.setUserPhone(phone);_this.view.enableSubmit();_this.view.getForm().submit()});this.eventDispatcher.subscribe(smsVerifyNamespace+":success",function(){_this.eventDispatcher.publish("GopPopup:leadVerifiedSavedNew");_this.finishGop()})};GopController.prototype.handleValidation=function(){var _this=this;this.validator.onFormValid(function(){_this.view.enableSubmit()});this.validator.onFormInvalid(function(){_this.view.disableSubmit()})};GopController.prototype.handleModel=function(){var _this=this;this.model.beforeSubmit(function(model){if(!_this.validator.validate()){model.cancelSubmit()}});this.model.onFormSubmit(function(){_this.eventDispatcher.publish("GopPopup:formSubmit",_this.model.getGtmData());_this.view.disableSubmit()});this.model.onFormSubmit(function(){_this.saveUserInfo()});this.model.afterSubmit(function(response){switch(response.status){case Gop.GopRequestStatus.ERROR:_this.notificationService.alert(response.message);break;case Gop.GopRequestStatus.STATUS_ERROR:break;case Gop.GopRequestStatus.STATUS_VERIFY_FAIL:_this.trackLeadSaved(response.isNew).done(function(){_this.leadSavedButNotVerified()});break;case Gop.GopRequestStatus.STATUS_OK:_this.trackLeadSaved(response.isNew).done(function(){_this.leadSaved()})}})};GopController.prototype.saveUserInfo=function(){this.userInfoService.setName(this.view.getUserName());this.userInfoService.setPhone(this.view.getUserPhone());this.userInfoService.setPurchaseDate(this.view.getPurchaseDate());this.userInfoService.setLocation(this.view.getLocationView());this.userInfoService.saveClientId();this.userInfoService.enableAutoSubmit()};GopController.prototype.leadSavedButNotVerified=function(){this.eventDispatcher.publish("GopPopup:leadSaved");this.smsVerification.start(this.view.getUserPhone(),this.view.getUserName());this.view.disableSubmit()};GopController.prototype.leadSaved=function(){this.eventDispatcher.publish("GopPopup:leadSaved");this.eventDispatcher.publish("GopPopup:leadVerifiedSaved");this.finishGop()};GopController.prototype.finishGop=function(){var _this=this;this.pixelTracker.track(function(){_this.saveVariantId();_this.model.doRedirect()})};GopController.prototype.saveVariantId=function(){var variantId="";if(this.view.getVariantIdInput().length&&this.view.getVariantId()){variantId=this.view.getVariantId()}this.dataProxy.getDataProxy().set("gopVariantId",{value:variantId})};GopController.prototype.setAnalyticsInteractionBuffer=function(){if(this.view.isFormVisible()){var dto=this.view.getFormFieldsStateDto();this.analyticsUserBehavior.setGorpFormInteractionBuffer(dto)}};GopController.prototype.trackLeadSaved=function(isNewLead){if(!isNewLead){return $.Deferred().resolve().promise()}return this.trackGa()};GopController.prototype.trackGa=function(){var gaCategory=this.getTrackEventCategory();var result=$.Deferred();var hotnessGaCategory=this.getLeadHotnessCategory();var purchaseDateGaAction=this.userInfoService.getPurchaseDate();$.when(this.ga.sendEvent(gaCategory,"GetOnRoadPrice",this.view.getTitle()),this.ga.sendEvent(hotnessGaCategory,purchaseDateGaAction,this.view.getTitle()),this.sendAigInsuranceGaEvent(gaCategory,JSON.parse(this.view.getInsurance()))).always(function(){result.resolve()});return result};GopController.prototype.getTrackEventCategory=function(){return this.view.getTrackeventCategory()||"Catalogue"};GopController.prototype.trackValidationErrors=function(){var _this=this;this.validator.onElementInvalid(function(error,$element){_this.analyticsUserBehavior.onGorpElementError(_this.getTrackEventCategory(),_this.view.getAnalyticsCanonicalName($element),error)})};GopController.prototype.trackFieldsInteraction=function(){var _this=this;this.view.getForm().on("keydown input change",function(event){var $element=$(event.target);var name=_this.view.getAnalyticsCanonicalName($element,"analyticsInteractionCanonicalMap");_this.analyticsUserBehavior.registerGorpElementChanged(name)})};GopController.prototype.getLeadHotnessCategory=function(){return"Lead hotness"};GopController.prototype.sendAigInsuranceGaEvent=function(gaCategory,isChecked){var action=isChecked?"GetOnRoadPirce with AIG":"GetOnRoadPirce without AIG";this.ga.sendEvent(gaCategory,action,this.view.getTitle())};GopController.prototype.sendAigInsuranceCheckStatusGaEvent=function(gaCategory,isChecked){var action=isChecked?"AIG checked":"AIG unchecked";this.ga.sendEvent(gaCategory,action,this.view.getTitle())};GopController.prototype.aigClickEvent=function(){var _this=this;var $checkbox=this.view.getInsuranceDom();$checkbox.on("click",function(){var checkboxValue=JSON.parse(_this.view.getInsurance());_this.sendAigInsuranceCheckStatusGaEvent(_this.getTrackEventCategory(),checkboxValue)})};return GopController}();Gop.GopController=GopController})(Gop||(Gop={}));;
var Services;(function(Services){var ABValues;(function(ABValues){ABValues["A"]="a";ABValues["B"]="b"})(ABValues=Services.ABValues||(Services.ABValues={}));var ABService=function(){function ABService(storage,key){this.storage=storage;this.key=key}ABService.prototype.isActive=function(){return this.storage.get(this.key)==ABValues.A};ABService.prototype.getValue=function(){return this.storage.get(this.key)};return ABService}();Services.ABService=ABService})(Services||(Services={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Gop;(function(Gop){var ModelGopController=function(_super){__extends(ModelGopController,_super);function ModelGopController(popup,container){var _this=_super.call(this,popup.getGopForm(),container)||this;_this.popup=popup;_this.createPopup();return _this}ModelGopController.prototype.updateByDataSet=function(dataset){_super.prototype.updateByDataSet.call(this,dataset);this.updatePopup()};ModelGopController.prototype.updatePopup=function(){this.popup.setModelTitle(this.view.getTitle())};ModelGopController.prototype.showPopup=function(){this.popup.open();this.popup.getGopForm().trigger("autoportal.gop-form.popup.show")};ModelGopController.prototype.createPopup=function(){this.popup.onOpen(function(){this.popup.show();this.updateAnalyticsInteractionBuffer()}.bind(this));this.popup.onClose(function(){this.popup.hide();this.analyticsUserBehavior.onGopPopUpClose(this.popup.getModelTitle())}.bind(this))};ModelGopController.prototype.setPartnerId=function(partnerId){this.model.setPartnerId(partnerId)};ModelGopController.prototype.trackGa=function(){var gaCategory=this.getTrackEventCategory();var result=$.Deferred();var hotnessGaCategory=this.getLeadHotnessCategory();var purchaseDateGaAction=this.userInfoService.getPurchaseDate();$.when(this.ga.sendEvent(gaCategory,"GetOnRoadPrice",this.popup.getModelTitle()),this.ga.sendEvent(hotnessGaCategory,purchaseDateGaAction,this.popup.getModelTitle()),this.sendAigInsuranceGaEvent(gaCategory,JSON.parse(this.view.getInsurance()))).always(function(){result.resolve()});return result};ModelGopController.prototype.getTrackEventCategory=function(){return this.popup.getGopForm().find("[type=submit]").data("trackeventCategory")||"Catalogue"};ModelGopController.prototype.updateAnalyticsInteractionBuffer=function(){var dto=this.view.getFormFieldsStateDto();this.analyticsUserBehavior.eraseGorpFormInteractionBuffer();this.analyticsUserBehavior.setGorpFormInteractionBuffer(dto)};ModelGopController.prototype.finishGop=function(){_super.prototype.finishGop.call(this);this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close()};return ModelGopController}(Gop.GopController);Gop.ModelGopController=ModelGopController})(Gop||(Gop={}));;
var Services;(function(Services){var INVALID_FIELDS_BUFFER_DELAY=1e3;var AnalyticsUserBehaviorService=function(){function AnalyticsUserBehaviorService(ga){this.GopFieldsStateBuffer={};this.BookingFieldsStateBuffer={};this.TestDriveFieldsStateBuffer={};this.DealFieldsStateBuffer={};this.ShortGopFieldsStateBuffer={};this.bufferTimeOutId=null;this.invalidFieldsBuffer={};this.ga=ga}AnalyticsUserBehaviorService.prototype.onGopPopUpClose=function(modelTitle){this.sendClosePopupEvent("GORP Close",modelTitle)};AnalyticsUserBehaviorService.prototype.onBookingPopUpClose=function(modelTitle){this.sendClosePopupEvent("BK Close",modelTitle)};AnalyticsUserBehaviorService.prototype.onTestDrivePopUpClose=function(modelTitle){this.sendClosePopupEvent("TD Close",modelTitle)};AnalyticsUserBehaviorService.prototype.onGorpElementError=function(trackEventCategory,elementName,errorMessage){var action="GORPError."+elementName;var category="GORPErrorForm"+" "+trackEventCategory;this.onElementError(category,action,errorMessage)};AnalyticsUserBehaviorService.prototype.onBookingElementError=function(trackEventCategory,elementName,errorMessage){var action="BKError."+elementName;var category="BK ErrorForm"+" "+trackEventCategory;this.onElementError(category,action,errorMessage)};AnalyticsUserBehaviorService.prototype.onTestDriveElementError=function(trackEventCategory,elementName,errorMessage){var action="TDError."+elementName;var category="TD ErrorForm"+" "+trackEventCategory;this.onElementError(category,action,errorMessage)};AnalyticsUserBehaviorService.prototype.onDealElementError=function(trackEventCategory,elementName,errorMessage){var action="DealsError."+elementName;var category="Deals ErrorForm"+" "+trackEventCategory;this.onElementError(category,action,errorMessage)};AnalyticsUserBehaviorService.prototype.onElementError=function(category,action,label){var _this=this;if(this.invalidFieldsBuffer[action]===undefined){this.invalidFieldsBuffer[action]={category:category,action:action,label:label}}if(!this.bufferTimeOutId&&!this.invalidFieldsBuffer.length){this.bufferTimeOutId=setTimeout(function(){_this.sendInvalidFieldsBuffer(_this.invalidFieldsBuffer);_this.invalidFieldsBuffer={};_this.bufferTimeOutId=null},INVALID_FIELDS_BUFFER_DELAY)}};AnalyticsUserBehaviorService.prototype.onDealPopUpClose=function(modelTitle){this.sendClosePopupEvent("Deals Close",modelTitle)};AnalyticsUserBehaviorService.prototype.setGorpFormInteractionBuffer=function(dto){this.setFormInteractionBuffer(dto,this.GopFieldsStateBuffer,"GORP form")};AnalyticsUserBehaviorService.prototype.eraseGorpFormInteractionBuffer=function(){this.GopFieldsStateBuffer={}};AnalyticsUserBehaviorService.prototype.registerGorpElementChanged=function(name){this.registerInteractionElementChanged(name,this.GopFieldsStateBuffer)};AnalyticsUserBehaviorService.prototype.setShortGorpFormInteractionBuffer=function(dto){this.setFormInteractionBuffer(dto,this.ShortGopFieldsStateBuffer,"GORP form")};AnalyticsUserBehaviorService.prototype.eraseShortGorpFormInteractionBuffer=function(){this.ShortGopFieldsStateBuffer={}};AnalyticsUserBehaviorService.prototype.registerShortGorpElementChanged=function(name){this.registerInteractionElementChanged(name,this.ShortGopFieldsStateBuffer)};AnalyticsUserBehaviorService.prototype.setBookingFormInteractionBuffer=function(dto){this.setFormInteractionBuffer(dto,this.BookingFieldsStateBuffer,"BK form")};AnalyticsUserBehaviorService.prototype.eraseBookingFormInteractionBuffer=function(){this.BookingFieldsStateBuffer={}};AnalyticsUserBehaviorService.prototype.registerBookingElementChanged=function(name){this.registerInteractionElementChanged(name,this.BookingFieldsStateBuffer)};AnalyticsUserBehaviorService.prototype.setTestDriveFormInteractionBuffer=function(dto){this.setFormInteractionBuffer(dto,this.TestDriveFieldsStateBuffer,"TD form")};AnalyticsUserBehaviorService.prototype.eraseTestDriveFormInteractionBuffer=function(){this.TestDriveFieldsStateBuffer={}};AnalyticsUserBehaviorService.prototype.registerTestDriveElementChanged=function(name){this.registerInteractionElementChanged(name,this.TestDriveFieldsStateBuffer)};AnalyticsUserBehaviorService.prototype.setDealFormInteractionBuffer=function(dto){this.setFormInteractionBuffer(dto,this.DealFieldsStateBuffer,"Deals form")};AnalyticsUserBehaviorService.prototype.eraseDealFormInteractionBuffer=function(){this.DealFieldsStateBuffer={}};AnalyticsUserBehaviorService.prototype.registerDealElementChanged=function(name){this.registerInteractionElementChanged(name,this.DealFieldsStateBuffer)};AnalyticsUserBehaviorService.prototype.setFormInteractionBuffer=function(dto,buffer,category){for(var key in dto){var item=dto[key];var label=item.empty?"Manual":"Auto-changed";var interactionElement={category:category,action:item.name,label:label,state:false};if(!item.empty){this.ga.sendEvent(interactionElement.category,interactionElement.action,"Auto")}if(!buffer.hasOwnProperty(item.name)){buffer[item.name]=interactionElement}}};AnalyticsUserBehaviorService.prototype.registerInteractionElementChanged=function(name,buffer){if(!buffer.hasOwnProperty(name)){return}var element=buffer[name];if(element.state){return}this.ga.sendEvent(element.category,element.action,element.label);element.state=true};AnalyticsUserBehaviorService.prototype.sendInvalidFieldsBuffer=function(data){for(var key in data){var eventElement=data[key];this.ga.sendEvent(eventElement.category,eventElement.action,eventElement.label)}};AnalyticsUserBehaviorService.prototype.sendClosePopupEvent=function(action,label){this.ga.sendEvent("Close",action,label)};return AnalyticsUserBehaviorService}();Services.AnalyticsUserBehaviorService=AnalyticsUserBehaviorService})(Services||(Services={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var ModelGopPopup=function(_super){__extends(ModelGopPopup,_super);function ModelGopPopup(container,formSelector,eventDispatcher){var _this=_super.call(this,container,eventDispatcher)||this;_this.formSelector=formSelector;return _this}ModelGopPopup.prototype.getGopForm=function(){return $(this.getContainer()).find(this.formSelector)};ModelGopPopup.prototype.setModelTitle=function(modelTitle){$(this.getContainer()).find('[data-type="brand-model-title"]').text(modelTitle)};ModelGopPopup.prototype.getModelTitle=function(){return $(this.getContainer()).find('[data-type="brand-model-title"]').text()};ModelGopPopup.prototype.show=function(){$(this.getContainer()).show()};ModelGopPopup.prototype.hide=function(){$(this.getContainer()).hide()};return ModelGopPopup}(Popup.ConfirmableFormPopup);Popup.ModelGopPopup=ModelGopPopup})(Popup||(Popup={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Leads;(function(Leads){var GopLead=function(_super){__extends(GopLead,_super);function GopLead(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.data={lead_type:"gop",brand_id:"",city_id:"",model_id:"",variant_id:"",name:"",partner_id:"",phone:"",postcode:"",purchase_date:"",locality:"",business_owner:"false",liberty_videocon:"false",tokio_insurance:"false",sbi_august:"false",ab_test:"",aig_life_insurance:"false",email:"",vw_cpl:"false",liberty_insurance:"false"};return _this}GopLead.prototype.build=function(view,ab){if(view&&view instanceof Gop.GopView){this.fillFromView(view);if(ab){this.setAbTest(ab)}}return this.data};GopLead.prototype.fillFromView=function(view){this.setBrandId(view.getBrandId());this.setCityId(view.getCityId());this.setModelId(view.getModelId());this.setVariantId(view.getVariantId());this.setName(view.getUserName());this.setPartnerId(view.getPartnerId());this.setPhone(view.getUserPhone());this.setPostcode(view.getPostCode());this.setPurchaseDate(view.getPurchaseDate());this.setLocality(view.getLocalityId());this.setInsurance(view.getInsurance());this.setEmail(view.getEmail());this.setVwCpl(view.getVwCpl());this.setLibertyInsurance(view.getLibertyInsurance())};GopLead.prototype.setVwCpl=function(value){this.data["vw_cpl"]=value.toString()};GopLead.prototype.setLibertyInsurance=function(value){this.data["liberty_insurance"]=value.toString()};GopLead.prototype.setEmail=function(value){this.data["email"]=value.toString()};GopLead.prototype.setBrandId=function(value){this.data["brand_id"]=""+value};GopLead.prototype.setCityId=function(value){this.data["city_id"]=""+value};GopLead.prototype.setModelId=function(value){this.data["model_id"]=""+value};GopLead.prototype.setVariantId=function(value){this.data["variant_id"]=""+value};GopLead.prototype.setName=function(value){this.data["name"]=value};GopLead.prototype.setPartnerId=function(value){this.data["partner_id"]=""+value};GopLead.prototype.setPhone=function(value){this.data["phone"]=value};GopLead.prototype.setPostcode=function(value){this.data["postcode"]=""+value};GopLead.prototype.setPurchaseDate=function(value){this.data["purchase_date"]=value};GopLead.prototype.setLocality=function(value){this.data["locality"]=""+value};GopLead.prototype.setAutoSubmitted=function(){this.data["auto_submitted"]="true"};GopLead.prototype.setAbTest=function(ab){this.data["ab_test"]=""+ab};GopLead.prototype.setInsurance=function(value){this.data["aig_life_insurance"]=""+value};return GopLead}(Leads.Lead);Leads.GopLead=GopLead})(Leads||(Leads={}));;
var Gop;(function(Gop){var GopMixinService=function(){function GopMixinService(){this.mixins=new Core.Collection}GopMixinService.prototype.add=function(mixin){var parameters=[];for(var _i=1;_i<arguments.length;_i++){parameters[_i-1]=arguments[_i]}this.mixins.add({className:mixin,parameters:parameters})};GopMixinService.prototype.apply=function(controller){var _this=this;this.mixins.forEach(function(mixinDefinition){var mixin=_this.createClass(mixinDefinition.className,mixinDefinition.parameters);mixin.install(controller)})};GopMixinService.prototype.createClass=function(constructorName,parameters){var constructor=new Function("return "+constructorName+";")();return new(constructor.bind.apply(constructor,[void 0].concat(parameters)))};return GopMixinService}();Gop.GopMixinService=GopMixinService})(Gop||(Gop={}));;
var Gop;(function(Gop){var BMW_ID=823;var TOYOTA_ID=857;var allowedBrands=[BMW_ID,TOYOTA_ID];var EmailMixin=function(){function EmailMixin(){}EmailMixin.prototype.install=function(controller){var _this=this;controller.onDataSetUpdated(function(dataSet){if(dataSet.hasOwnProperty("brandId")){_this.processChange(controller,dataSet.brandId)}});controller.getView().onBrandChanged(function(brandId){_this.processChange(controller,brandId)});controller.getModel().onFormSubmit(function(){controller.getUserInfoService().setEmail(controller.getView().getEmail())})};EmailMixin.prototype.processChange=function(controller,brandId){if(this.isBrandAllowed(brandId)){this.enableEmail(controller)}else{this.disableEmail(controller)}};EmailMixin.prototype.isBrandAllowed=function(brandId){var brandInt=parseInt(brandId.toString());return allowedBrands.indexOf(brandInt)>=0};EmailMixin.prototype.enableEmail=function(controller){controller.getView().showEmail()};EmailMixin.prototype.disableEmail=function(controller){controller.getView().hideEmail()};return EmailMixin}();Gop.EmailMixin=EmailMixin})(Gop||(Gop={}));;
var NORTH="north";var SOUTH="south";var Gop;(function(Gop){var VWCplMixin=function(){function VWCplMixin(cityDetect,models,cities){this.cityDetect=cityDetect;this.models=models;this.sideCities=cities}VWCplMixin.prototype.install=function(controller){var _this=this;controller.onDataSetUpdated(function(dataSet){if(dataSet.hasOwnProperty("modelId")){_this.processChange(controller,dataSet.modelId)}});controller.getView().onModelChanged(function(modelId){_this.processChange(controller,modelId)})};VWCplMixin.prototype.processChange=function(controller,modelId){if(this.isOfferAvailable(modelId)){this.enableVWCheckBox(controller)}else{this.disableVWCheckBox(controller)}};VWCplMixin.prototype.isOfferAvailable=function(modelId){return modelId&&this.models.indexOf(parseInt(modelId.toString()))!==-1&&this.detectCitySideLocation()!==null};VWCplMixin.prototype.enableVWCheckBox=function(controller){controller.getView().setVWLabelValue(this.getLabel());controller.getView().showVWCheckBox()};VWCplMixin.prototype.disableVWCheckBox=function(controller){controller.getView().hideVWCheckBox()};VWCplMixin.prototype.getLabel=function(){var sideLocation=this.detectCitySideLocation();switch(sideLocation){case NORTH:return"Vento Automatic@6.99% interest rate";case SOUTH:return"Benefits up to Rs. 1 lakh* on Vento";default:return null}};VWCplMixin.prototype.detectCitySideLocation=function(){var _a=this.sideCities,north_cities=_a.north_cities,south_cities=_a.south_cities;var cityId=this.cityDetect.getCityId();switch(true){case this.containsId(north_cities,cityId):return NORTH;case this.containsId(south_cities,cityId):return SOUTH;default:return null}};VWCplMixin.prototype.containsId=function(collection,id){return collection.some(function(value){return value===id})};return VWCplMixin}();Gop.VWCplMixin=VWCplMixin})(Gop||(Gop={}));;
var Gop;(function(Gop){var ToyotaCplMixin=function(){function ToyotaCplMixin(cityDetect,models,cities){this.cityDetect=cityDetect;this.models=models;this.toyotaCities=cities}ToyotaCplMixin.prototype.install=function(controller){var _this=this;controller.onDataSetUpdated(function(dataSet){if(dataSet.hasOwnProperty("modelId")){_this.processChange(controller,dataSet.modelId)}});controller.getView().onModelChanged(function(modelId){if(!modelId){return}_this.processChange(controller,modelId)});controller.getModel().onFormSubmit(function(){controller.getUserInfoService().setEmail(controller.getView().getEmail())})};ToyotaCplMixin.prototype.processChange=function(controller,modelId){if(this.isOtpAvailable(modelId)){this.disableOtpSkip(controller)}else{this.enableOtpSkip(controller)}};ToyotaCplMixin.prototype.isOtpAvailable=function(modelId){return this.isCplModel(modelId)&&this.isCplCity()};ToyotaCplMixin.prototype.isCplModel=function(modelId){if(!modelId){return false}var modelInt=parseInt(modelId.toString());return this.models.indexOf(modelInt)>=0};ToyotaCplMixin.prototype.isCplCity=function(){var cityId=this.cityDetect.getCityId();return this.toyotaCities.indexOf(cityId)>=0};ToyotaCplMixin.prototype.enableOtpSkip=function(controller){controller.getView().showSkipSmsVerification()};ToyotaCplMixin.prototype.disableOtpSkip=function(controller){controller.getView().hideSkipSmsVerification()};return ToyotaCplMixin}();Gop.ToyotaCplMixin=ToyotaCplMixin})(Gop||(Gop={}));;
var Gop;(function(Gop){var LibertyInsuranceMixin=function(){function LibertyInsuranceMixin(cityDetect,dataProxy){this.cityDetect=cityDetect;this.dataProxy=dataProxy}LibertyInsuranceMixin.prototype.install=function(controller){var _this=this;controller.onDataSetUpdated(function(dataSet){if(dataSet.hasOwnProperty("brandId")){_this.applyInsuranceCheckBox(dataSet.brandId.toString(),controller)}})};LibertyInsuranceMixin.prototype.applyInsuranceCheckBox=function(brandId,controller){var cityId=this.cityDetect.getCityId().toString();this.dataProxy.loadPremiumDealersAvailability(parseInt(cityId,10),parseInt(brandId,10)).then(function(response){if(response){controller.getView().hideLibertyInshurance()}else{controller.getView().showLibertyInsurance()}})};return LibertyInsuranceMixin}();Gop.LibertyInsuranceMixin=LibertyInsuranceMixin})(Gop||(Gop={}));;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){$(document).on("click",'[data-type="gop-button"], [data-type="gop_button"]',function(e){e.preventDefault();var dataset=this.dataset;if(container.hasService("lib.gop")){container.get("lib.gop").proceed(dataset)}else{container.get("event_dispatcher").publish("gopButton:click",dataset)}})});;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){$('[data-type="offers-popup-button"]').on("click",function(e){e.preventDefault();container.get("event_dispatcher").publish("offersPopupButton:click",this.dataset)})});;
var Booking;(function(Booking){var RequestCallbackResponseStatus;(function(RequestCallbackResponseStatus){RequestCallbackResponseStatus[RequestCallbackResponseStatus["OK"]="ok"]="OK";RequestCallbackResponseStatus[RequestCallbackResponseStatus["VALIDATION_ERROR"]="validation_error"]="VALIDATION_ERROR";RequestCallbackResponseStatus[RequestCallbackResponseStatus["ERROR"]="error"]="ERROR"})(RequestCallbackResponseStatus=Booking.RequestCallbackResponseStatus||(Booking.RequestCallbackResponseStatus={}));var RequestCallbackForm=function(){function RequestCallbackForm(container){this.cookieLeadId="GopLeadId";this.container=container;this.notificationService=container.get("notification_service");this.gaService=this.container.get("ga");this.userInfo=container.get("user_info_service");this.gaCategory="Pre-Booking";this.gaAction="RequestCallBack";this.gaLabel=""}RequestCallbackForm.prototype.handleView=function(){this.setUserName(this.userInfo.getName());this.setUserPhone(this.userInfo.getPhone())};RequestCallbackForm.prototype.setUserName=function(value){this.$form.find('[name="request_callback_type[userName]"]').val(value)};RequestCallbackForm.prototype.setUserPhone=function(value){this.$form.find('[name="request_callback_type[userPhone][number]"]').val(value)};RequestCallbackForm.prototype.getUserName=function(){return this.$form.find('[name="request_callback_type[userName]"]').val()};RequestCallbackForm.prototype.getUserPhone=function(){return this.$form.find('[name="request_callback_type[userPhone][number]"]').val()};RequestCallbackForm.prototype.saveUserInfo=function(){this.userInfo.setName(this.getUserName());this.userInfo.setPhone(this.getUserPhone());this.userInfo.saveClientId()};RequestCallbackForm.prototype.setGaCategory=function(category){this.gaCategory=category};RequestCallbackForm.prototype.setGaAction=function(action){this.gaAction=action};RequestCallbackForm.prototype.setGaLabel=function(label){this.gaLabel=label};RequestCallbackForm.prototype.update=function(booking,cityPath){this.setGaLabel(booking.getFullName());this.getModelTitleElement().html(booking.getFullName());this.getModelElement().val(booking.getModelId());if(cityPath){this.getOffersWorthElement().html(booking.getOffersWorth(cityPath))}};RequestCallbackForm.prototype.init=function($form,tyPopup){this.$form=$form;this.tyPopup=tyPopup;this.gtmService=this.container.get("gtm_service");this.cookieStorage=new Storages.CookieStorage;this.sending=false;this.addValidation();this.attachListeners();this.setCityValue();this.handleView()};RequestCallbackForm.prototype.attachListeners=function(){this.$form.on("submit",this.onSubmit.bind(this))};RequestCallbackForm.prototype.addValidation=function(){var self=this;var validatorOptions={rules:{"request_callback_type[userName]":{required:true,maxlength:100,autoportalName:true},"request_callback_type[userPhone][number]":{required:true,sellCarPhone:true}},highlight:function(element){self.getErrorBlock($(element).attr("name")).show()},unhighlight:function(element){self.getErrorBlock($(element).attr("name")).hide()},errorPlacement:function(error,element){self.getErrorBlock(element.attr("name")).html(error.text())}};this.$form.validate(validatorOptions)};RequestCallbackForm.prototype.getErrorBlock=function(fieldName){return this.$form.find('[data-error-name="'+fieldName+'"]')};RequestCallbackForm.prototype.getCityElement=function(){return this.$form.find('[name="request_callback_type[city]"]')};RequestCallbackForm.prototype.getModelElement=function(){return this.$form.find('[name="request_callback_type[model]"]')};RequestCallbackForm.prototype.getOffersWorthElement=function(){return $("[data-request-callback-offers-worth]")};RequestCallbackForm.prototype.getModelTitleElement=function(){return $('[data-type="callbackModelTitle"]')};RequestCallbackForm.prototype.hideForm=function(){this.$form.each(function(){this.reset()});var popup=this.container.get("popup_service").get("request_callback_popup");popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);popup.close()};RequestCallbackForm.prototype.showThankYouMessage=function(){this.tyPopup.open()};RequestCallbackForm.prototype.onSubmit=function(event){var _this=this;event.preventDefault();if(!this.isSending()&&this.$form.valid()){this.disableSending();this.disableSubmit();$.post(this.$form.attr("action"),this.$form.serialize(),this.getSubmitCallback(),"json").always(function(){_this.enableSending();_this.enableSubmit()})}};RequestCallbackForm.prototype.isSending=function(){return this.sending};RequestCallbackForm.prototype.disableSending=function(){this.sending=true};RequestCallbackForm.prototype.enableSending=function(){this.sending=false};RequestCallbackForm.prototype.disableSubmit=function(){this.getSubmitDom().prop("disabled","disabled")};RequestCallbackForm.prototype.enableSubmit=function(){this.getSubmitDom().removeProp("disabled")};RequestCallbackForm.prototype.getSubmitDom=function(){return this.$form.find(":submit")};RequestCallbackForm.prototype.getSubmitCallback=function(){var self=this;return function(response){switch(response.status){case Booking.RequestCallbackResponseStatus.OK:self.saveUserInfo();self.gtmService.pushData({event:"Request_Call_Back_Lead_Saved"});self.gaService.sendEvent(self.gaCategory,self.gaAction,self.gaLabel);self.setLeadIdCookie(response);self.hideForm();self.showThankYouMessage();break;case Booking.RequestCallbackResponseStatus.VALIDATION_ERROR:self.$form.validate().showErrors(response.errors);break;case Booking.RequestCallbackResponseStatus.ERROR:self.notificationService.alert(response.message);break}}};RequestCallbackForm.prototype.setLeadIdCookie=function(response){var leadId=response["data"]&&response["data"]["leadId"];this.cookieStorage.set(this.cookieLeadId,leadId)};RequestCallbackForm.prototype.setCityValue=function(){var cityId=this.container.get("city_detect").getCityId();this.getCityElement().val(cityId)};return RequestCallbackForm}();Booking.RequestCallbackForm=RequestCallbackForm})(Booking||(Booking={}));;
var Offers;(function(Offers){var LeadsPopupPrefill=function(){function LeadsPopupPrefill(sessionStorage){this.prefillButtonSelector='[data-type="offers-leads-popup-prefill"]';this.prefillBrandIdKey="offers-prefill-brand-id";this.prefillModelIdKey="offers-prefill-model-id";this.brandSelectSelector="#diwali_form select[name=brand]";this.modelSelectSelector="#diwali_form select[name=model]";this.storage=sessionStorage;this.addPrefillLinksListener();this.initPrefill()}LeadsPopupPrefill.prototype.savePrefillData=function(event){var $button=$(event.target);var brandId=$button.data(this.prefillBrandIdKey);var modelId=$button.data(this.prefillModelIdKey);this.storage.set(this.prefillBrandIdKey,brandId);this.storage.set(this.prefillModelIdKey,modelId)};LeadsPopupPrefill.prototype.initPrefill=function(){if(!$(this.brandSelectSelector).length){return}this.setSelectedData()};LeadsPopupPrefill.prototype.addPrefillLinksListener=function(){$(document).on("click",this.prefillButtonSelector,this.savePrefillData.bind(this))};LeadsPopupPrefill.prototype.setSelectedData=function(){var brandId=this.storage.get(this.prefillBrandIdKey);var modelId=this.storage.get(this.prefillModelIdKey);$(this.brandSelectSelector).data("selected-brand-id",brandId);$(this.modelSelectSelector).data("selected-model-id",modelId)};return LeadsPopupPrefill}();Offers.LeadsPopupPrefill=LeadsPopupPrefill})(Offers||(Offers={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var TestDrivePopup=function(_super){__extends(TestDrivePopup,_super);function TestDrivePopup(container,formSelector,eventDispatcher){var _this=_super.call(this,container,eventDispatcher)||this;_this.formSelector=formSelector;return _this}TestDrivePopup.prototype.getTestDriveForm=function(){return $(this.getContainer()).find(this.formSelector)};TestDrivePopup.prototype.setModelTitle=function(modelTitle){$(this.getContainer()).find('[data-type="brand-model-title"]').text(modelTitle)};TestDrivePopup.prototype.getModelTitle=function(){return $(this.getContainer()).find('[data-type="brand-model-title"]').text()};TestDrivePopup.prototype.show=function(){$(this.getContainer()).show()};TestDrivePopup.prototype.hide=function(){$(this.getContainer()).hide()};return TestDrivePopup}(Popup.ConfirmableFormPopup);Popup.TestDrivePopup=TestDrivePopup})(Popup||(Popup={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var TestDriveTyPopup=function(_super){__extends(TestDriveTyPopup,_super);function TestDriveTyPopup(){return _super!==null&&_super.apply(this,arguments)||this}TestDriveTyPopup.prototype.update=function(view){this.setModelTitle(view.getTitle());this.setUserName(view.getUserName());this.setDealerContactName(view.getDealerContactName());this.setDealerTitle(view.getDealerTitle())};TestDriveTyPopup.prototype.setMessage=function(message){this.getMessageDom().html(message)};TestDriveTyPopup.prototype.getMessageDom=function(){return $(this.getContainer()).find('[data-type="userMessage"]')};TestDriveTyPopup.prototype.setUserName=function(name){$(this.getContainer()).find('[data-type="user-name"]').text(name)};TestDriveTyPopup.prototype.setDealerTitle=function(name){$(this.getContainer()).find('[data-type="ty-dealer"]').text(name)};TestDriveTyPopup.prototype.setDealerContactName=function(name){$(this.getContainer()).find('[data-type="ty-dealer-contact"]').text(name)};TestDriveTyPopup.prototype.setModelTitle=function(modelTitle){$(this.getContainer()).find('[data-type="brand-model-title"]').text(modelTitle);this.updateTrackEventData(modelTitle)};TestDriveTyPopup.prototype.show=function(){$(this.getContainer()).show()};TestDriveTyPopup.prototype.hide=function(){$(this.getContainer()).hide()};TestDriveTyPopup.prototype.updateTrackEventData=function(modelTitle){this.getKnowMoreLink().attr("data-trackevent-category","Test Drive").attr("data-trackevent-action","How-"+this.getGaPrefix()).attr("data-trackevent-label",modelTitle)};TestDriveTyPopup.prototype.getGaPrefix=function(){return"TD"};TestDriveTyPopup.prototype.getKnowMoreLink=function(){return $(this.getContainer()).find('[data-type="know-more-link"]')};return TestDriveTyPopup}(Popup.BasePopup);Popup.TestDriveTyPopup=TestDriveTyPopup})(Popup||(Popup={}));;
var TestDrive;(function(TestDrive){var RequestPriority;(function(RequestPriority){RequestPriority[RequestPriority["WARM"]="WARM"]="WARM";RequestPriority[RequestPriority["HOT"]="HOT"]="HOT"})(RequestPriority=TestDrive.RequestPriority||(TestDrive.RequestPriority={}));var TestDriveController=function(){function TestDriveController(popup,container){this.popup=popup;this.$form=popup.getTestDriveForm();this.eventDispatcher=container.get("event_dispatcher");this.view=new TestDrive.TestDriveView(this.$form,container.get("data_proxy_service"),container.get("city_detect"),container.get("user_info_service"));this.validator=new TestDrive.TestDriveValidator(this.view);this.validator.init();this.model=new TestDrive.TestDriveModel(this.view,container.get("lead_submit.service"));this.ga=container.get("ga");this.userInfoService=container.get("user_info_service");this.notificationService=container.get("notification_service");this.smsVerification=new TestDrive.SmsVerification(container);this._onSuccess=$.Callbacks();this.tyMessage="";this.analyticsUserBehavior=container.get("analytics_user_behavior");this.init()}TestDriveController.prototype.disableOnCloseAnalyticsTracking=function(){this.onCloseAnalyticsTracking=false};TestDriveController.prototype.enableOnCloseAnalyticsTracking=function(){this.onCloseAnalyticsTracking=true};TestDriveController.prototype.setPopupService=function(service){this.popupService=service};TestDriveController.prototype.setTyPopupKey=function(key){this.tyPopupKey=key};TestDriveController.prototype.setTyPopup=function(tyPopup){this.tyPopup=tyPopup};TestDriveController.prototype.onSuccess=function(callback){this._onSuccess.add(callback)};TestDriveController.prototype.init=function(){this.handlePopup();this.handleModel();this.handleValidation();this.handleSmsVerification();this.enableOnCloseAnalyticsTracking();this.onSuccess(this.disableOnCloseAnalyticsTracking.bind(this));this.trackValidationErrors();this.setAnalyticsInteractionBuffer();this.trackFieldsInteraction()};TestDriveController.prototype.updatePriority=function(){var modelId=this.view.getModelId();var gopFilled=[];var requestPriority=RequestPriority.WARM;var storage=new Storages.CookieStorage;if(storage.get("gop_filled")){gopFilled=JSON.parse(storage.get("gop_filled"))}$.each(gopFilled,function(index,elem){if(elem==modelId){requestPriority=RequestPriority.HOT}});this.view.setPriority(requestPriority)};TestDriveController.prototype.updateByDataSet=function(dataset){this.view.updateByDataSet(dataset);this.smsVerification.updateByDataSet(dataset);this.updatePopup();this.updatePriority()};TestDriveController.prototype.updatePopup=function(){this.popup.setModelTitle(this.view.getTitle())};TestDriveController.prototype.showPopup=function(){this.popup.open();this.enableOnCloseAnalyticsTracking();this.updateAnalyticsInteractionBuffer();this.popup.getTestDriveForm().trigger("autoportal.test-drive-form.popup.show")};TestDriveController.prototype.handlePopup=function(){var _this=this;this.popup.onOpen(function(){_this.popup.show()});this.popup.onClose(function(){if(_this.onCloseAnalyticsTracking){_this.analyticsUserBehavior.onTestDrivePopUpClose(_this.popup.getModelTitle())}_this.popup.hide()});this.popup.onOpen(function(){_this.view.getModelLocation().update()})};TestDriveController.prototype.handleSmsVerification=function(){var _this=this;this.smsVerification.init({namespace:"sms_verify_test_drive",$form:this.$form.find("[data-sms-verification-block]")});var smsVerifyNamespace=this.smsVerification.getNamespace();this.eventDispatcher.subscribe(smsVerifyNamespace+":updatePhone",function(){var phone=_this.smsVerification.getPhone();_this.view.setUserPhone(phone);_this.view.unfreezeDisabled();_this.view.enableSubmit();_this.view.getForm().submit()});this.eventDispatcher.subscribe(smsVerifyNamespace+":success",function(){_this.finishTestDriveRequest();_this.eventDispatcher.publish("TestDrivePopup:leadVerifiedSavedNew")})};TestDriveController.prototype.saveUserInfo=function(){this.userInfoService.setEmail(this.view.getUserEmail());this.userInfoService.setName(this.view.getUserName());this.userInfoService.setPhone(this.view.getUserPhone());this.userInfoService.setLocation(this.view.getModelLocation());this.userInfoService.saveClientId()};TestDriveController.prototype.handleValidation=function(){var _this=this;this.validator.onFormValid(function(){_this.view.enableSubmit()});this.validator.onFormInvalid(function(){_this.view.disableSubmit()});var self=this;this.view.getForm().find("select, input").on("focusout",function(){self.validator.element(self.view.getModelLocation().getCityInputDom())})};TestDriveController.prototype.handleModel=function(){var _this=this;this.model.beforeSubmit(function(){if(!_this.validator.validate()){_this.model.cancelSubmit()}else{_this.view.disableSubmit();_this.view.freezeDisabled()}});this.model.onFormSubmit(function(){_this.view.setLoading()});this.model.afterSubmit(function(){_this.view.unsetLoading()});this.model.onFormSubmit(function(){_this.saveUserInfo()});this.model.onFormSubmit(function(){_this.eventDispatcher.publish("TestDrivePopup:formSubmit",_this.model.getGtmData());_this.view.disableSubmit()});this.model.afterSubmit(function(response){if(typeof response.tyMessage!=="undefined"){_this.tyMessage=response.tyMessage}});this.model.afterSubmit(function(response){switch(response.status){case TestDrive.TestDriveRequestStatus.PHONE_NOT_VERIFIED:_this.phoneIsNotVerified();break;case TestDrive.TestDriveRequestStatus.ERROR:_this.notificationService.alert(response.message);_this.view.unfreezeDisabled();_this.view.enableSubmit();break;case TestDrive.TestDriveRequestStatus.OK:_this.saveLeadId(response.leadId);_this.eventDispatcher.publish("TestDrivePopup:leadSaved");_this.eventDispatcher.publish("TestDrivePopup:leadVerifiedSaved");_this.finishTestDriveRequest();break}})};TestDriveController.prototype.saveLeadId=function(leadId){var storage=new Storages.CookieStorage;storage.set("GopLeadId",leadId)};TestDriveController.prototype.phoneIsNotVerified=function(){this.view.disableSubmit();this.eventDispatcher.publish("TestDrivePopup:leadSaved");this.smsVerification.start(this.view.getUserPhone(),this.view.getUserName())};TestDriveController.prototype.finishTestDriveRequest=function(){var gaCategory=this.getTrackEventCategory();this._onSuccess.fire(this);this.ga.sendEvent(gaCategory,"TestDrive lead saved",this.view.getTitle());this.smsVerification.hide();this.view.unfreezeDisabled();this.view.enableSubmit();this.tyPopup.update(this.view);this.updateTyMessage();this.popupService.setNextPopup(this.tyPopupKey);this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close()};TestDriveController.prototype.getTrackEventCategory=function(){return this.view.getSubmitButton().data("trackeventCategory")||"Booking"};TestDriveController.prototype.updateTyMessage=function(){this.tyPopup.setMessage(this.tyMessage)};TestDriveController.prototype.trackFieldsInteraction=function(){var _this=this;this.view.getForm().on("keydown input change",function(event){var $element=$(event.target);var name=_this.view.getAnalyticsCanonicalName($element,"analyticsInteractionCanonicalMap");_this.analyticsUserBehavior.registerTestDriveElementChanged(name)})};TestDriveController.prototype.trackValidationErrors=function(){var _this=this;this.validator.onElementInvalid(function(error,$element){var elementName=_this.view.getAnalyticsCanonicalName($element);var category=_this.getTrackEventCategory();_this.analyticsUserBehavior.onTestDriveElementError(category,elementName,error)})};TestDriveController.prototype.setAnalyticsInteractionBuffer=function(){if(this.view.isFormVisible()){var dto=this.view.getFormFieldsStateDto();this.analyticsUserBehavior.setTestDriveFormInteractionBuffer(dto)}};TestDriveController.prototype.updateAnalyticsInteractionBuffer=function(){var dto=this.view.getFormFieldsStateDto();this.analyticsUserBehavior.eraseTestDriveFormInteractionBuffer();this.analyticsUserBehavior.setTestDriveFormInteractionBuffer(dto)};return TestDriveController}();TestDrive.TestDriveController=TestDriveController})(TestDrive||(TestDrive={}));;
var TestDrive;(function(TestDrive){var TestDriveRequestStatus;(function(TestDriveRequestStatus){TestDriveRequestStatus["OK"]="request_saved";TestDriveRequestStatus["PHONE_NOT_VERIFIED"]="not_verified";TestDriveRequestStatus["ERROR"]="error"})(TestDriveRequestStatus=TestDrive.TestDriveRequestStatus||(TestDrive.TestDriveRequestStatus={}));var TestDriveModel=function(){function TestDriveModel(view,leadSubmitService){this.view=view;this._beforeSubmit=$.Callbacks();this._afterSubmit=$.Callbacks();this._onSubmit=$.Callbacks();this.submitionCanceled=false;this.leadSubmitService=leadSubmitService;this.addListeners()}TestDriveModel.prototype.addListeners=function(){this.view.getForm().on("submit",this.onSubmit.bind(this))};TestDriveModel.prototype.onSubmit=function(event){event.preventDefault();this._beforeSubmit.fire(this);if(!this.submitionCanceled){this.submit(this.buildLead())}this.submitionCanceled=false};TestDriveModel.prototype.submit=function(lead){var _this=this;this._onSubmit.fire(this);this.leadSubmitService.submit(this.view.getFormAction(),lead,"json").then(function(response){_this.handleResponse(response)})};TestDriveModel.prototype.handleResponse=function(response){this._afterSubmit.fire(response,this)};TestDriveModel.prototype.buildLead=function(){var lead=this.createLead();return lead.build(this.view)};TestDriveModel.prototype.createLead=function(){return new Leads.TestDriveLead};TestDriveModel.prototype.beforeSubmit=function(callback){this._beforeSubmit.add(callback)};TestDriveModel.prototype.afterSubmit=function(callback){this._afterSubmit.add(callback)};TestDriveModel.prototype.onFormSubmit=function(callback){this._onSubmit.add(callback)};TestDriveModel.prototype.cancelSubmit=function(){this.submitionCanceled=true};TestDriveModel.prototype.getGtmData=function(){var gtmData=this.buildLead();gtmData["showroomName"]=this.view.getDealerTitle();gtmData["showroomAddress"]=this.view.getShowroomTitle();gtmData["cityName"]=this.view.getDealerCityTitle();return gtmData};return TestDriveModel}();TestDrive.TestDriveModel=TestDriveModel})(TestDrive||(TestDrive={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var TestDrive;(function(TestDrive){var BUFFER_INTERACTION_MAP="analyticsInteractionCanonicalMap";var TestDriveView=function(_super){__extends(TestDriveView,_super);function TestDriveView($form,dataProxyService,cityService,userInfoService){var _this=_super.call(this,$form)||this;_this.analyticsCanonicalMap={name:"name",email:"email",phone:"phone",localityBlockModel:"modelCity",modelCity:"modelCity",showroom:"showroomId",showroomId:"showroomId",agree:"terms",terms:"terms",variantId:"variantId"};_this.analyticsInteractionCanonicalMap={name:"Name",email:"Email",phone:"Phone",showroomId:"Dealer",showroom:"Dealer",localityBlockModel:"City",modelCity:"City",agree:"terms",terms:"terms"};_this.cityService=cityService;_this.userInfoService=userInfoService;_this.dataProxy=dataProxyService.getDataProxy();_this.title="";_this.modelSelectLocation=_this.createLocationView('[data-block="localityBlockModel"]');_this.initUserInfo();_this.addListeners();return _this}TestDriveView.isMobileDetect=function(){var mobileDetector=new MobileDetect(navigator.userAgent);return mobileDetector.mobile()};TestDriveView.prototype.getModelLocation=function(){return this.modelSelectLocation};TestDriveView.prototype.createLocationView=function(selector){var _this=this;var result=new Forms.SelectLocationView(this,selector);result.addParameter("model",function(){return _this.getModelId()});result.addParameter("with_premium_showroom",function(){return true});return result};TestDriveView.prototype.setLoading=function(){this.$form.addClass("busy")};TestDriveView.prototype.unsetLoading=function(){this.$form.removeClass("busy")};TestDriveView.prototype.updateByDataSet=function(dataset){this.setBrandId(dataset.brandId);this.setModelId(dataset.modelId);this.setPartnerId(dataset.partnerId||0);if(TestDriveView.isMobileDetect()){this.setModelImage(dataset.modelImageSmall)}else{this.setModelImage(dataset.modelImage)}this.setTitle(dataset.title);this.setModelTitle(dataset.title);this.getSubmitButton().data("trackeventCategory",dataset.trackeventCategory);this.initDetectedCity()};TestDriveView.prototype.initDetectedCity=function(){var cityId=this.modelSelectLocation.getCityId()?Number(this.modelSelectLocation.getCityId()):Number(this.cityService.getCityId());var cityName=this.modelSelectLocation.getCityName()?this.modelSelectLocation.getCityName():this.cityService.getCityName();this.updateShowrooms(cityId);this.updatePrice(cityId);this.updateOfferBlock(cityId);if(cityName){this.setPriceCityName(cityName)}};TestDriveView.prototype.addListeners=function(){var _this=this;this.modelSelectLocation.onChange(function(){_this.updateShowrooms(_this.modelSelectLocation.getCityId())});this.modelSelectLocation.onChange(function(){_this.updatePrice(_this.modelSelectLocation.getCityId())});this.modelSelectLocation.onChange(function(){_this.updateOfferBlock(_this.modelSelectLocation.getCityId())});this.getForm().on("autoportal.test-drive-form.popup.show",this.updateLocation.bind(this))};TestDriveView.prototype.updatePrice=function(cityId){var _this=this;this.dataProxy.loadModelVariantWithPrices(this.getModelId(),cityId).done(function(variants){var prices=[];for(var i in variants){prices.push(variants[i].min)}_this.setPriceCityName(_this.getDealerCityTitle()||_this.cityService.getCityName());_this.setModelPriceRange(Helper.Price.formatPriceRange(Math.min.apply(null,prices),Math.max.apply(null,prices)))})};TestDriveView.prototype.updateOfferBlock=function(cityId){var _this=this;if(cityId){this.dataProxy.loadTestDriveOffer(this.getModelId(),cityId).done(function(data){_this.getAfterPriceBlockDom().html(data);_this.termConditionsAccordion()})}};TestDriveView.prototype.termConditionsAccordion=function(){if(TestDriveView.isMobileDetect()){$("[data-tc-btn]").on("click",function(){$(this).parent().find("[data-tc-body]").slideToggle()})}};TestDriveView.prototype.getDealerCityId=function(){return this.modelSelectLocation.getCityId()};TestDriveView.prototype.setPriceCityName=function(city){if(city){this.$form.find('[data-testdrive="priceCityName"]').text(city)}};TestDriveView.prototype.setModelPriceRange=function(price){this.$form.find('[data-testdrive="modelPriceRange"]').text(price)};TestDriveView.prototype.updateShowrooms=function(cityId){var _this=this;if(cityId){this.dataProxy.loadDealersShowrooms(cityId,this.getBrandId(),this.getModelId()).done(function(showrooms){_this.renderShowrooms(showrooms)})}else{this.renderShowrooms([])}};TestDriveView.prototype.renderShowrooms=function(showrooms){var groups={};var $showroomDom=this.getShowroomDom();$showroomDom.find('option:not([value=""]), optgroup').detach();for(var i in showrooms){if(showrooms.hasOwnProperty(i)){var showroom=showrooms[i];if(!groups.hasOwnProperty(showroom.dealer_name)){groups[showroom.dealer_name]=$("<optgroup/>").attr("label",showroom.dealer_name)}var $option=$("<option/>").val(showroom.showroom_id).text(showroom.showroom_address).attr("data-dealer-id",showroom.showroom_dealer_id).attr("data-dealer-contact-name",showroom.dealer_contact_name);groups[showroom.dealer_name].append($option)}for(var index in groups){$showroomDom.append(groups[index])}}};TestDriveView.prototype.getShowroomDom=function(){return this.$form.find('[data-testdrive="showroom"]')};TestDriveView.prototype.setModelId=function(modelId){this.getModelIdDom().val(modelId)};TestDriveView.prototype.getModelId=function(){return this.getModelIdDom().val()};TestDriveView.prototype.getModelIdDom=function(){return this.$form.find('[data-testdrive="modelId"]')};TestDriveView.prototype.setPartnerId=function(partnerId){this.getPartnerIdDom().val(partnerId)};TestDriveView.prototype.getPartnerId=function(){return this.getPartnerIdDom().val()};TestDriveView.prototype.getPartnerIdDom=function(){return this.$form.find('[data-testdrive="partnerId"]')};TestDriveView.prototype.setBrandId=function(brandId){this.getBrandIdDom().val(brandId)};TestDriveView.prototype.getBrandId=function(){return this.getBrandIdDom().val()};TestDriveView.prototype.getBrandIdDom=function(){return this.$form.find('[data-testdrive="brandId"]')};TestDriveView.prototype.getSourceId=function(){return this.getSourceIdDom().val()};TestDriveView.prototype.getSourceIdDom=function(){return this.$form.find('[data-booking="sourceId"]')};TestDriveView.prototype.getAfterPriceBlockDom=function(){return this.$form.find('[data-type="afterPriceBlock"]')};TestDriveView.prototype.setTitle=function(title){this.title=title};TestDriveView.prototype.getTitle=function(){return this.title};TestDriveView.prototype.setModelImage=function(imageSource){var _this=this;var img=new Image;img.onload=function(){_this.$form.find('[data-testdrive="modelImage"]').attr("src",imageSource)};img.src=imageSource};TestDriveView.prototype.setModelTitle=function(title){this.$form.find('[data-testdrive="modelTitle"]').html(title)};TestDriveView.prototype.getFormAction=function(){return this.$form.attr("action")};TestDriveView.prototype.getUserPhoneDom=function(){return this.$form.find('[data-testdrive="userPhone"]')};TestDriveView.prototype.getUserPhone=function(){return this.getUserPhoneDom().val()};TestDriveView.prototype.setUserPhone=function(phone){this.getUserPhoneDom().val(phone)};TestDriveView.prototype.getUserName=function(){return this.$form.find('[data-testdrive="userName"]').val()};TestDriveView.prototype.setUserName=function(name){return this.$form.find('[data-testdrive="userName"]').val(name)};TestDriveView.prototype.getUserEmail=function(){return this.$form.find('[data-testdrive="userEmail"]').val()};TestDriveView.prototype.setUserEmail=function(email){return this.$form.find('[data-testdrive="userEmail"]').val(email)};TestDriveView.prototype.getTermsDom=function(){return this.$form.find('[data-testdrive="terms"]')};TestDriveView.prototype.getTerms=function(){return this.$form.find('[data-testdrive="terms"]').is(":checked")};TestDriveView.prototype.getPriority=function(){return this.getRequestPriorityDom().val()};TestDriveView.prototype.setPriority=function(priority){this.getRequestPriorityDom().val(priority)};TestDriveView.prototype.getRequestPriorityDom=function(){return this.$form.find('[data-testdrive="requestPriority"]')};TestDriveView.prototype.getShowroomId=function(){return this.getShowroomDom().val()};TestDriveView.prototype.getDealerId=function(){return this.getShowroomDom().find(":selected").data("dealerId")};TestDriveView.prototype.getDealerTitle=function(){return this.getShowroomDom().find(":selected").parent("optgroup").attr("label")};TestDriveView.prototype.getDealerContactName=function(){return this.getShowroomDom().find(":selected").data("dealerContactName")};TestDriveView.prototype.getShowroomTitle=function(){return this.getShowroomDom().find(":selected").text().trim()};TestDriveView.prototype.getPostCode=function(){return this.modelSelectLocation.getPostCode()};TestDriveView.prototype.getLocalityId=function(){return this.modelSelectLocation.getLocalityId()};TestDriveView.prototype.getDealerCityTitle=function(){return this.modelSelectLocation.getCityName()};TestDriveView.prototype.getLocation=function(){return this.modelSelectLocation.getSelectedValue()};TestDriveView.prototype.getTrackEventCategory=function(){return this.getSubmitButton().data("trackeventCategory")||"Booking"};TestDriveView.prototype.initUserInfo=function(){this.setUserPhone(this.userInfoService.getPhone());this.setUserEmail(this.userInfoService.getEmail());this.setUserName(this.userInfoService.getName())};TestDriveView.prototype.updateLocation=function(){this.getModelLocation().restore(this.userInfoService.getLocation(),true)};TestDriveView.prototype.getAnalyticsCanonicalName=function($element,mapName){if(mapName===void 0){mapName=""}var nameProperty=$element.attr("name");var map=this.analyticsCanonicalMap;if(mapName===BUFFER_INTERACTION_MAP){map=this.analyticsInteractionCanonicalMap}if(map.hasOwnProperty(nameProperty)){return map[nameProperty]}return null};TestDriveView.prototype.getFormFieldsStateDto=function(){var dto={},formFields=this.$form.find(":input"),self=this;$.each(formFields,function(){var $element=$(this),nameProperty=$element.attr("name");if(!nameProperty){nameProperty=$element.data("canonicalName")}if(self.analyticsInteractionCanonicalMap.hasOwnProperty(nameProperty)){var empty=!Boolean($element.val()),name_1=self.analyticsInteractionCanonicalMap[nameProperty];if(name_1==="City"){empty=!Boolean(self.userInfoService.getLocation().getCityId())}if(!dto.hasOwnProperty(name_1)){dto[name_1]={name:name_1,empty:empty}}}});return dto};TestDriveView.prototype.isFormVisible=function(){return this.$form.is(":visible")};return TestDriveView}(General.FormView);TestDrive.TestDriveView=TestDriveView})(TestDrive||(TestDrive={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var TestDrive;(function(TestDrive){var TestDriveValidator=function(_super){__extends(TestDriveValidator,_super);function TestDriveValidator(){return _super!==null&&_super.apply(this,arguments)||this}TestDriveValidator.prototype.getRules=function(){return{name:{required:true,autoportalName:true},email:{required:true,email:true,emailNoTopLevelDomains:true},phone:{required:true,sellCarPhone:true},terms:"required",modelCity:{required:true,requiredLocationAutocompleteCity:true},showroom:"required"}};TestDriveValidator.prototype.getMessages=function(){return{name:"Please enter valid Name.",email:"Please enter valid Email.",phone:"Please enter valid Number.",terms:"Please agree with Terms and Conditions.",modelCity:"Please Enter Valid Location.",showroom:"Please select Dealer."}};return TestDriveValidator}(General.FormValidator);TestDrive.TestDriveValidator=TestDriveValidator})(TestDrive||(TestDrive={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var TestDrive;(function(TestDrive){var SmsVerification=function(_super){__extends(SmsVerification,_super);function SmsVerification(){return _super!==null&&_super.apply(this,arguments)||this}SmsVerification.prototype.resetForm=function(){_super.prototype.resetForm.call(this);this.hideOtpErrorMessage()};SmsVerification.prototype.onSubmit=function(event){_super.prototype.onSubmit.call(this,event);this.hideOtpErrorMessage()};SmsVerification.prototype.buildData=function(){return{phone:this.phone,code:this.getVerificationCodeElement().val()}};SmsVerification.prototype.updateByDataSet=function(dataset){this.getChangePhoneElement().attr("data-trackevent-label",dataset.title)};SmsVerification.prototype.getSubmitElement=function(){return this.$form.find('[data-action="submitVerifyCode"]')};SmsVerification.prototype.getResendElement=function(){return this.$form.find('[data-action="resendVerifyCode"]')};SmsVerification.prototype.getChangePhoneElement=function(){return this.$form.find('[data-action="changePhone"]')};SmsVerification.prototype.getSavePhoneElement=function(){return this.$form.find('[data-action="changePhoneConfirm"]')};SmsVerification.prototype.getPhoneNoInputElement=function(){return this.$form.find('[data-field="verificationPhoneNumber"]')};SmsVerification.prototype.getSkipNotificationElement=function(){return this.$form.find('[data-action="resendSkip"]')};SmsVerification.prototype.getVerifyPhoneNoElement=function(){return this.$form.find('[data-field="verificationUserPhone"]')};SmsVerification.prototype.onSkipLink=function(){};return SmsVerification}(Form.AbstractSmsVerifyForm);TestDrive.SmsVerification=SmsVerification})(TestDrive||(TestDrive={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Leads;(function(Leads){var TestDriveLead=function(_super){__extends(TestDriveLead,_super);function TestDriveLead(){return _super!==null&&_super.apply(this,arguments)||this}TestDriveLead.prototype.build=function(view){return{brand_id:""+view.getBrandId(),city_id:""+view.getDealerCityId(),dealer_id:""+view.getDealerId(),email:""+view.getUserEmail(),model_id:""+view.getModelId(),name:""+view.getUserName(),partner_id:""+view.getPartnerId(),phone:""+view.getUserPhone(),priority:""+view.getPriority(),request_type:"Testdrive",terms:""+view.getTerms(),showroom_id:""+view.getShowroomId(),source_id:""+view.getSourceId(),locality:""+view.getLocalityId(),postcode:""+view.getPostCode()}};return TestDriveLead}(Leads.Lead);Leads.TestDriveLead=TestDriveLead})(Leads||(Leads={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var TestDriveGtmPopup=function(_super){__extends(TestDriveGtmPopup,_super);function TestDriveGtmPopup(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.attachEventListeners();return _this}TestDriveGtmPopup.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe("TestDrivePopup:leadSaved",this.onLeadSavedCallback.bind(this));this.eventDispatcher.subscribe("TestDrivePopup:leadVerifiedSaved",this.onVerifiedSavedCallback.bind(this));this.eventDispatcher.subscribe("TestDrivePopup:leadVerifiedSavedNew",this.onVerifiedSavedNewCallback.bind(this));this.eventDispatcher.subscribe("TestDrivePopup:formSubmit",this.onFormSubmitCallback.bind(this))};TestDriveGtmPopup.prototype.onLeadSavedCallback=function(event){this.gtmService.pushData(this.withUserId({event:"TD_Lead_Saved"}))};TestDriveGtmPopup.prototype.onVerifiedSavedCallback=function(event){this.gtmService.pushData(this.withUserId({event:"TD_Lead_Verified_Saved"}))};TestDriveGtmPopup.prototype.onVerifiedSavedNewCallback=function(event){this.gtmService.pushData(this.withUserId({event:"TD_Lead_Verified_Saved_New"}))};TestDriveGtmPopup.prototype.onFormSubmitCallback=function(event){};return TestDriveGtmPopup}(GTM.GtmPage);GTM.TestDriveGtmPopup=TestDriveGtmPopup})(GTM||(GTM={}));;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){$('[data-type="testdrive"]').on("click",function(e){e.preventDefault();container.get("event_dispatcher").publish("testdriveButton:click",this.dataset)})});;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var BookingPopup=function(_super){__extends(BookingPopup,_super);function BookingPopup(container,formSelector,eventDispatcher){var _this=_super.call(this,container,eventDispatcher)||this;_this.formSelector=formSelector;return _this}BookingPopup.prototype.getBookingForm=function(){return $(this.getContainer()).find(this.formSelector)};BookingPopup.prototype.setModelTitle=function(modelTitle){$(this.getContainer()).find('[data-type="brand-model-title"]').text(modelTitle)};BookingPopup.prototype.getModelTitle=function(){return $(this.getContainer()).find('[data-type="brand-model-title"]').text()};BookingPopup.prototype.setVariantTitle=function(variantTitle){$(this.getContainer()).find('[data-type="variant-name"]').text(" "+variantTitle)};BookingPopup.prototype.show=function(){$(this.getContainer()).show()};BookingPopup.prototype.hide=function(){$(this.getContainer()).hide()};return BookingPopup}(Popup.ConfirmableFormPopup);Popup.BookingPopup=BookingPopup})(Popup||(Popup={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Popup;(function(Popup){var BookingTyPopup=function(_super){__extends(BookingTyPopup,_super);function BookingTyPopup(){return _super!==null&&_super.apply(this,arguments)||this}BookingTyPopup.prototype.update=function(view){this.setModelTitle(view.getTitle());this.setUserName(view.getUserName());this.setDealerContactName(view.getDealerContactName());this.setDealerTitle(view.getDealerTitle())};BookingTyPopup.prototype.setMessage=function(message){this.getMessageDom().html(message)};BookingTyPopup.prototype.getMessageDom=function(){return $(this.getContainer()).find('[data-type="userMessage"]')};BookingTyPopup.prototype.setUserName=function(name){$(this.getContainer()).find('[data-type="user-name"]').text(name)};BookingTyPopup.prototype.setDealerTitle=function(name){$(this.getContainer()).find('[data-type="ty-dealer"]').text(name)};BookingTyPopup.prototype.setDealerContactName=function(name){$(this.getContainer()).find('[data-type="ty-dealer-contact"]').text(name)};BookingTyPopup.prototype.setModelTitle=function(modelTitle){$(this.getContainer()).find('[data-type="brand-model-title"]').text(modelTitle);this.updateTrackEventData(modelTitle)};BookingTyPopup.prototype.show=function(){$(this.getContainer()).show()};BookingTyPopup.prototype.hide=function(){$(this.getContainer()).hide()};BookingTyPopup.prototype.updateTrackEventData=function(modelTitle){this.getKnowMoreLink().attr("data-trackevent-category","Booking").attr("data-trackevent-action","How-"+this.getGaPrefix()).attr("data-trackevent-label",modelTitle)};BookingTyPopup.prototype.getGaPrefix=function(){return"BK"};BookingTyPopup.prototype.getKnowMoreLink=function(){return $(this.getContainer()).find('[data-type="know-more-link"]')};return BookingTyPopup}(Popup.BasePopup);Popup.BookingTyPopup=BookingTyPopup})(Popup||(Popup={}));;
var Booking;(function(Booking){var RequestPriority;(function(RequestPriority){RequestPriority[RequestPriority["WARM"]="WARM"]="WARM";RequestPriority[RequestPriority["HOT"]="HOT"]="HOT"})(RequestPriority=Booking.RequestPriority||(Booking.RequestPriority={}));var BookingController=function(){function BookingController(popup,container){this.popup=popup;this.$form=popup.getBookingForm();this.eventDispatcher=container.get("event_dispatcher");this.leadSubmitService=container.get("lead_submit.service");this.view=this.createView(container);this.model=this.createModel();this.ga=container.get("ga");this.notificationService=container.get("notification_service");this.smsVerification=new Booking.SmsVerification(container);this._onSuccess=$.Callbacks();this.validator=this.createValidator(this.view);this.validator.init();this.userInfo=container.get("user_info_service");this.tyMessage="";this.analyticsUserBehavior=container.get("analytics_user_behavior");this.init()}BookingController.prototype.disableOnCloseAnalyticsTracking=function(){this.onCloseAnalyticsTracking=false};BookingController.prototype.enableOnCloseAnalyticsTracking=function(){this.onCloseAnalyticsTracking=true};BookingController.prototype.createValidator=function(view){return new Booking.BookingValidator(view)};BookingController.prototype.createModel=function(){return new Booking.BookingModel(this.view,this.leadSubmitService)};BookingController.prototype.createView=function(container){return new Booking.BookingView(this.$form,container.get("data_proxy_service"),container.get("city_detect"),container.get("user_info_service"))};BookingController.prototype.setPopupService=function(service){this.popupService=service};BookingController.prototype.setTyPopupKey=function(key){this.tyPopupKey=key};BookingController.prototype.setTyPopup=function(tyPopup){this.tyPopup=tyPopup};BookingController.prototype.onSuccess=function(callback){this._onSuccess.add(callback)};BookingController.prototype.init=function(){this.handlePopup();this.handleModel();this.handleValidation();this.handleSmsVerification();this.enableOnCloseAnalyticsTracking();this.onSuccess(this.disableOnCloseAnalyticsTracking.bind(this));this.setAnalyticsInteractionBuffer();this.trackFieldsInteraction();this.trackValidationErrors()};BookingController.prototype.updatePriority=function(){var modelId=this.view.getModelId();var gopFilled=[];var requestPriority=RequestPriority.WARM;var storage=new Storages.CookieStorage;if(storage.get("gop_filled")){gopFilled=JSON.parse(storage.get("gop_filled"))}$.each(gopFilled,function(index,elem){if(elem==modelId){requestPriority=RequestPriority.HOT}});this.view.setPriority(requestPriority)};BookingController.prototype.updateByDataSet=function(dataset){this.view.updateByDataSet(dataset);this.smsVerification.updateByDataSet(dataset);this.updatePopup();this.updatePriority()};BookingController.prototype.updatePopup=function(){this.popup.setModelTitle(this.view.getTitle());this.popup.setVariantTitle(this.view.getVariantTitle())};BookingController.prototype.showPopup=function(){this.popup.open();this.enableOnCloseAnalyticsTracking();this.updateAnalyticsInteractionBuffer();this.popup.getBookingForm().trigger("autoportal.booking-form.popup.show")};BookingController.prototype.handlePopup=function(){var _this=this;this.popup.onOpen(function(){_this.popup.show()});this.popup.onClose(function(){if(_this.onCloseAnalyticsTracking){_this.analyticsUserBehavior.onBookingPopUpClose(_this.popup.getModelTitle())}_this.popup.hide()});this.popup.onOpen(function(){_this.view.getModelLocation().update()})};BookingController.prototype.handleSmsVerification=function(){var _this=this;this.smsVerification.init({namespace:"sms_verify_booking",$form:this.$form.find("[data-sms-verification-block]")});var smsVerifyNamespace=this.smsVerification.getNamespace();this.eventDispatcher.subscribe(smsVerifyNamespace+":updatePhone",function(){var phone=_this.smsVerification.getPhone();_this.view.setUserPhone(phone);_this.view.unfreezeDisabled();_this.view.enableSubmit();_this.view.getForm().submit()});this.eventDispatcher.subscribe(smsVerifyNamespace+":success",function(){_this.finishBookingRequest();_this.eventDispatcher.publish("BookingPopup:leadVerifiedSavedNew")})};BookingController.prototype.handleValidation=function(){var _this=this;this.validator.onFormValid(function(){_this.view.enableSubmit()});this.validator.onFormInvalid(function(){_this.view.disableSubmit()});var self=this;this.view.getForm().find("select, input").on("focusout",function(){self.validator.element(self.view.getModelLocation().getCityInputDom());self.validator.element(self.view.getVariantDom())})};BookingController.prototype.onFormSubmit=function(){this.eventDispatcher.publish("BookingPopup:formSubmit",this.model.getGtmData());this.view.disableSubmit()};BookingController.prototype.handleModel=function(){var _this=this;this.model.beforeSubmit(function(){if(!_this.validator.validate()){_this.model.cancelSubmit()}else{_this.view.disableSubmit();_this.view.freezeDisabled()}});this.model.onFormSubmit(function(){_this.view.setLoading()});this.model.afterSubmit(function(){_this.view.unsetLoading()});this.model.onFormSubmit(function(){_this.saveUserInfo()});this.model.onFormSubmit(function(){_this.onFormSubmit()});this.model.afterSubmit(function(response){if(typeof response.tyMessage!=="undefined"){_this.tyMessage=response.tyMessage}});this.model.afterSubmit(function(response){switch(response.status){case Booking.BookingRequestStatus.PHONE_NOT_VERIFIED:_this.phoneIsNotVerified();break;case Booking.BookingRequestStatus.ERROR:_this.notificationService.alert(response.message);_this.view.unfreezeDisabled();_this.view.enableSubmit();break;case Booking.BookingRequestStatus.OK:_this.saveLeadId(response.leadId);_this.eventDispatcher.publish("BookingPopup:leadSaved");_this.eventDispatcher.publish("BookingPopup:leadVerifiedSaved");_this.finishBookingRequest();break}})};BookingController.prototype.saveUserInfo=function(){this.userInfo.setEmail(this.view.getUserEmail());this.userInfo.setName(this.view.getUserName());this.userInfo.setPhone(this.view.getUserPhone());this.userInfo.setLocation(this.view.getModelLocation());this.userInfo.saveClientId()};BookingController.prototype.saveLeadId=function(leadId){var storage=new Storages.CookieStorage;storage.set("GopLeadId",leadId)};BookingController.prototype.phoneIsNotVerified=function(){this.view.disableSubmit();this.eventDispatcher.publish("BookingPopup:leadSaved");this.smsVerification.start(this.view.getUserPhone(),this.view.getUserName())};BookingController.prototype.finishBookingRequest=function(){this._onSuccess.fire(this);this.sendGaSuccess();this.smsVerification.hide();this.view.unfreezeDisabled();this.view.enableSubmit();this.tyPopup.update(this.view);this.updateTyMessage();this.popupService.setNextPopup(this.tyPopupKey);this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close()};BookingController.prototype.updateTyMessage=function(){this.tyPopup.setMessage(this.tyMessage)};BookingController.prototype.sendGaSuccess=function(){var gaCategory=this.getTrackEventCategory();this.ga.sendEvent(gaCategory,"Booking lead saved",this.view.getTitle())};BookingController.prototype.showSuccessMessage=function(){this.tyPopup.open()};BookingController.prototype.getTrackEventCategory=function(){return this.view.getSubmitButton().data("trackeventCategory")||"Booking"};BookingController.prototype.trackFieldsInteraction=function(){var _this=this;this.view.getForm().on("keydown input change",function(event){var $element=$(event.target);var name=_this.view.getAnalyticsCanonicalName($element,"analyticsInteractionCanonicalMap");_this.analyticsUserBehavior.registerBookingElementChanged(name)})};BookingController.prototype.trackValidationErrors=function(){var _this=this;this.validator.onElementInvalid(function(error,$element){var name=_this.view.getAnalyticsCanonicalName($element);var category=_this.getTrackEventCategory();_this.analyticsUserBehavior.onBookingElementError(category,name,error)})};BookingController.prototype.setAnalyticsInteractionBuffer=function(){if(this.view.isFormVisible()){var dto=this.view.getFormFieldsStateDto();this.analyticsUserBehavior.setBookingFormInteractionBuffer(dto)}};BookingController.prototype.updateAnalyticsInteractionBuffer=function(){var dto=this.view.getFormFieldsStateDto();this.analyticsUserBehavior.eraseBookingFormInteractionBuffer();this.analyticsUserBehavior.setBookingFormInteractionBuffer(dto)};return BookingController}();Booking.BookingController=BookingController})(Booking||(Booking={}));;
var Booking;(function(Booking){var BookingRequestStatus;(function(BookingRequestStatus){BookingRequestStatus["OK"]="request_saved";BookingRequestStatus["PHONE_NOT_VERIFIED"]="not_verified";BookingRequestStatus["ERROR"]="error"})(BookingRequestStatus=Booking.BookingRequestStatus||(Booking.BookingRequestStatus={}));var BookingModel=function(){function BookingModel(view,leadSubmitService){this.view=view;this._beforeSubmit=$.Callbacks();this._afterSubmit=$.Callbacks();this._onSubmit=$.Callbacks();this.submitionCanceled=false;this.leadSubmitService=leadSubmitService;this.addListeners()}BookingModel.prototype.addListeners=function(){this.view.getForm().on("submit",this.onSubmit.bind(this))};BookingModel.prototype.onSubmit=function(event){event.preventDefault();this._beforeSubmit.fire(this);if(!this.submitionCanceled){this.submit(this.buildLead())}this.submitionCanceled=false};BookingModel.prototype.submit=function(lead){var _this=this;this._onSubmit.fire(this);this.leadSubmitService.submit(this.view.getFormAction(),lead,"json").then(function(response){_this.handleResponse(response)})};BookingModel.prototype.handleResponse=function(response){this._afterSubmit.fire(response,this)};BookingModel.prototype.buildLead=function(){var lead=this.createLead();return lead.build(this.view)};BookingModel.prototype.createLead=function(){return new Leads.BookingLead};BookingModel.prototype.beforeSubmit=function(callback){this._beforeSubmit.add(callback)};BookingModel.prototype.afterSubmit=function(callback){this._afterSubmit.add(callback)};BookingModel.prototype.onFormSubmit=function(callback){this._onSubmit.add(callback)};BookingModel.prototype.cancelSubmit=function(){this.submitionCanceled=true};BookingModel.prototype.getGtmData=function(){var gtmData=this.buildLead();gtmData["showroomName"]=this.view.getDealerTitle();gtmData["showroomAddress"]=this.view.getShowroomTitle();gtmData["cityName"]=this.view.getDealerCityTitle();gtmData["variantName"]=this.view.getVariantTitle();gtmData["price"]=this.view.getVariantMinPrice();return gtmData};return BookingModel}();Booking.BookingModel=BookingModel})(Booking||(Booking={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Booking;(function(Booking){var BUFFER_INTERACTION_MAP="analyticsInteractionCanonicalMap";var BookingView=function(_super){__extends(BookingView,_super);function BookingView($form,dataProxyService,cityService,userInfoService){var _this=_super.call(this,$form)||this;_this.analyticsCanonicalMap={name:"name",email:"email",phone:"phone",localityBlockModel:"bookingModelCity",bookingModelCity:"bookingModelCity",variantId:"modelVariant",modelVariant:"modelVariant",showroomId:"showroomId",showroom:"showroomId",terms:"terms"};_this.analyticsInteractionCanonicalMap={name:"Name",email:"Email",phone:"Phone",showroomId:"Dealer",showroom:"Dealer",localityBlockModel:"City",bookingModelCity:"City",terms:"terms",variantId:"modelVariant",modelVariant:"modelVariant"};_this.cityService=cityService;_this.userInfoService=userInfoService;_this.dataProxy=dataProxyService.getDataProxy();_this.title="";_this.selectedVariant=null;_this.modelSelectLocation=_this.createLocationView('[data-block="localityBlockModel"]');_this.initUserInfo();_this.addListeners();return _this}BookingView.isMobileDetect=function(){var mobileDetector=new MobileDetect(navigator.userAgent);return mobileDetector.mobile()};BookingView.prototype.getModelLocation=function(){return this.modelSelectLocation};BookingView.prototype.initDetectedCity=function(){var cityId=this.cityService.getCityId();this.updateVariants(cityId);this.updateShowrooms(cityId);if(this.cityService.getCityName()){this.setPriceCityName(this.cityService.getCityName())}};BookingView.prototype.createLocationView=function(selector){var _this=this;var result=new Forms.SelectLocationView(this,selector);result.addParameter("model",function(){return _this.getModelId()});result.addParameter("with_premium_showroom",function(){return true});return result};BookingView.prototype.setLoading=function(){this.$form.addClass("busy")};BookingView.prototype.unsetLoading=function(){this.$form.removeClass("busy")};BookingView.prototype.updateByDataSet=function(dataset){this.setBrandId(dataset.brandId);this.setModelId(dataset.modelId);this.setPartnerId(dataset.partnerId||0);if(BookingView.isMobileDetect()){this.setModelImage(dataset.modelImageSmall)}else{this.setModelImage(dataset.modelImage)}this.setTitle(dataset.title);this.setModelTitle(dataset.title);this.getSubmitButton().data("trackeventCategory",dataset.trackeventCategory);this.initDetectedCity()};BookingView.prototype.updateVariants=function(cityId){var _this=this;if(cityId){this.dataProxy.loadModelVariantWithPrices(this.getModelId(),cityId).done(function(variants){_this.renderVariants(variants)}).done(function(){_this.updatePrice()}).done(function(){if(_this.selectedVariant&&_this.selectedVariant!==_this.getVariantId()){_this.setVariantId(_this.selectedVariant);_this.getVariantDom().trigger("change")}})}else{this.renderVariants([])}};BookingView.prototype.onCitiesRendered=function(){};BookingView.prototype.onVariantsRendered=function(){};BookingView.prototype.renderVariants=function(variants){var $variantsDom=this.getVariantDom();$variantsDom.attr("disabled","disabled");$variantsDom.find("option").detach();for(var i in variants){var variant=variants[i];var $option=$("<option>"+variant.name+"</option>");$option.attr("value",variant.id);$option.attr("data-price-min",variant.min);$variantsDom.append($option)}$variantsDom.removeAttr("disabled");this.onVariantsRendered()};BookingView.prototype.addListeners=function(){var _this=this;this.modelSelectLocation.onChange(function(){_this.updateShowrooms(_this.modelSelectLocation.getCityId())});this.modelSelectLocation.onChange(function(){_this.updateVariants(_this.modelSelectLocation.getCityId())});this.getVariantDom().on("change",function(){_this.updatePrice()});this.getVariantDom().on("change",function(){_this.selectedVariant=_this.getVariantId()});this.getForm().on("autoportal.booking-form.popup.show",this.updateLocation.bind(this))};BookingView.prototype.updatePrice=function(){var $city=this.getModelCityDom().find(":selected");var price=Helper.Price.formatCrLac(this.getVariantMinPrice());this.setPriceCityName(this.modelSelectLocation.getCityName()||this.cityService.getCityName());this.setVariantPrice(price)};BookingView.prototype.getPostCode=function(){return this.modelSelectLocation.getPostCode()};BookingView.prototype.getLocalityId=function(){return this.modelSelectLocation.getLocalityId()};BookingView.prototype.getDealerCityId=function(){return this.modelSelectLocation.getCityId()};BookingView.prototype.getDealerCityTitle=function(){return this.modelSelectLocation.getCityName()};BookingView.prototype.setPriceCityName=function(city){this.$form.find('[data-booking="priceCityName"]').text(city)};BookingView.prototype.setVariantPrice=function(price){this.$form.find('[data-booking="variantPrice"]').text(price)};BookingView.prototype.updateShowrooms=function(cityId){var _this=this;if(cityId){this.dataProxy.loadPremiumDealersShowrooms(cityId,this.getBrandId(),this.getModelId()).done(function(showrooms){_this.renderShowrooms(showrooms)})}else{this.renderShowrooms([])}};BookingView.prototype.renderShowrooms=function(showrooms){var groups={};var $showroomDom=this.getShowroomDom();$showroomDom.find('option:not([value=""]), optgroup').detach();for(var i in showrooms){if(showrooms.hasOwnProperty(i)){var showroom=showrooms[i];if(!groups.hasOwnProperty(showroom.dealer_name)){groups[showroom.dealer_name]=$("<optgroup/>").attr("label",showroom.dealer_name)}var $option=$("<option/>").val(showroom.showroom_id).text(showroom.showroom_address).attr("data-dealer-id",showroom.showroom_dealer_id).attr("data-dealer-contact-name",showroom.dealer_contact_name);groups[showroom.dealer_name].append($option)}for(var index in groups){$showroomDom.append(groups[index])}}};BookingView.prototype.getShowroomDom=function(){return this.$form.find('[data-booking="showroom"]')};BookingView.prototype.renderCities=function(cities){this.renderModelCities(cities);this.renderDealerCities(cities);this.setDetectedCity()};BookingView.prototype.setDetectedCity=function(){var detectedCityId=this.getDefinedCityId();this.getDealerCityDom().val(detectedCityId);this.getModelCityDom().val(detectedCityId)};BookingView.prototype.getDefinedCityId=function(){return this.cityService.getCityId()};BookingView.prototype.renderDealerCities=function(cities){var $dealerCityDom=this.getDealerCityDom();$dealerCityDom.find("option").detach();for(var i in cities){if(cities.hasOwnProperty(i)){this.appendCity($dealerCityDom,cities[i])}}};BookingView.prototype.renderModelCities=function(cities){var $modelCityDom=this.getModelCityDom();$modelCityDom.find("option").detach();for(var i in cities){if(cities.hasOwnProperty(i)){this.appendCity($modelCityDom,cities[i])}}this.onCitiesRendered()};BookingView.prototype.appendCity=function($container,city){var $option=$("<option></option>");$option.text(city.name);$option.val(city.id);$option.attr("data-price-min",city.min);$option.attr("data-price-max",city.max);$container.append($option)};BookingView.prototype.getModelCityDom=function(){return this.$form.find('[data-booking="modelCity"]')};BookingView.prototype.getDealerCityDom=function(){return this.$form.find('[data-booking="dealerCity"]')};BookingView.prototype.setModelId=function(modelId){this.getModelIdDom().val(modelId)};BookingView.prototype.getModelId=function(){return parseInt(this.getModelIdDom().val())};BookingView.prototype.getModelIdDom=function(){return this.$form.find('[data-booking="modelId"]')};BookingView.prototype.setPartnerId=function(partnerId){this.getPartnerIdDom().val(partnerId)};BookingView.prototype.getPartnerId=function(){return this.getPartnerIdDom().val()};BookingView.prototype.getPartnerIdDom=function(){return this.$form.find('[data-booking="partnerId"]')};BookingView.prototype.setBrandId=function(brandId){this.getBrandIdDom().val(brandId)};BookingView.prototype.getBrandId=function(){return this.getBrandIdDom().val()};BookingView.prototype.getBrandIdDom=function(){return this.$form.find('[data-booking="brandId"]')};BookingView.prototype.getSourceId=function(){return this.getSourceIdDom().val()};BookingView.prototype.getSourceIdDom=function(){return this.$form.find('[data-booking="sourceId"]')};BookingView.prototype.setTitle=function(title){this.title=title};BookingView.prototype.getTitle=function(){return this.title};BookingView.prototype.getVariantTitle=function(){return this.getVariantDom().find(":selected").text()};BookingView.prototype.getVariantId=function(){return this.getVariantDom().find(":selected").val()};BookingView.prototype.setVariantId=function(id){this.getVariantDom().val(id)};BookingView.prototype.getVariantMinPrice=function(){return parseFloat(this.getVariantDom().find(":selected").data("priceMin"))};BookingView.prototype.getVariantDom=function(){return this.$form.find('[data-booking="modelVariant"]')};BookingView.prototype.getSubmitButton=function(){return this.$form.find('[type="submit"]')};BookingView.prototype.setModelImage=function(imageSource){var _this=this;var img=new Image;img.onload=function(){_this.getModelImageDom().attr("src",imageSource)};img.src=imageSource};BookingView.prototype.getModelImageDom=function(){return this.$form.find('[data-booking="modelImage"]')};BookingView.prototype.setModelTitle=function(title){this.$form.find('[data-booking="modelTitle"]').html(title)};BookingView.prototype.getFormAction=function(){return this.$form.attr("action")};BookingView.prototype.getUserPhoneDom=function(){return this.$form.find('[data-booking="userPhone"]')};BookingView.prototype.getUserPhone=function(){return this.getUserPhoneDom().val()};BookingView.prototype.setUserPhone=function(phone){this.getUserPhoneDom().val(phone)};BookingView.prototype.getUserName=function(){return this.$form.find('[data-booking="userName"]').val()};BookingView.prototype.getUserEmail=function(){return this.$form.find('[data-booking="userEmail"]').val()};BookingView.prototype.setUserName=function(value){return this.$form.find('[data-booking="userName"]').val(value)};BookingView.prototype.setUserEmail=function(value){return this.$form.find('[data-booking="userEmail"]').val(value)};BookingView.prototype.getTermsDom=function(){return this.$form.find('[data-booking="terms"]')};BookingView.prototype.getTerms=function(){return this.$form.find('[data-booking="terms"]').is(":checked")};BookingView.prototype.getPriority=function(){return this.getRequestPriorityDom().val()};BookingView.prototype.setPriority=function(priority){this.getRequestPriorityDom().val(priority)};BookingView.prototype.getRequestPriorityDom=function(){return this.$form.find('[data-booking="requestPriority"]')};BookingView.prototype.getShowroomId=function(){return this.getShowroomDom().val()};BookingView.prototype.getShowroomTitle=function(){return this.getShowroomDom().find(":selected").text().trim()};BookingView.prototype.getDealerId=function(){return this.getShowroomDom().find(":selected").data("dealerId")};BookingView.prototype.getLocation=function(){return this.modelSelectLocation.getSelectedValue()};BookingView.prototype.getModelVariant=function(){return this.$form.find('[name="modelVariant"]').val()};BookingView.prototype.getDealerTitle=function(){return this.getShowroomDom().find(":selected").parent("optgroup").attr("label")};BookingView.prototype.getDealerContactName=function(){return this.getShowroomDom().find(":selected").data("dealerContactName")};BookingView.prototype.initUserInfo=function(){this.setUserPhone(this.userInfoService.getPhone());this.setUserEmail(this.userInfoService.getEmail());this.setUserName(this.userInfoService.getName())};BookingView.prototype.updateLocation=function(){this.getModelLocation().restore(this.userInfoService.getLocation(),true)};BookingView.prototype.getAnalyticsCanonicalName=function($element,mapName){if(mapName===void 0){mapName=""}var nameProperty=$element.attr("name");var map=this.analyticsCanonicalMap;if(mapName===BUFFER_INTERACTION_MAP){map=this.analyticsInteractionCanonicalMap}if(map.hasOwnProperty(nameProperty)){return map[nameProperty]}return null};BookingView.prototype.getFormFieldsStateDto=function(){var dto={},formFields=this.$form.find(":input"),self=this;$.each(formFields,function(){var $element=$(this),nameProperty=$element.attr("name");if(!nameProperty){nameProperty=$element.data("canonicalName")}if(self.analyticsInteractionCanonicalMap.hasOwnProperty(nameProperty)){var empty=!Boolean($element.val()),name_1=self.analyticsInteractionCanonicalMap[nameProperty];if(name_1==="City"){empty=!Boolean(self.userInfoService.getLocation().getCityId())}if(!dto.hasOwnProperty(name_1)){dto[name_1]={name:name_1,empty:empty}}}});return dto};BookingView.prototype.isFormVisible=function(){return this.$form.is(":visible")};return BookingView}(General.FormView);Booking.BookingView=BookingView})(Booking||(Booking={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Booking;(function(Booking){var BookingValidator=function(_super){__extends(BookingValidator,_super);function BookingValidator(){return _super!==null&&_super.apply(this,arguments)||this}BookingValidator.prototype.getRules=function(){return{name:{required:true,autoportalName:true},email:{required:true,email:true,emailNoTopLevelDomains:true},phone:{required:true,sellCarPhone:true},terms:"required",bookingModelCity:{required:true,requiredLocationAutocompleteCity:true},modelVariant:"required",showroom:"required"}};BookingValidator.prototype.getMessages=function(){return{name:"Please enter valid Name.",email:"Please enter valid Email.",phone:"Please enter valid Number.",terms:"Please agree with Terms and Conditions.",bookingModelCity:"Please Enter Valid Location.",modelVariant:"Please select variant.",showroom:"Please select Dealer."}};return BookingValidator}(General.FormValidator);Booking.BookingValidator=BookingValidator})(Booking||(Booking={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Booking;(function(Booking){var SmsVerification=function(_super){__extends(SmsVerification,_super);function SmsVerification(){return _super!==null&&_super.apply(this,arguments)||this}SmsVerification.prototype.resetForm=function(){_super.prototype.resetForm.call(this);this.hideOtpErrorMessage()};SmsVerification.prototype.onSubmit=function(event){_super.prototype.onSubmit.call(this,event);this.hideOtpErrorMessage()};SmsVerification.prototype.buildData=function(){return{phone:this.phone,code:this.getVerificationCodeElement().val()}};SmsVerification.prototype.updateByDataSet=function(dataset){this.getChangePhoneElement().attr("data-trackevent-label",dataset.title)};SmsVerification.prototype.getSubmitElement=function(){return this.$form.find('[data-action="submitVerifyCode"]')};SmsVerification.prototype.getResendElement=function(){return this.$form.find('[data-action="resendVerifyCode"]')};SmsVerification.prototype.getChangePhoneElement=function(){return this.$form.find('[data-action="changePhone"]')};SmsVerification.prototype.getSavePhoneElement=function(){return this.$form.find('[data-action="changePhoneConfirm"]')};SmsVerification.prototype.getPhoneNoInputElement=function(){return this.$form.find('[data-field="verificationPhoneNumber"]')};SmsVerification.prototype.getSkipNotificationElement=function(){return this.$form.find('[data-action="resendSkip"]')};SmsVerification.prototype.getVerifyPhoneNoElement=function(){return this.$form.find('[data-field="verificationUserPhone"]')};SmsVerification.prototype.onSkipLink=function(){};return SmsVerification}(Form.AbstractSmsVerifyForm);Booking.SmsVerification=SmsVerification})(Booking||(Booking={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Leads;(function(Leads){var BookingLead=function(_super){__extends(BookingLead,_super);function BookingLead(){return _super!==null&&_super.apply(this,arguments)||this}BookingLead.prototype.build=function(view){return{brand_id:""+view.getBrandId(),city_id:""+view.getDealerCityId(),dealer_id:""+view.getDealerId(),email:""+view.getUserEmail(),model_id:""+view.getModelId(),name:""+view.getUserName(),partner_id:""+view.getPartnerId(),phone:""+view.getUserPhone(),priority:""+view.getPriority(),request_type:"Booking",terms:""+view.getTerms(),showroom_id:""+view.getShowroomId(),variant_id:""+view.getVariantId(),locality:""+view.getLocalityId(),postcode:""+view.getPostCode(),source_id:""+view.getSourceId()}};return BookingLead}(Leads.Lead);Leads.BookingLead=BookingLead})(Leads||(Leads={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GTM;(function(GTM){var BookingGtmPopup=function(_super){__extends(BookingGtmPopup,_super);function BookingGtmPopup(service,dispatcher){var _this=_super.call(this,service,dispatcher)||this;_this.attachEventListeners();return _this}BookingGtmPopup.prototype.attachEventListeners=function(){this.eventDispatcher.subscribe("BookingPopup:leadSaved",this.onLeadSavedCallback.bind(this));this.eventDispatcher.subscribe("BookingPopup:leadVerifiedSaved",this.onVerifiedSavedCallback.bind(this));this.eventDispatcher.subscribe("BookingPopup:leadVerifiedSavedNew",this.onVerifiedSavedNewCallback.bind(this));this.eventDispatcher.subscribe("BookingPopup:formSubmit",this.onFormSubmitCallback.bind(this))};BookingGtmPopup.prototype.onLeadSavedCallback=function(event){this.gtmService.pushData(this.withUserId({event:"BK_Lead_Saved"}))};BookingGtmPopup.prototype.onVerifiedSavedCallback=function(event){this.gtmService.pushData(this.withUserId({event:"BK_Lead_Verified_Saved"}))};BookingGtmPopup.prototype.onVerifiedSavedNewCallback=function(event){this.gtmService.pushData(this.withUserId({event:"BK_Lead_Verified_Saved_New"}))};BookingGtmPopup.prototype.onFormSubmitCallback=function(event){};return BookingGtmPopup}(GTM.GtmPage);GTM.BookingGtmPopup=BookingGtmPopup})(GTM||(GTM={}));;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){$('[data-type="booking"]').on("click",function(e){e.preventDefault();container.get("event_dispatcher").publish("bookingButton:click",this.dataset)})});;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){var showPriceQuotesPopup=function(event){var isModelChange=function(data){var modelId=data.dataset.modelId;var cdpModelValue=$('[data-price-quotes="modelId"]').val();if(cdpModelValue){return cdpModelValue!=modelId}return false};event.preventDefault();var cookieStorage=new Storages.CookieStorage;cookieStorage.set("snsShowedOnce",1);if(isModelChange(this)){$('[data-price-quotes="modelId"]').attr("data-is-changed",true);$('[data-price-quotes="variantId"]').val("").change()}$('[data-price-quotes="modelId"]').val(this.dataset.modelId);$('[data-price-quotes="modelPath"]').val(this.dataset.modelPath);$('[data-price-quotes="brandId"]').val(this.dataset.brandId);$('[data-price-quotes="brandPath"]').val(this.dataset.brandPath);$('[data-price-quotes="mode"]').val(this.dataset.mode);$('[data-price-quotes="partnerId"]').val(this.dataset.partnerId);$('[data-price-quotes="trackeventCategory"]').val(this.dataset.priceQuoteTrackeventCategory);$('[data-price-quotes="trackeventLabel"]').val(this.dataset.priceQuoteTrackeventLabel);if(this.dataset.variantId){$('[data-price-quotes="variantId"]').val(this.dataset.variantId).change()}container.get("event_dispatcher").publish("priceQuotes:open",event)};$('[data-type="gorp_models"]').on("click",'[data-type="price-quotes"]',showPriceQuotesPopup);$('[data-type="price-quotes"]').on("click",showPriceQuotesPopup)});;
var Forms;(function(Forms){var PriceQuoteStep;(function(PriceQuoteStep){PriceQuoteStep[PriceQuoteStep["CityChoice"]="city-choice"]="CityChoice";PriceQuoteStep[PriceQuoteStep["FormSMS"]="form-sms"]="FormSMS";PriceQuoteStep[PriceQuoteStep["PersonalDetails"]="personal-details"]="PersonalDetails";PriceQuoteStep[PriceQuoteStep["Dealers"]="dealers"]="Dealers";PriceQuoteStep[PriceQuoteStep["Thanks"]="thanks-step"]="Thanks";PriceQuoteStep[PriceQuoteStep["PhoneVerification"]="phone-verification"]="PhoneVerification"})(PriceQuoteStep=Forms.PriceQuoteStep||(Forms.PriceQuoteStep={}));var PriceQuoteRequestStatus;(function(PriceQuoteRequestStatus){PriceQuoteRequestStatus[PriceQuoteRequestStatus["OK"]="ok"]="OK";PriceQuoteRequestStatus[PriceQuoteRequestStatus["ERROR"]="error"]="ERROR"})(PriceQuoteRequestStatus=Forms.PriceQuoteRequestStatus||(Forms.PriceQuoteRequestStatus={}));var GAHelper=function(){function GAHelper(){}GAHelper.getCloseEventAction=function(step){switch(step){case PriceQuoteStep.CityChoice:return"CDP - FormConfirmLocation - Close";case PriceQuoteStep.PersonalDetails:return"CDP - Form - personal-details - Close";case PriceQuoteStep.FormSMS:return"CDP - FormSMS - Close";case PriceQuoteStep.Dealers:return"CDP - Form-Dealers - Close"}};GAHelper.getNextStepEventAction=function(step){switch(step){case PriceQuoteStep.CityChoice:return"CDP - Form - city-choice";case PriceQuoteStep.PersonalDetails:case PriceQuoteStep.Dealers:return"CDP lead"}};return GAHelper}();var PriceQuotesController=function(){function PriceQuotesController(container,popup,sorryPopup){this.$form=popup.getForm();this.dataProxy=container.get("data_proxy_service");this.popup=popup;this.container=container;this.sorryPopup=sorryPopup;this.isMobile=container.get("mobile_detect").mobile();this.view=new Forms.PriceQuotesView(this.$form,this.dataProxy,this.sorryPopup,container.get("city_detect"),container.get("event_dispatcher"),container.get("ga"));this.model=new Forms.PriceQuotesModel(this.view);this.validator=new Forms.PriceQuotesValidator(this.view);this.validator.init();this.eventDispatcher=container.get("event_dispatcher");this.smsVerification=new PriceQuotes.SmsVerification(container);this.cityService=container.get("city_detect");this.router=container.get("router");this.ga=container.get("ga");this.userInfo=container.get("user_info_service");this.notificationService=container.get("notification_service");this.store=container.get("price_quote_data_service");this.step="city-choice";this.saveLink="/price-quotes/save-";this.popupService=container.get("popup_service");this._onStepChange=$.Callbacks();this.skipValidation=false;this.stateId="";this.cityId="";this.localityId="";this.postcode="";this.cityName="";this.cityPath="";this.localityName="";this.gtmService=this.container.get("gtm_service");this.init()}PriceQuotesController.prototype.setCalleeButton=function($calleeButton){this.$calleeButton=$calleeButton};PriceQuotesController.prototype.onStepChange=function(callback){this._onStepChange.add(callback)};PriceQuotesController.prototype.onEditCity=function(){this.saveCityData();this.view.disablePersonalDetailsForm();this.view.getCurrentLocationBlock().hide();this.view.getEditLocationBlock().show()};PriceQuotesController.prototype.onEditCityMobile=function(){this.saveCityData();this.view.enableFocusedCityEdit();this.view.getEditCityTitleDom().show();this.view.getPersonalDetailsMainTitleDom().hide();this.view.getCurrentLocationBlock().hide();this.view.getEditLocationBlock().show()};PriceQuotesController.prototype.onEditLocationMobile=function(){this.view.enableFocusedLocationEdit()};PriceQuotesController.prototype.getView=function(){return this.view};PriceQuotesController.prototype.goToStep=function(step){var errors=new Core.Collection;this._onStepChange.fire(step,errors);var mode=this.view.getMode();this.view.disableNextStep();var enableNext=true;if(mode=="price-quotes"){this.removePopupSmallClass();if(step=="thanks-step"){this.goToSuccessPage()}else if(errors.isEmpty()){this.view.displayHeader(step);if(step=="dealers"){enableNext=false;this.view.setDealersMessage()}this.view.goToStep(step)}else if(errors.getValues().indexOf("NotAllowedCity")!=-1){this.goToSorryStep()}}else if(mode=="gop"){this.gopAction()}else{this.removePopupSmallClass();if(step=="thanks-step"){this.goToSuccessStep()}else{this.view.displayHeader(step);if(step=="dealers"){this.view.setDealersMessage()}this.view.goToStep(step)}}if(enableNext){this.view.enableNextStep()}};PriceQuotesController.prototype.addPopupSmallClass=function(){var $popupContainer=$(this.popup.getContainer());$popupContainer.addClass("pricequotes-popup-sm")};PriceQuotesController.prototype.removePopupSmallClass=function(){var $popupContainer=$(this.popup.getContainer());$popupContainer.removeClass("pricequotes-popup-sm")};PriceQuotesController.prototype.goToSorryStep=function(){this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close();this.step="city-choice";this.reset();this.popupService.showPopup("sorry-price-quotes")};PriceQuotesController.prototype.goToSuccessStep=function(){this.view.setThanksMessage();this.view.displayHeader("thanks-step");this.view.goToStep("thanks-step")};PriceQuotesController.prototype.goToSuccessPage=function(){var url=this.getSuccessPageUrl();this.doRedirect(url)};PriceQuotesController.prototype.openPopupOnPersonalDetailStep=function(button){this.tryRestoreCity(button);this.saveCityData();this.view.updateLocationOrPostcodeSearchCity(Number(this.cityId));this.goToPersonalDetailStep()};PriceQuotesController.prototype.goToPersonalDetailStep=function(){var _this=this;if(this.step===PriceQuoteStep.CityChoice){this.saveData(this.saveLink+this.step+"/").done(function(response){if(!response.data.goToSorryStep){_this.popup.open()}})}else{this.popup.open()}};PriceQuotesController.prototype.gopAction=function(){if(!this.view.getCityId()){this.tryRestoreCity()}var errors=new Core.Collection;this._onStepChange.fire("personal-details",errors);if(errors.getValues().indexOf("NotAllowedCity")!=-1){this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close();this.step="city-choice";this.view.saveCity();this.container.setParameter("cityId",this.view.getCityId());this.$calleeButton.closest("[data-hidden-gop-container]").find(".hidden_gop").click()}else{this.setDataToStore();window.location.href=this.router.generate("catalog~CGOnRoadPrice",{catalogPath:"newcars",brandPath:this.view.getBrandPath(),modelPath:this.view.getModelPath(),cityPath:this.view.getCityPath()})}};PriceQuotesController.prototype.tryRestoreCity=function($button){var cityId,cityPath,cityName;if($button&&$button.data("cityId")&&$button.data("cityPath")&&$button.data("cityName")){cityId=$button.data("cityId");cityPath=$button.data("cityPath");cityName=$button.data("cityName")}else{cityId=this.cityService.getCityId();cityPath=this.cityService.getCityPath();cityName=this.cityService.getCityName()}this.view.setCityId(cityId);this.view.setCityPath(cityPath);this.view.setCityName(cityName);this.view.setLocalityTitle(cityName)};PriceQuotesController.prototype.init=function(){this.handleSmsVerification();this.handleView();this.handleValidation()};PriceQuotesController.prototype.saveUserData=function(){this.userInfo.setEmail(this.view.getUserEmail());this.userInfo.setName(this.view.getUserName());this.userInfo.setPhone(this.view.getUserPhone());this.userInfo.saveClientId()};PriceQuotesController.prototype.handleView=function(){var _this=this;this.view.beforeNextStep(function(){if(_this.validator.validate()||_this.skipValidation){_this.skipValidation=false;_this.saveData(_this.saveLink+_this.step+"/");_this.onNextStep()}});this.view.beforeNextStep(function(){if((_this.validator.validate()||_this.skipValidation)&&_this.step=="personal-details"){_this.saveUserData()}});this.view.beforeClose(function(){var step=_this.getGaStep();var gaAction=GAHelper.getCloseEventAction(step);if(gaAction){_this.sendGaEvent(gaAction)}if(_this.step=="thanks-step"){_this.reset()}});this.view.beforeEditLocation(function(){_this.saveCityData();_this.view.updateVariantView();_this.editLocation(_this.saveLink+"edit-location/")});this.view.beforeEditLocationExit(function(){if(_this.view.getEditLocationBlock().is(":visible")){_this.restoreCityData();_this.view.clearEditLocationFields();_this.view.getEditLocationBlock().hide();_this.view.getCurrentLocationBlock().show();_this.enablePersonalDetailsForm()}});this.popup.onOpen(function(){if(_this.view.isModelChanged()){_this.step=PriceQuoteStep.CityChoice;_this.view.setModelChanged(false);_this.view.destroyVariantView();_this.model=new Forms.PriceQuotesModel(_this.view);_this.goToPersonalDetailStep()}_this.restoreUserInfo()});this.eventDispatcher.subscribe("priceQuote:BackButton:click",this.onBackButtonClick.bind(this));this.addEditLocationListeners()};PriceQuotesController.prototype.enablePersonalDetailsForm=function(){if(this.isMobile){this.view.enablePersonalDetailsFormMobile()}else{this.view.enablePersonalDetailsForm()}};PriceQuotesController.prototype.restoreUserInfo=function(){this.view.setUserPhone(this.userInfo.getPhone());this.view.setUserEmail(this.userInfo.getEmail());this.view.setUserName(this.userInfo.getName())};PriceQuotesController.prototype.handleValidation=function(){var _this=this;this.validator.onFormValid(function(){if(!_this.isSmsVerificationActive()&&!_this.isLocationChangeActive()&&!(_this.step=="dealers"&&!_this.view.isDealerChoosed())){_this.view.enableNextStep()}});this.validator.onFormInvalid(function(){_this.view.disableNextStep()})};PriceQuotesController.prototype.isSmsVerificationActive=function(){return this.smsVerification.isOpened()};PriceQuotesController.prototype.isLocationChangeActive=function(){return this.step=="personal-details"&&this.view.getEditLocationBlock().is(":visible")};PriceQuotesController.prototype.handleSmsVerification=function(){var _this=this;this.smsVerification.init({namespace:"sms_verify_"+this.$form.prop("name"),$form:this.$form.find("[data-sms-verification-block]")});var smsVerifyNamespace=this.smsVerification.getNamespace();this.eventDispatcher.subscribe(smsVerifyNamespace+":updatePhone",function(){var phone=_this.smsVerification.getPhone();_this.view.setUserPhone(phone);_this.view.enableNextStep();_this.saveData(_this.saveLink+_this.step+"/");_this.saveUserData()});this.eventDispatcher.subscribe(smsVerifyNamespace+":success",function(){_this.ga.sendEvent("Model","CDP - FormSms","Verify Code");_this.smsVerification.showElements("Verified");_this.view.enableNextStep();_this.saveUserData();setTimeout(function(){_this.saveData(_this.saveLink+_this.step+"/");_this.smsVerification.hide()},750)});this.eventDispatcher.subscribe(smsVerifyNamespace+":fail",function(){_this.smsVerification.showElements("NotVerified");_this.view.disableNextStep()})};PriceQuotesController.prototype.getLeadData=function(){return this.model.getLead()};PriceQuotesController.prototype.saveData=function(step){this.view.disableNextStep();return $.post(step,this.getLeadData(),this.getCallback()).always(function(){})};PriceQuotesController.prototype.editLocation=function(step){return $.post(step,this.getLeadData(),this.getEditLocationCallback())};PriceQuotesController.prototype.getEditLocationCallback=function(){var _this=this;return function(response){var data=response.data;if(data.goToSorryStep){_this.goToSorryStep();_this.reset()}else{var showrooms=data.showrooms;_this.view.addShowrooms(showrooms);_this.view.renderShowrooms();_this.view.enableNextStep()}_this.view.getEditLocationBlock().hide();_this.view.getCurrentLocationBlock().show();_this.enablePersonalDetailsForm()}};PriceQuotesController.prototype.getCallback=function(){var _this=this;return function(response){switch(true){case response.status===PriceQuoteRequestStatus.ERROR:_this.notificationService.alert(response.message);break;case response.status===PriceQuoteRequestStatus.OK:var data=response.data;_this.step=data.nextStep;_this.view.setLeadId(data.leadId);var showrooms=data.showrooms;_this.leadHash=data.leadHash;if(_this.step===PriceQuoteStep.PersonalDetails&&showrooms){if(data.goToSorryStep){_this.goToSorryStep()}else{_this.view.addShowrooms(showrooms);_this.goToStep(_this.step)}}else if(_this.step===PriceQuoteStep.Thanks&&showrooms){_this.goToStep(_this.step)}else{switch(data.status){case"request_saved":_this.gtmService.pushData({event:"CDP - Form - personal-details"});_this.goToStep(_this.step);break;case"not_verified":_this.goToStep(PriceQuoteStep.PhoneVerification);_this.initPhoneVerificationStep();break;default:_this.goToStep(_this.step)}}break}}};PriceQuotesController.prototype.setDataToStore=function(){this.store.setCityId(this.view.getCityId());this.store.setCityPath(this.view.getCityPath());this.store.setCityName(this.view.getCityName());this.store.setStateId(this.view.getStateId());this.store.setPostcode(this.view.getPostcode());this.store.setLocalityId(this.view.getLocalityId());this.store.setLocalityTitle(this.view.getCityTitle());this.saveVariantId()};PriceQuotesController.prototype.saveVariantId=function(){var variantId="";if(this.view.getHiddenVariantId()){variantId=this.view.getHiddenVariantId()}this.dataProxy.getDataProxy().set("gopVariantId",{value:variantId})};PriceQuotesController.prototype.reset=function(){this.step="city-choice";this.addPopupSmallClass();this.smsVerification.reset();this.smsVerification.hide();this.view.destroyVariantView();this.view.showContinueButton();this.eventDispatcher.publish("priceQuote:reset");this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close()};PriceQuotesController.prototype.initPhoneVerificationStep=function(){this.setPhoneValueForVerificationStep();this.smsVerification.start(this.view.getUserPhone(),this.view.getUserName());this.view.showEditUserPhone(true);this.view.disableUserPhone()};PriceQuotesController.prototype.saveCityData=function(){this.stateId=this.view.getStateId();this.cityId=this.view.getCityId();this.localityId=this.view.getLocalityId();this.postcode=this.view.getPostcode();this.cityName=this.view.getCityName();this.cityPath=this.view.getCityPath();this.localityName=this.view.getCityTitle()};PriceQuotesController.prototype.restoreCityData=function(){this.view.setStateId(this.stateId);this.view.setCityId(this.cityId);this.view.setLocalityId(this.localityId);this.view.setPostcode(this.postcode);this.view.setCityName(this.cityName);this.view.setCityPath(this.cityPath);this.view.setLocalityTitle(this.localityName)};PriceQuotesController.prototype.onNextStep=function(){this.savePreviousStep();var step=this.getGaStep();var gaAction=GAHelper.getNextStepEventAction(step);if(gaAction){this.sendGaEvent(gaAction)}};PriceQuotesController.prototype.getGaStep=function(){return this.isSmsVerificationActive()?PriceQuoteStep.FormSMS:this.step};PriceQuotesController.prototype.sendGaEvent=function(gaAction){this.ga.sendEvent(this.view.getTrackeventCategory(),gaAction,this.view.getTrackeventLabel())};PriceQuotesController.prototype.doRedirect=function(url){window.location.href=url};PriceQuotesController.prototype.getSuccessPageUrl=function(){var hash=this.leadHash;var brandPath=this.view.getBrandPath();var modelPath=this.view.getModelPath();return this.router.generate("price_quotes_result",{brandPath:brandPath,modelPath:modelPath,hash:hash})};PriceQuotesController.prototype.setPhoneValueForVerificationStep=function(){this.view.setUserPhone(this.view.getHiddenUserPhoneDom().val())};PriceQuotesController.prototype.onBackButtonClick=function(){this.step=this.previousStep;this.previousStep="";this.goToStep(this.step)};PriceQuotesController.prototype.savePreviousStep=function(){if(PriceQuoteStep.PhoneVerification==this.step){this.previousStep=PriceQuoteStep.PersonalDetails}else{this.previousStep=this.step}};PriceQuotesController.prototype.addEditLocationListeners=function(){if(this.isMobile){this.eventDispatcher.subscribe("priceQuote:editCity",this.onEditCityMobile.bind(this));this.eventDispatcher.subscribe("priceQuote:editLocation",this.onEditLocationMobile.bind(this))}else{this.eventDispatcher.subscribe("priceQuote:editCity",this.onEditCity.bind(this))}};return PriceQuotesController}();Forms.PriceQuotesController=PriceQuotesController})(Forms||(Forms={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Forms;(function(Forms){var PriceQuotesValidator=function(_super){__extends(PriceQuotesValidator,_super);function PriceQuotesValidator(){return _super!==null&&_super.apply(this,arguments)||this}PriceQuotesValidator.prototype.getIgnore=function(){return':hidden:not([name="price_quotes_type[showrooms]"], [name="cityId"])'};PriceQuotesValidator.prototype.getRules=function(){return{"price_quotes_type[city]":{required:true},"price_quotes_type[location-or-postcode]":{relatedInputRequired:{wrapperSelector:"[data-location-autocomplete-wrapper]",inputSelector:'[data-price-quotes="localityId"]'},required:true},"price_quotes_type[name]":{required:true,alphanumeric:true,maxlength:64},"price_quotes_type[email]":{required:false,email:true},"price_quotes_type[phone]":{required:true,autoportalPhone:true},terms:{required:true},purchaseDate:{required:true},cityId:{required:function(){return!!$('[name="price_quotes_type[address]"]').val()}},locationOrPostcode:{required:function(){return!!$('[name="price_quotes_type[location-or-postcode]"]').val()}}}};PriceQuotesValidator.prototype.getMessages=function(){return{"price_quotes_type[city]":{required:"Please Enter Valid City"},"price_quotes_type[location-or-postcode]":{required:"Please Enter Valid Location or Pin code",relatedInputRequired:"Please Enter Valid Location or Pin code"},"price_quotes_type[name]":{alphanumeric:"Please Enter Valid Name",required:"Please Enter Name"},"price_quotes_type[email]":{alphanumeric:"Please Enter Valid Mail"},"price_quotes_type[phone]":{alphanumeric:"Please Enter Valid Phone",required:"Please Enter Phone"},terms:{required:"Please agree with Terms and Conditions."},purchaseDate:{required:"Please choose Purchase Period"},cityId:{required:"Please Enter Valid Location"}}};return PriceQuotesValidator}(General.FormValidator);Forms.PriceQuotesValidator=PriceQuotesValidator})(Forms||(Forms={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Forms;(function(Forms){var PriceQuotesView=function(_super){__extends(PriceQuotesView,_super);function PriceQuotesView($form,dataProxyService,sorryPopup,cityService,eventDispatcher,ga){var _this=_super.call(this,$form)||this;_this.showrooms=[];_this._beforeNextStep=$.Callbacks();_this._beforeClose=$.Callbacks();_this._beforeEditLocation=$.Callbacks();_this._beforeEditLocationExit=$.Callbacks();_this.dataProxy=dataProxyService.getDataProxy();_this.sorryPopup=sorryPopup;_this.delayTime=1800;_this.skipPhone=false;_this.cityService=cityService;_this.eventDispatcher=eventDispatcher;_this.ga=ga;_this.variantView=new Forms.VariantView(_this);_this.addListeners();return _this}PriceQuotesView.prototype.getVariantContainer=function(){return this.getForm().find("[data-variant-container]")};PriceQuotesView.prototype.addListeners=function(){var _this=this;this.getNextStepButtons().on("click",function(event){if(event){event.preventDefault();_this.getTrackeventLabelDom().val($(event.currentTarget).data("trackeventLabel"));_this._beforeNextStep.fire(_this)}});this.getCloseButtons().on("click",function(event){if(event){event.preventDefault();_this._beforeClose.fire(_this)}});this.getSorryPopupGopButton().on("click",function(){_this.saveCity();_this.resetHiddenData();_this.animatePopupClose();_this.reloadPage()});this.getVariantDom().on("change",function(){var variantId=parseInt(_this.getVariantDom().val());if(variantId&&_this.variantView.initialized()){_this.variantView.renderVariant(variantId,_this.getCityId(),_this.getVariantContainer());_this.setHiddenVariantId(variantId);_this.renderShowrooms(variantId);var previousVariantId=parseInt(_this.getVariantDom().data("previousVariant"));if(previousVariantId!==variantId){_this.getVariantDom().data("previousVariant",variantId)}}});this.addShowroomSelectAllDomClickEventListener();this.addShowroomDomClickEventListener();this.attachSmsVerifyEvents();this.eventDispatcher.subscribe("priceQuote:reset",function(){_this.saveCity();_this.reset();_this.resetHiddenData();_this.destroyVariantView();_this.displayHeader(null);_this.enableUserPhone();_this.showEditUserPhone(false);_this.goToStep("city-choice")});this.addExitFromCityEditListeners();this.addBackButtonListener();this.addCityChangeListener();this.addLocationChangeListener()};PriceQuotesView.prototype.sendVariantChangeGaEvent=function(){var variantName=this.getVariantDom().find(":selected").data("name");this.ga.sendEvent(this.getTrackeventCategory(),"CDP - Change variant",this.getTrackeventLabel()+" "+variantName)};PriceQuotesView.prototype.showEditUserPhone=function(edit){var $wrapper=this.getUserPhoneDom().closest("[data-phone-wrapper]");if(edit){$wrapper.addClass("change_phone")}else{$wrapper.removeClass("change_phone")}};PriceQuotesView.prototype.attachSmsVerifyEvents=function(){var _this=this;this.getChangePhoneDom().on("click",function(){_this.enableUserPhone();_this.getChangePhoneDom().hide();_this.getConfirmChangePhoneDom().show()});this.getConfirmChangePhoneDom().on("click",function(){_this.getUserPhoneDom().trigger("change");_this.disableUserPhone();_this.getChangePhoneDom().show();_this.getConfirmChangePhoneDom().hide();_this.updateSelectedPhoneAtPresonalDetails();_this.eventDispatcher.publish("priceQuote:confirmPhone",{phone:_this.getUserPhoneDom().val()})});this.getUserPhoneDom().on("focusin",function(){_this.getUserPhoneDom().data("previousValue",_this.getUserPhoneDom().val())}).on("change",function(){if(!_this.getUserPhoneDom().valid()){var previousValue=_this.getUserPhoneDom().data("previousValue");_this.getUserPhoneDom().val(previousValue)}}).on("blur",function(){_this.getUserPhoneDom().trigger("change");if(_this.getConfirmChangePhoneDom().is(":visible")){_this.getConfirmChangePhoneDom().trigger("click")}})};PriceQuotesView.prototype.animatePopupClose=function(){var $dom=$(this.sorryPopup.getContainer());var $selectCityButton=$("[data-city-detect-button]");var buttonCenterX=$selectCityButton.offset().left+$selectCityButton.width()/2;$dom.css({transformOriginX:buttonCenterX}).addClass("close")};PriceQuotesView.prototype.reloadPage=function(){setTimeout(function(){window.location.reload(true)},this.delayTime)};PriceQuotesView.prototype.displayHeader=function(step){this.getForm().find("[data-header]").hide();this.getForm().find('[data-header="'+step+'"]').show()};PriceQuotesView.prototype.destroyVariantView=function(){this.variantView.destroy()};PriceQuotesView.prototype.saveCity=function(){var storage=new Storages.CookieStorage;var cookieSettings={path:"/",expires:365};this.getCityPath()?storage.set("city",this.getCityPath(),cookieSettings):"";this.getCityId()?storage.set("cityId",this.getCityId(),cookieSettings):"";this.getCityName()?storage.set("cityName",this.getCityName(),cookieSettings):"";storage.set("cityIsConfirmed",1,cookieSettings)};PriceQuotesView.prototype.purchasePeriodChangeEventListener=function(){var _this=this;this.getPurchasePeriodDom().on("change",function(event){_this.refreshNextStepAtDealersStep()})};PriceQuotesView.prototype.addShowroomSelectAllDomClickEventListener=function(){var _this=this;this.getShowroomsSelectAllDom().on("click",function(event){var $element=$(event.currentTarget);$element.toggleClass("active");if($element.hasClass("active")){_this.getShowroomsInputDom().prop("checked",true)}else{_this.getShowroomsInputDom().prop("checked",false)}_this.refreshNextStepAtDealersStep()})};PriceQuotesView.prototype.addShowroomDomClickEventListener=function(){var _this=this;this.getShowroomsInputDom().on("change",function(e){var $target=$(e.target);if(!$target.is(":checked")){_this.ga.sendEvent("Model","CDP - Form-Dealers",_this.getTrackeventLabel())}});this.getShowroomsInputDom().on("click",function(event){_this.refreshNextStepAtDealersStep();if(_this.isAllDealersChoosed()){_this.getShowroomsSelectAllDom().addClass("active")}if(_this.isNotAllDealersChoosed()){_this.getShowroomsSelectAllDom().removeClass("active")}})};PriceQuotesView.prototype.refreshNextStepAtDealersStep=function(){this.enableNextStep();if(!this.isDealerChoosed()){this.disableNextStep()}};PriceQuotesView.prototype.updateVariants=function(){var _this=this;this.dataProxy.loadModelVariantWithPrices(this.getModelId(),this.getCityId()).done(function(variants){_this.variantsWithPrice=[];$.each(_this.showrooms,function(index,showroom){var lmsVariants=Object.keys(showroom.onRoadPrices);_this.variantsWithPrice=_this.variantsWithPrice.concat(lmsVariants)});_this.renderVariants(variants)}).done(function(){if(_this.getHiddenVariantId()){_this.setVariantId(_this.getHiddenVariantId());_this.getVariantDom().trigger("change")}if(!_this.variantView.initialized()){_this.initializeVariantView()}_this.renderShowrooms(_this.getVariantIdWithCheapest())})};PriceQuotesView.prototype.updateVariantView=function(){if(!this.variantView.initialized()){this.initializeVariantView()}this.variantView.renderVariant(this.getVariantIdWithCheapest(),this.getCityId(),this.getVariantContainer())};PriceQuotesView.prototype.updateLocationOrPostcodeSearchCity=function(cityId){this.getEditLocationOrPostcodeField().val("");this.getEditLocationOrPostcodeField().data("filter-city-id",cityId)};PriceQuotesView.prototype.initializeVariantView=function(){var _this=this;var $variants=this.getVariantDom().find("option");var variantIds=[];$variants.each(function(index,option){var $variant=$(option);if($variant.val()){var key=[$variant.data("catalogPath"),$variant.data("brandPath"),$variant.data("modelPath"),$variant.data("variantPath")].join("|");variantIds.push(key)}});if(variantIds.length){this.dataProxy.loadPriceQuoteVariantData(this.getModelId(),variantIds).done(function(response){_this.variantView.initialize(response.data);_this.variantView.renderVariant(_this.getVariantIdWithCheapest(),_this.getCityId(),_this.getVariantContainer())})}};PriceQuotesView.prototype.getCheapestVariantId=function(){var $variants=this.getVariantDom().find('option:not([value=""])');var $cheapestVariant=$variants.first();$variants.each(function(index,option){var price=$(option).data("priceMin");if(price<$cheapestVariant.data("priceMin")){$cheapestVariant=$(option)}});return parseInt($cheapestVariant.val())};PriceQuotesView.prototype.renderVariants=function(variants){var $variantsDom=this.getVariantDom();$variantsDom.attr("disabled","disabled");$variantsDom.find("option").detach();var $option=$("<option>Select Variant</option>");$option.attr("value","");$option.attr("data-price-min","");$variantsDom.append($option);for(var i in variants){var variant=variants[i];if(this.variantsWithPrice.indexOf(variant.id)==-1){continue}var $option_1=$("<option></option>");$option_1.text(variant.name+" ("+variant.fuel_type+")");$option_1.attr("value",variant.id);$option_1.attr("data-price-min",variant.min);$option_1.data("name",variant.name);$option_1.data("catalogPath",variant.catalog_path);$option_1.data("brandPath",variant.brand_path);$option_1.data("modelPath",variant.model_path);$option_1.data("variantPath",variant.variant_path);$variantsDom.append($option_1)}$variantsDom.removeAttr("disabled")};PriceQuotesView.prototype.beforeNextStep=function(callback){this._beforeNextStep.add(callback)};PriceQuotesView.prototype.beforeClose=function(callback){this._beforeClose.add(callback)};PriceQuotesView.prototype.beforeEditLocation=function(callback){this._beforeEditLocation.add(callback)};PriceQuotesView.prototype.beforeEditLocationExit=function(callback){this._beforeEditLocationExit.add(callback)};PriceQuotesView.prototype.find=function(selector){return this.$form.find(selector)};PriceQuotesView.prototype.getNextStepButtons=function(){return this.$form.find("[data-set-step]")};PriceQuotesView.prototype.getCloseButtons=function(){return $('[data-price-quote="closeButton"]')};PriceQuotesView.prototype.getBackButton=function(){return $('[data-price-quote="backButton"]')};PriceQuotesView.prototype.getPersonalDetailsBackButton=function(){return $('[data-header="personal-details"] [data-price-quote="closeButton"]')};PriceQuotesView.prototype.getPersonalDetailsBackToMainViewButton=function(){return $('[data-header="personal-details"] [data-price-quote="backToMainViewButton"]')};PriceQuotesView.prototype.goToStep=function(step){if(step!=="city-choice"){this.getVariantContainer().removeClass("d_n");this.updateVariants()}this.$form.find("[data-step]").addClass("d_n");var $step=this.$form.find('[data-step="'+step+'"]');$step.removeClass("d_n");this.nextStep=$step.find("[data-set-step]").data("set-step")};PriceQuotesView.prototype.addShowrooms=function(showrooms){this.showrooms=showrooms};PriceQuotesView.prototype.renderShowrooms=function(variantId){this.removeShowrooms();if(!variantId){if(this.getHiddenVariantId()){variantId=this.getHiddenVariantId()}else{variantId=this.getVariantIdWithCheapest()}}$("#template-showroom").tmpl({showrooms:this.prepareShowroomData(variantId)}).appendTo(this.getShowroomsDom());this.addShowroomDomClickEventListener();this.purchasePeriodChangeEventListener()};PriceQuotesView.prototype.prepareShowroomData=function(variantId){var templateData=[];$.each(this.showrooms,function(index,showroom){if(!showroom.onRoadPrices.hasOwnProperty(variantId)){return true}var spoc=showroom.spocs[0];templateData.push({showroomId:showroom.id,showroomName:showroom.name,localityName:showroom.localityName,cityName:showroom.cityName,variantFormattedPrice:Helper.Price.formatCrLac(showroom.onRoadPrices[variantId]),isExpiryPrice:showroom.isExpiry,spocName:spoc.name,spocImage:spoc.image,spocPhone:spoc.phone,distance:showroom.distance})});return templateData};PriceQuotesView.prototype.removeShowrooms=function(){this.getShowroomsDom().html("")};PriceQuotesView.prototype.setThanksMessage=function(){var $headerDom=this.getForm().find('[data-header="thanks-step"]');$headerDom.html("");$("#template-ty-message").tmpl({userName:this.getUserName(),showroomsCount:this.getShowrooms().length}).appendTo($headerDom)};PriceQuotesView.prototype.setDealersMessage=function(){var userName=this.getUserName();$('[data-type="userName"]').html(userName)};PriceQuotesView.prototype.resetHiddenData=function(){this.setLeadId(null);this.setStateId(null);this.setCityId(null);this.setCityPath(null);this.setLocalityId(null);this.setPostcode(null);this.getShowroomsDom().empty()};PriceQuotesView.prototype.isModelChanged=function(){return!!this.getModelIdDom().attr("data-is-changed")};PriceQuotesView.prototype.setModelChanged=function(status){if(!status){this.getModelIdDom().removeAttr("data-is-changed")}else{this.getModelIdDom().attr("data-is-changed",status)}};PriceQuotesView.prototype.getSorryPopupGopButton=function(){return $('[data-price-quotes="gop-button"]')};PriceQuotesView.prototype.getUserName=function(){return this.getUserNameDom().val()};PriceQuotesView.prototype.setUserName=function(value){return this.getUserNameDom().val(value)};PriceQuotesView.prototype.getUserNameDom=function(){return this.$form.find('[name="price_quotes_type[name]"]')};PriceQuotesView.prototype.getEditCityDom=function(){return this.$form.find("[data-edit-city]")};PriceQuotesView.prototype.getUserEmail=function(){return this.getUserEmailDom().val()};PriceQuotesView.prototype.setUserEmail=function(mail){return this.getUserEmailDom().val(mail)};PriceQuotesView.prototype.getUserEmailDom=function(){return this.$form.find('[name="price_quotes_type[email]"]')};PriceQuotesView.prototype.getUserPhone=function(){return this.getUserPhoneDom().val()};PriceQuotesView.prototype.setUserPhone=function($phone){this.getUserPhoneDom().val($phone)};PriceQuotesView.prototype.getUserPhoneDom=function(){var visiblePhone=this.$form.find('[name="price_quotes_type[phone]"]:visible');if(visiblePhone.length){return visiblePhone}else{return this.$form.find('[name="price_quotes_type[phone]"]:eq(0)')}};PriceQuotesView.prototype.getHiddenUserPhoneDom=function(){return this.$form.find('[name="price_quotes_type[phone]"]:hidden')};PriceQuotesView.prototype.disableUserPhone=function(){this.getUserPhoneDom().prop("disabled",true)};PriceQuotesView.prototype.enableUserPhone=function(){this.getUserPhoneDom().prop("disabled",false)};PriceQuotesView.prototype.enableNextStep=function(){this.getNextStepButtons().removeClass("disabled")};PriceQuotesView.prototype.hideContinueButton=function(){this.$form.find('[data-set-step="dealers"]').hide()};PriceQuotesView.prototype.showContinueButton=function(){this.$form.find('[data-set-step="dealers"]').show()};PriceQuotesView.prototype.disableNextStep=function(){this.getNextStepButtons().addClass("disabled")};PriceQuotesView.prototype.setModelId=function(modelId){this.getModelIdDom().val(modelId)};PriceQuotesView.prototype.getModelId=function(){return parseInt(this.getModelIdDom().val())};PriceQuotesView.prototype.getModelIdDom=function(){return this.$form.find('[data-price-quotes="modelId"]')};PriceQuotesView.prototype.setModelPath=function(modelPath){this.getModelPathDom().val(modelPath)};PriceQuotesView.prototype.getModelPath=function(){return this.getModelPathDom().val()};PriceQuotesView.prototype.getModelPathDom=function(){return this.$form.find('[data-price-quotes="modelPath"]')};PriceQuotesView.prototype.setBrandPath=function(brandPath){this.getBrandPathDom().val(brandPath)};PriceQuotesView.prototype.getBrandPath=function(){return this.getBrandPathDom().val()};PriceQuotesView.prototype.getBrandPathDom=function(){return this.$form.find('[data-price-quotes="brandPath"]')};PriceQuotesView.prototype.setCityPath=function(cityPath){this.getCityPathDom().val(cityPath)};PriceQuotesView.prototype.getCityPath=function(){return this.getCityPathDom().val()};PriceQuotesView.prototype.getCityPathDom=function(){return this.$form.find('[data-price-quotes="cityPath"]')};PriceQuotesView.prototype.setCityName=function(cityName){this.getCityNameDom().html(cityName)};PriceQuotesView.prototype.getCityName=function(){return this.getCityNameDom().html()};PriceQuotesView.prototype.getCityNameDom=function(){return $('[data-price-quotes="city"]')};PriceQuotesView.prototype.getBrandId=function(){return this.getBrandIdDom().val()};PriceQuotesView.prototype.getBrandIdDom=function(){return this.$form.find('[data-price-quotes="brandId"]')};PriceQuotesView.prototype.getVariantId=function(){return this.getVariantDom().find(":selected").val()};PriceQuotesView.prototype.setVariantId=function(id){this.getVariantDom().val(id)};PriceQuotesView.prototype.getVariantDom=function(){return this.$form.find('[data-price-quotes="variant"]')};PriceQuotesView.prototype.getPartnerId=function(){return this.$form.find('[data-price-quotes="partnerId"]').val()};PriceQuotesView.prototype.getStateId=function(){return this.getStateDom().val()};PriceQuotesView.prototype.setStateId=function(id){this.getStateDom().val(id)};PriceQuotesView.prototype.getStateDom=function(){return this.$form.find('[data-price-quotes="stateId"]')};PriceQuotesView.prototype.getCityId=function(){return this.getCityDom().val()};PriceQuotesView.prototype.setCityId=function(id){this.getCityDom().val(id)};PriceQuotesView.prototype.getCityDom=function(){return this.$form.find('[data-price-quotes="cityId"]')};PriceQuotesView.prototype.getLocalityId=function(){return this.getLocalityDom().val()};PriceQuotesView.prototype.setLocalityId=function(id){this.getLocalityDom().val(id)};PriceQuotesView.prototype.getCityTitle=function(){return this.getCityTitleDom().html()};PriceQuotesView.prototype.setLocalityTitle=function(localityTitle){this.getCityTitleDom().html(localityTitle)};PriceQuotesView.prototype.getLocalityDom=function(){return this.$form.find('[data-price-quotes="localityId"]')};PriceQuotesView.prototype.getCityTitleDom=function(){return this.$form.find('[data-price-quotes="localityTitle"]')};PriceQuotesView.prototype.getPostcode=function(){return this.getPostcodeDom().val()};PriceQuotesView.prototype.setPostcode=function(id){this.getPostcodeDom().val(id)};PriceQuotesView.prototype.getPostcodeDom=function(){return this.$form.find('[data-price-quotes="postcode"]')};PriceQuotesView.prototype.getLeadId=function(){return this.getLeadDom().val()};PriceQuotesView.prototype.setLeadId=function(id){this.getLeadDom().val(id)};PriceQuotesView.prototype.getLeadDom=function(){return this.$form.find('[data-price-quotes="leadId"]')};PriceQuotesView.prototype.getPurchasePeriodDom=function(){return this.$form.find('[data-price-quotes="purchaseDate"]')};PriceQuotesView.prototype.getShowroomsSelectAllDom=function(){return this.$form.find("[data-select-all-showrooms]")};PriceQuotesView.prototype.getShowroomsInputDom=function(){return this.getShowroomsDom().find("input[type=checkbox]")};PriceQuotesView.prototype.getCheckedShowrooms=function(){return this.getShowroomsDom().find("input:checked")};PriceQuotesView.prototype.getShowroomsDom=function(){return this.$form.find('[data-price-quotes="showrooms"]')};PriceQuotesView.prototype.getMode=function(){return this.getModeDom().val()};PriceQuotesView.prototype.getModeDom=function(){return this.$form.find('[data-price-quotes="mode"]')};PriceQuotesView.prototype.getTrackeventCategory=function(){return this.getTrackeventCategoryDom().val()};PriceQuotesView.prototype.getTrackeventCategoryDom=function(){return this.$form.find('[data-price-quotes="trackeventCategory"]')};PriceQuotesView.prototype.getTrackeventLabel=function(){return this.getTrackeventLabelDom().val()};PriceQuotesView.prototype.getTrackeventLabelDom=function(){return this.$form.find('[data-price-quotes="trackeventLabel"]')};PriceQuotesView.prototype.setHiddenVariantId=function(variantId){this.getForm().find('[data-price-quotes="variantId"]').val(variantId)};PriceQuotesView.prototype.getHiddenVariantId=function(){return this.getForm().find('[data-price-quotes="variantId"]').val()};PriceQuotesView.prototype.enableFocusedCityEdit=function(){this.$form.find(""+'[data-price-quote-type="LocationBlock"],'+'[data-price-quote-type="MainDetails"],'+'[data-price-quote-type="SectionTitle"]').hide();this.getPersonalDetailsBackButton().hide();this.getPersonalDetailsBackToMainViewButton().show()};PriceQuotesView.prototype.disableFocusedCityEdit=function(){this.$form.find(""+'[data-price-quote-type="LocationBlock"],'+'[data-price-quote-type="MainDetails"],'+'[data-price-quote-type="SectionTitle"]').show();this.getPersonalDetailsBackButton().show();this.getPersonalDetailsBackToMainViewButton().hide()};PriceQuotesView.prototype.enableFocusedLocationEdit=function(){this.getEditLocalityTitleDom().show();this.getPersonalDetailsMainTitleDom().hide();this.getEditLocalityCityNameDom().html(this.getCityTitle());this.$form.find(""+'[data-price-quote-type="CityBlock"],'+'[data-price-quote-type="MainDetails"],'+'[data-price-quote-type="SectionTitle"]').hide();this.getPersonalDetailsBackButton().hide();this.getPersonalDetailsBackToMainViewButton().show()};PriceQuotesView.prototype.disableFocusedLocationEdit=function(){this.$form.find(""+'[data-price-quote-type="CityBlock"],'+'[data-price-quote-type="MainDetails"],'+'[data-price-quote-type="SectionTitle"]').show();this.getPersonalDetailsBackButton().show();this.getPersonalDetailsBackToMainViewButton().hide();this.getPersonalDetailsMainTitleDom().show();this.getEditLocalityTitleDom().hide()};PriceQuotesView.prototype.getStepDom=function(step){return this.$form.find("."+step+"")};PriceQuotesView.prototype.getSkipPhone=function(){return this.skipPhone};PriceQuotesView.prototype.getCurrentLocationBlock=function(){return this.$form.find('[data-price-quote="current-location"]')};PriceQuotesView.prototype.getEditLocationBlock=function(){return this.$form.find('[data-price-quote="edit-location"]')};PriceQuotesView.prototype.disablePersonalDetailsForm=function(){this.getUserNameDom().attr("disabled","disabled");this.getUserPhoneDom().attr("disabled","disabled");this.getUserEmailDom().attr("disabled","disabled");this.getVariantDom().attr("disabled","disabled");this.disableNextStep()};PriceQuotesView.prototype.enablePersonalDetailsFormMobile=function(){this.disableFocusedCityEdit();this.getEditCityTitleDom().hide();this.getPersonalDetailsMainTitleDom().show()};PriceQuotesView.prototype.enablePersonalDetailsForm=function(){this.getUserNameDom().removeAttr("disabled");this.getUserPhoneDom().removeAttr("disabled");this.getUserEmailDom().removeAttr("disabled");this.getVariantDom().removeAttr("disabled");this.enableNextStep()};PriceQuotesView.prototype.clearEditLocationFields=function(){this.getEditCityFieldDom().val("");this.getEditLocationOrPostcodeField().val("")};PriceQuotesView.prototype.getShowrooms=function(){var showrooms=[];this.getCheckedShowrooms().each(function(){var showroom=$(this).val();showrooms.push(showroom)});return showrooms};PriceQuotesView.prototype.getEditCityFieldDom=function(){return this.$form.find('[data-type="city-search-edit-field"]')};PriceQuotesView.prototype.getPersonalDetailsMainTitleDom=function(){return this.$form.find('[data-price-quote-type="MainTitle"]')};PriceQuotesView.prototype.getEditCityTitleDom=function(){return this.$form.find('[data-price-quote-type="EditCityTitle"]')};PriceQuotesView.prototype.getEditLocalityTitleDom=function(){return this.$form.find('[data-price-quote-type="EditLocalityTitle"]')};PriceQuotesView.prototype.getEditLocalityCityNameDom=function(){return this.$form.find('[data-price-quote-type="EditLocalityCityName"]')};PriceQuotesView.prototype.getEditLocationOrPostcodeField=function(){return this.$form.find('[data-type="location-or-postcode-search-edit-field"]')};PriceQuotesView.prototype.getChangePhoneDom=function(){return this.getForm().find("[data-phone-action-change]")};PriceQuotesView.prototype.getConfirmChangePhoneDom=function(){return this.getForm().find("[data-phone-action-ok]")};PriceQuotesView.prototype.getVariantIdWithCheapest=function(){var selectedVariantId=parseInt(this.getVariantId());return selectedVariantId?selectedVariantId:this.getCheapestVariantId()};PriceQuotesView.prototype.getPurchaseDate=function(){return this.getPurchasePeriodDom().val()};PriceQuotesView.prototype.isDealerChoosed=function(){var count=this.getCheckedShowrooms().length;var result=false;if(count>0){result=true}return result};PriceQuotesView.prototype.isAllDealersChoosed=function(){var selectedCount=this.getCheckedShowrooms().length;var allCount=this.getShowroomsInputDom().length;return selectedCount==allCount};PriceQuotesView.prototype.isNotAllDealersChoosed=function(){var selectedCount=this.getCheckedShowrooms().length;var allCount=this.getShowroomsInputDom().length;return selectedCount<allCount};PriceQuotesView.prototype.updateSelectedPhoneAtPresonalDetails=function(){this.getHiddenUserPhoneDom().val(this.getUserPhoneDom().val())};PriceQuotesView.prototype.addBackButtonListener=function(){var _this=this;this.getBackButton().on("click",function(event){if(event){event.preventDefault();_this.eventDispatcher.publish("priceQuote:BackButton:click",{event:event})}})};PriceQuotesView.prototype.addCityChangeListener=function(){var _this=this;this.getEditCityDom().on("click",function(event){if(event){event.preventDefault();_this.eventDispatcher.publish("priceQuote:editCity",{event:event})}})};PriceQuotesView.prototype.addLocationChangeListener=function(){var _this=this;this.getEditCityFieldDom().on("autoportal:location-search:selected",function(event){if(event){event.preventDefault();_this.updateLocationOrPostcodeSearchCity(Number(_this.getCityId()));_this._beforeEditLocation.fire(_this)}});this.getEditLocationOrPostcodeField().on("autoportal:location-search:selected",function(event){if(event){event.preventDefault();_this._beforeEditLocation.fire(_this);_this.disableFocusedLocationEdit()}});this.getEditLocationOrPostcodeField().on("click",function(event){if(event){event.preventDefault();_this.eventDispatcher.publish("priceQuote:editLocation",{event:event})}})};PriceQuotesView.prototype.addExitFromCityEditListeners=function(){var _this=this;$(document).on("keyup",function(event){if(event&&event.keyCode===27){_this._beforeEditLocationExit.fire(_this)}});this.getPersonalDetailsBackToMainViewButton().on("click",function(event){if(_this.getEditCityFieldDom().is(":visible")){_this._beforeEditLocationExit.fire(_this)}else{_this.disableFocusedLocationEdit()}})};return PriceQuotesView}(General.FormView);Forms.PriceQuotesView=PriceQuotesView})(Forms||(Forms={}));;
var Forms;(function(Forms){var PriceQuotesModel=function(){function PriceQuotesModel(view){this.view=view;this.lead=this.createLead()}PriceQuotesModel.prototype.getView=function(){return this.view};PriceQuotesModel.prototype.getLead=function(){return this.lead.build(this.view)};PriceQuotesModel.prototype.createLead=function(){return new Leads.PriceQuotesLead};return PriceQuotesModel}();Forms.PriceQuotesModel=PriceQuotesModel})(Forms||(Forms={}));;
var Forms;(function(Forms){var ColorEntity=function(){function ColorEntity(entityId){this.entityId=entityId}ColorEntity.prototype.getEntityId=function(){return this.entityId};ColorEntity.prototype.getHex=function(){return this.hex};ColorEntity.prototype.setHex=function(hex){this.hex=hex};ColorEntity.prototype.getImage=function(){return this.image};ColorEntity.prototype.setImage=function(image){this.image=image};ColorEntity.prototype.getMetallic=function(){return this.isMetallic};ColorEntity.prototype.setMetallic=function(isMetallic){this.isMetallic=isMetallic};ColorEntity.prototype.getModelId=function(){return this.modelId};ColorEntity.prototype.setModelId=function(modelId){this.modelId=modelId};ColorEntity.prototype.getPublished=function(){return this.published};ColorEntity.prototype.setPublished=function(published){this.published=published};ColorEntity.prototype.getTitle=function(){return this.title};ColorEntity.prototype.setTitle=function(title){this.title=title};ColorEntity.prototype.getVariantIds=function(){return this.variantIds};ColorEntity.prototype.setVariantIds=function(variantIds){this.variantIds=variantIds};return ColorEntity}();Forms.ColorEntity=ColorEntity;var VariantInfoEntity=function(){function VariantInfoEntity(){}VariantInfoEntity.prototype.getBrandName=function(){return this.brandName};VariantInfoEntity.prototype.setBrandName=function(value){this.brandName=value};VariantInfoEntity.prototype.getModelName=function(){return this.modelName};VariantInfoEntity.prototype.setModelName=function(value){this.modelName=value};VariantInfoEntity.prototype.getVariantName=function(){return this.variantName};VariantInfoEntity.prototype.setVariantName=function(value){this.variantName=value};VariantInfoEntity.prototype.getAvgRating=function(){return this.avgRating};VariantInfoEntity.prototype.setAvgRating=function(value){this.avgRating=value.toFixed(2)};VariantInfoEntity.prototype.getKeyFeatures=function(){return this.keyFeatures};VariantInfoEntity.prototype.setKeyFeatures=function(value){this.keyFeatures=value};VariantInfoEntity.prototype.getColors=function(){return this.colors};VariantInfoEntity.prototype.setColors=function(value){this.colors=value};VariantInfoEntity.prototype.getOffersWorth=function(){return this.offersWorth};VariantInfoEntity.prototype.setOffersWorth=function(offersWorth){this.offersWorth=offersWorth};return VariantInfoEntity}();Forms.VariantInfoEntity=VariantInfoEntity;var ViewState;(function(ViewState){ViewState[ViewState["Ready"]=0]="Ready";ViewState[ViewState["Initialized"]=1]="Initialized"})(ViewState||(ViewState={}));var VariantView=function(){function VariantView(parentView){this.parentView=parentView;this.$template=$("#template-variant-data");this.$templateLoader=$("[data-variant-loader]");this.collection=new Core.Collection;this.setState(ViewState[ViewState.Ready])}VariantView.prototype.getState=function(){return this.state};VariantView.prototype.initialized=function(){return this.getState()===ViewState[ViewState.Initialized]};VariantView.prototype.setState=function(state){this.state=state};VariantView.prototype.destroy=function(){this.removeContent();this.setState(ViewState[ViewState.Ready])};VariantView.prototype.removeContent=function(){this.getVariantContentBlock().remove()};VariantView.prototype.initialize=function(variantInfo){this.fillCollection(variantInfo);this.setState(ViewState[ViewState.Initialized])};VariantView.prototype.renderVariant=function(variantId,cityId,$target){this.removeContent();this.renderTemplate({variantInfoEntity:this.getInfo(variantId),cityId:cityId},$target);this.initializeColorsGallery()};VariantView.prototype.getVariantContentBlock=function(){return this.parentView.getForm().find("[data-pq-variant-content]")};VariantView.prototype.getVariantGalleryBlock=function(){return this.parentView.getForm().find("[data-pq-variant-gallery]")};VariantView.prototype.renderTemplate=function(templateVars,$target){this.getTemplateLoader().remove();this.getTemplate().tmpl(templateVars).appendTo($target)};VariantView.prototype.initializeColorsGallery=function(){new ColorsGallery(this.getVariantGalleryBlock()).init()};VariantView.prototype.fillCollection=function(data){var _this=this;$.each(data,function(variantId,info){var entity=new VariantInfoEntity;entity.setBrandName(info.brandName);entity.setModelName(info.modelName);entity.setVariantName(info.variantName);entity.setAvgRating(info.avgRating);entity.setKeyFeatures(info.keyFeatures);var colors=new Core.Collection;if(!(info.colors instanceof Array)){$.each(info.colors,function(colorId,colorData){var color=new ColorEntity(colorData.entityId);color.setHex(colorData.hex);color.setImage(colorData.image);color.setMetallic(colorData.metallic);color.setModelId(colorData.modelId);color.setPublished(colorData.published);color.setTitle(colorData.title);color.setVariantIds(colorData.variantIds);colors.set(colorData.entityId,color)})}entity.setColors(colors);var offersWorth=new Core.Collection;if(!(info.offers instanceof Array)){$.each(info.offers,function(offerId,offerData){offersWorth.set(offerData.cityId,offerData.worth)})}entity.setOffersWorth(offersWorth);_this.getCollection().set(variantId,entity)})};VariantView.prototype.getInfo=function(variantId){if(!this.getCollection().containsKey(variantId)){throw new Error("Variant id does not exists.")}return this.getCollection().get(variantId)};VariantView.prototype.getCollection=function(){return this.collection};VariantView.prototype.getTemplate=function(){return this.$template};VariantView.prototype.getTemplateLoader=function(){return this.$templateLoader};return VariantView}();Forms.VariantView=VariantView})(Forms||(Forms={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var PriceQuotes;(function(PriceQuotes){var SmsVerifyStatus;(function(SmsVerifyStatus){SmsVerifyStatus[SmsVerifyStatus["Verified"]=0]="Verified";SmsVerifyStatus[SmsVerifyStatus["NotVerified"]=1]="NotVerified"})(SmsVerifyStatus||(SmsVerifyStatus={}));var SmsVerification=function(_super){__extends(SmsVerification,_super);function SmsVerification(container){var _this=_super.call(this,container)||this;_this._onSkip=$.Callbacks();_this.onShow(function(){_this.opened=true});_this.onHide(function(){_this.opened=false});return _this}SmsVerification.prototype.isOpened=function(){return this.opened};SmsVerification.prototype.reset=function(){_super.prototype.resetForm.call(this);this.resetElements()};SmsVerification.prototype.buildData=function(){return{phone:this.phone,code:this.getVerificationCodeElement().val()}};SmsVerification.prototype.init=function(config){var _this=this;_super.prototype.init.call(this,config);this.getResetButton().on("click",function(){_this.resetElements()});this.eventDispatcher.subscribe("priceQuote:confirmPhone",function(e){var phone=e.getData().phone;_this.getPhoneNoInputElement().val(phone);_this.getSavePhoneElement().trigger("click");_this.resetElements()});this.getSmsCodeDom().on("keyup",function(){if(_this.getSmsCodeDom().val().length===4){_this.getSubmitElement().trigger("click")}})};SmsVerification.prototype.resetElements=function(){this.getSmsCodeDom().closest("[data-code-wrapper]").removeClass("varified").removeClass("cancellation");this.getDefaultTextDom().removeClass("d_n");this.getOtpErrorDom().addClass("d_n");this.getSuccessTextDom().addClass("d_n");this.getResendElement().show();this.getSmsCodeDom().val("")};SmsVerification.prototype.onSubmitCallback=function(data){this.eventDispatcher.publish(this.getEventKeyByName("smsSent"));this.currentValidateCodeResult=data;if(typeof data!=="undefined"){if(data.status==="verified"){if(data.result==="ok"){this.eventDispatcher.publish(this.getEventKeyByName("success"))}else{this.eventDispatcher.publish(this.getEventKeyByName("response"))}}else{this.eventDispatcher.publish(this.getEventKeyByName("fail"))}}};SmsVerification.prototype.updateByDataSet=function(dataset){this.getChangePhoneElement().attr("data-trackevent-label",dataset.title)};SmsVerification.prototype.getSubmitElement=function(){return this.$form.find('[data-action="submitVerifyCode"]')};SmsVerification.prototype.getResendElement=function(){return this.$form.find('[data-action="resendVerifyCode"]')};SmsVerification.prototype.getChangePhoneElement=function(){return this.$form.find('[data-action="changePhone"]')};SmsVerification.prototype.getSavePhoneElement=function(){return this.$form.find('[data-action="changePhoneConfirm"]')};SmsVerification.prototype.getPhoneNoInputElement=function(){return this.$form.find('[data-field="verificationPhoneNumber"]')};SmsVerification.prototype.getSkipNotificationElement=function(){return this.$form.find('[data-action="resendSkip"]')};SmsVerification.prototype.getVerifyPhoneNoElement=function(){return this.$form.find('[data-field="verificationUserPhone"]')};SmsVerification.prototype.getSkipLinkElement=function(){return this.$form.find('[data-field="skipVerificationUserPhone"]')};SmsVerification.prototype.onSkip=function(callback){this._onSkip.add(callback)};SmsVerification.prototype.onSkipLink=function(){this._onSkip.fire()};SmsVerification.prototype.showElements=function(smsVerifyStatus){if(smsVerifyStatus===SmsVerifyStatus[SmsVerifyStatus.Verified]){this.getSmsCodeDom().closest("[data-code-wrapper]").addClass("varified").removeClass("cancellation");this.getDefaultTextDom().addClass("d_n");this.getOtpErrorDom().addClass("d_n");this.getSuccessTextDom().removeClass("d_n");this.getResendElement().hide()}else if(smsVerifyStatus===SmsVerifyStatus[SmsVerifyStatus.NotVerified]){this.getSmsCodeDom().closest("[data-code-wrapper]").removeClass("varified").addClass("cancellation");this.getDefaultTextDom().addClass("d_n");this.getOtpErrorDom().removeClass("d_n");this.getSuccessTextDom().addClass("d_n");this.getResendElement().show()}};SmsVerification.prototype.getDefaultTextDom=function(){return this.$form.find("[data-didnt-receive-sms]")};SmsVerification.prototype.getOtpErrorDom=function(){return this.$form.find('[data-action="invalidOtp"]')};SmsVerification.prototype.getSuccessTextDom=function(){return this.$form.find("[data-success-text]")};SmsVerification.prototype.getSmsCodeDom=function(){return this.$form.find('[name="code"]')};SmsVerification.prototype.getResetButton=function(){return this.$form.find("[data-reset-smsverify]")};return SmsVerification}(Form.AbstractSmsVerifyForm);PriceQuotes.SmsVerification=SmsVerification})(PriceQuotes||(PriceQuotes={}));;
var Services;(function(Services){var PriceQuoteDataService=function(){function PriceQuoteDataService(storage){this.storage=storage}PriceQuoteDataService.prototype.getCityId=function(){return this.storage.get("cityId")};PriceQuoteDataService.prototype.setCityId=function(value){this.storage.set("cityId",value)};PriceQuoteDataService.prototype.getCityPath=function(){return this.storage.get("cityPath")};PriceQuoteDataService.prototype.setCityPath=function(value){this.storage.set("cityPath",value)};PriceQuoteDataService.prototype.getCityName=function(){return this.storage.get("cityName")};PriceQuoteDataService.prototype.setCityName=function(value){this.storage.set("cityName",value)};PriceQuoteDataService.prototype.getStateId=function(){return this.storage.get("stateId")};PriceQuoteDataService.prototype.setStateId=function(value){this.storage.set("stateId",value)};PriceQuoteDataService.prototype.getPostcode=function(){return this.storage.get("postcode")};PriceQuoteDataService.prototype.setPostcode=function(value){this.storage.set("postcode",value)};PriceQuoteDataService.prototype.getLocalityId=function(){return this.storage.get("localityId")};PriceQuoteDataService.prototype.setLocalityId=function(value){this.storage.set("localityId",value)};PriceQuoteDataService.prototype.getLocalityTitle=function(){return this.storage.get("localityTitle")};PriceQuoteDataService.prototype.setLocalityTitle=function(value){this.storage.set("localityTitle",value)};return PriceQuoteDataService}();Services.PriceQuoteDataService=PriceQuoteDataService})(Services||(Services={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Leads;(function(Leads){var PriceQuotesLead=function(_super){__extends(PriceQuotesLead,_super);function PriceQuotesLead(){return _super!==null&&_super.apply(this,arguments)||this}PriceQuotesLead.prototype.build=function(view){return{name:""+view.getUserName(),email:""+view.getUserEmail(),phone:""+view.getUserPhone(),model_id:""+view.getModelId(),brand_id:""+view.getBrandId(),variant_id:""+view.getVariantId(),partner_id:""+view.getPartnerId(),city_id:""+view.getCityId(),state_id:""+view.getStateId(),locality_id:""+view.getLocalityId(),postcode:""+view.getPostcode(),lead_id:""+view.getLeadId(),skip_phone:""+view.getSkipPhone(),showrooms:view.getShowrooms(),mode:view.getMode(),purchase_date:view.getPurchaseDate()}};return PriceQuotesLead}(Leads.Lead);Leads.PriceQuotesLead=PriceQuotesLead})(Leads||(Leads={}));;
var AP=AP||{};AP.cmd=AP.cmd||[];AP.cmd.push(function(container){$('[data-type="show-review-popup"]').on("click",function(e){e.preventDefault();container.get("event_dispatcher").publish("reviewPopup:open",this.dataset)})});;
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?"":e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!"".replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return"\\w+"};c=1}while(c--)if(k[c])p=p.replace(new RegExp("\\b"+e(c)+"\\b","g"),k[c]);return p}(";5(1W.1C)(8($){5((!$.1s.1V&&!$.1s.1U))2d{1j.1X(\"1T\",C,s)}1R(e){};$.o.4=8(j){5(3.u==0)9 3;5(M V[0]=='1m'){5(3.u>1){7 k=V;9 3.18(8(){$.o.4.K($(3),k)})};$.o.4[V[0]].K(3,$.27(V).26(1)||[]);9 3};7 j=$.1b({},$.o.4.1w,j||{});$.o.4.P++;3.1y('.l-4-1g').p('l-4-1g').18(8(){7 b,m=$(3);7 c=(3.2g||'28-4').1f(/\\[|\\]/g,'Y').1f(/^\\Y+|\\Y+$/g,'');7 d=$(3.2h||1j.1H);7 e=d.6('4');5(!e||e.1o!=$.o.4.P)e={E:0,1o:$.o.4.P};7 f=e[c]||d.6('4'+c);5(f)b=f.6('4');5(f&&b)b.E++;R{b=$.1b({},j||{},($.1d?m.1d():($.25?m.6():w))||{},{E:0,L:[],v:[]});b.z=e.E++;f=$('<1G 13=\"l-4-1I\"/>');m.1J(f);f.p('4-12-11-10');5(m.Z('G')||m.14('G'))b.n=s;5(m.14('1c'))b.1c=s;f.1r(b.D=$('<W 13=\"4-D\"><a U=\"'+b.D+'\">'+b.1B+'</a></W>').q('1e',8(){$(3).4('N');$(3).p('l-4-T')}).q('1h',8(){$(3).4('x');$(3).I('l-4-T')}).q('1i',8(){$(3).4('y')}).6('4',b))};7 g=$('<W 20=\"21\" 22-24=\"'+3.U+'\" 13=\"l-4 t-'+b.z+'\"><a U=\"'+(3.U||3.1k)+'\">'+3.1k+'</a></W>');f.1r(g);5(3.X)g.Z('X',3.X);5(3.1x)g.p(3.1x);5(b.29)b.B=2;5(M b.B=='1l'&&b.B>0){7 h=($.o.15?g.15():0)||b.1n;7 i=(b.E%b.B),17=1K.1L(h/b.B);g.15(17).1M('a').1N({'1O-1P':'-'+(i*17)+'1Q'})};5(b.n)g.p('l-4-1p');R g.p('l-4-1S').q('1e',8(){$(3).4('1q');$(3).4('J')}).q('1h',8(){$(3).4('x');$(3).4('H')}).q('1i',8(){$(3).4('y')});5(3.S)b.r=g;5(3.1Y==\"A\"){5($(3).14('1Z'))b.r=g};m.1t();m.q('1u.4',8(a){5(a.1v)9 C;$(3).4('y')});g.6('4.m',m.6('4.l',g));b.L[b.L.u]=g[0];b.v[b.v.u]=m[0];b.t=e[c]=f;b.23=d;m.6('4',b);f.6('4',b);g.6('4',b);d.6('4',e);d.6('4'+c,f)});$('.4-12-11-10').4('x').I('4-12-11-10');9 3};$.1b($.o.4,{P:0,J:8(){7 a=3.6('4');5(!a)9 3;5(!a.J)9 3;7 b=$(3).6('4.m')||$(3.19=='1a'?3:w);5(a.J)a.J.K(b[0],[b.Q(),$('a',b.6('4.l'))[0]])},H:8(){7 a=3.6('4');5(!a)9 3;5(!a.H)9 3;7 b=$(3).6('4.m')||$(3.19=='1a'?3:w);5(a.H)a.H.K(b[0],[b.Q(),$('a',b.6('4.l'))[0]])},1q:8(){7 a=3.6('4');5(!a)9 3;5(a.n)9;3.4('N');3.1z().1A().O('.t-'+a.z).p('l-4-T')},N:8(){7 a=3.6('4');5(!a)9 3;5(a.n)9;a.t.2a().O('.t-'+a.z).I('l-4-q').I('l-4-T')},x:8(){7 a=3.6('4');5(!a)9 3;3.4('N');7 b=$(a.r);7 c=b.u?b.1z().1A().O('.t-'+a.z):w;5(c)c.p('l-4-q');a.D[a.n||a.1c?'1t':'2b']();3.2c()[a.n?'p':'I']('l-4-1p')},y:8(a,b){7 c=3.6('4');5(!c)9 3;5(c.n)9;c.r=w;5(M a!='F'||3.u>1){5(M a=='1l')9 $(c.L[a]).4('y',F,b);5(M a=='1m'){$.18(c.L,8(){5($(3).6('4.m').Q()==a)$(3).4('y',F,b)});9 3}}R{c.r=3[0].19=='1a'?3.6('4.l'):(3.2e('.t-'+c.z)?3:w)};3.6('4',c);3.4('x');7 d=$(c.r?c.r.6('4.m'):w);7 e=$(c.v).O(':S');7 f=$(c.v).1y(d);f.1D('S',C);d.1D('S',s);$(d.u?d:e).2f({1E:'1u',1v:s});5((b||b==F)&&c.1F)c.1F.K(d[0],[d.Q(),$('a',c.r)[0]]);9 3},n:8(a,b){7 c=3.6('4');5(!c)9 3;c.n=a||a==F?s:C;5(b)$(c.v).Z(\"G\",\"G\");R $(c.v).2i(\"G\");3.6('4',c);3.4('x')},2j:8(){3.4('n',s,s)},2k:8(){3.4('n',C,C)}});$.o.4.1w={D:'2l 2m',1B:'',B:0,1n:16};$(8(){$('m[1E=2n].l').4()})})(1C);",62,148,"|||this|rating|if|data|var|function|return||||||||||||star|input|readOnly|fn|addClass|on|current|true|rater|length|inputs|null|draw|select|serial||split|false|cancel|count|undefined|disabled|blur|removeClass|focus|apply|stars|typeof|drain|filter|calls|val|else|checked|hover|title|arguments|div|id|_|attr|drawn|be|to|class|hasClass|width||spw|each|tagName|INPUT|extend|required|metadata|mouseover|replace|applied|mouseout|click|document|value|number|string|starWidth|call|readonly|fill|append|support|hide|change|selfTriggered|options|className|not|prevAll|addBack|cancelValue|jQuery|prop|type|callback|span|body|control|before|Math|floor|find|css|margin|left|px|catch|live|BackgroundImageCache|style|opacity|window|execCommand|nodeName|selected|role|text|aria|context|label|meta|slice|makeArray|unnamed|half|children|show|siblings|try|is|trigger|name|form|removeAttr|disable|enable|Cancel|Rating|radio".split("|"),0,{}));;
var Reviews;(function(Reviews){var ReviewController=function(){function ReviewController(popup,userInfoService,$successBlock){this.popup=popup;this.userInfoService=userInfoService;this.view=new Reviews.ReviewView(this.popup,$successBlock);this.validator=new Reviews.ReviewValidator(this.view);this.validator.init();this.init()}ReviewController.prototype.updateByDataSet=function(dataset){if(dataset.hasOwnProperty("variantId")){this.view.setVariant(parseInt(dataset["variantId"]))}};ReviewController.prototype.init=function(){this.handleValidation();this.addListeners();this.handleView()};ReviewController.prototype.handleView=function(){this.view.setUserEmail(this.userInfoService.getEmail());this.view.setUserName(this.userInfoService.getName())};ReviewController.prototype.handleValidation=function(){var _this=this;this.validator.onFormValid(function(){_this.view.enableSubmit()});this.validator.onFormInvalid(function(){_this.view.disableSubmit()})};ReviewController.prototype.addListeners=function(){var _this=this;this.view.getForm().on("submit",function(e){_this.onSubmit(e)});this.popup.onOpen(function(){_this.handleView()})};ReviewController.prototype.onSubmit=function(e){var _this=this;e.preventDefault();if(!this.validator.validate()){return}this.view.disableSubmit();var action=this.view.getAction();$.post(action,this.view.getForm().serialize()).success(function(response){_this.handleResponse(response)})};ReviewController.prototype.handleResponse=function(response){var errors=response.errors,data=response.data;if(errors){alert(errors.join(", "))}else{this.saveUserInfo();this.view.renderSuccess(data);this.popup.setVerification(Popup.IgnoreCloseVerification.IGNORE);this.popup.close();this.view.reset()}};ReviewController.prototype.saveUserInfo=function(){this.userInfoService.setEmail(this.view.getUserEmail());this.userInfoService.setName(this.view.getUserName());this.userInfoService.saveClientId()};return ReviewController}();Reviews.ReviewController=ReviewController})(Reviews||(Reviews={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Reviews;(function(Reviews){var ReviewValidator=function(_super){__extends(ReviewValidator,_super);function ReviewValidator(){return _super!==null&&_super.apply(this,arguments)||this}ReviewValidator.prototype.getRules=function(){return{"review_frontend_type[userEmail]":{email:true,required:true},"review_frontend_type[userName]":{autoportalName:true,required:true},"review_frontend_type[comment]":{required:true,messageText:true},"review_frontend_type[positive]":{messageText:true},"review_frontend_type[negative]":{messageText:true},"review_frontend_type[title]":{required:true,messageText:true},"review_frontend_type[year]":{required:true},"review_frontend_type[variant]":{required:true},"review_frontend_type[gear]":{required:true},"review_frontend_type[comfort]":{required:true},"review_frontend_type[appear]":{required:true},"review_frontend_type[safety]":{required:true},"review_frontend_type[distance]":{required:true,digits:true,min:0,max:5e5}}};ReviewValidator.prototype.getMessages=function(){return{"review_frontend_type[userEmail]":{email:"Please, enter valid email",required:"Please, write your email"},"review_frontend_type[userName]":{autoportalName:"Please, enter valid name",required:"Please, write your name"},"review_frontend_type[comment]":{required:"Please, write your comments",messageText:"Please avoid special symbols in comments"},"review_frontend_type[positive]":{messageText:"Please avoid special symbols in comments"},"review_frontend_type[negative]":{messageText:"Please avoid special symbols in comments"},"review_frontend_type[title]":{required:"Please, write your title",messageText:"Please avoid special symbols in title"},"review_frontend_type[year]":"Please, add the year","review_frontend_type[gear]":"Rate interior","review_frontend_type[comfort]":"Rate comfort","review_frontend_type[appear]":"Rate exterior","review_frontend_type[safety]":"Rate safety","review_frontend_type[distance]":{required:"Please, enter kilometers",digits:"Kilometers can be a digits only",min:"Minimum value must be greater or equal 0",max:"Maximum value must be lesser than 500000"}}};ReviewValidator.prototype.getIgnore=function(){return[]};return ReviewValidator}(General.FormValidator);Reviews.ReviewValidator=ReviewValidator})(Reviews||(Reviews={}));;
var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var Reviews;(function(Reviews){var ReviewView=function(_super){__extends(ReviewView,_super);function ReviewView(popup,$successBlock){var _this=_super.call(this,popup.getForm())||this;_this.popup=popup;_this.$successBlock=$successBlock;_this.init();return _this}ReviewView.prototype.init=function(){var _this=this;this.getRatingFields().rating({callback:function(selection){$(this).valid()}});this.getVariantSelect().on("change",function(){_this.updatePopupTitle()})};ReviewView.prototype.getRatingFields=function(){return this.find("[name='review_frontend_type[safety]'], [name='review_frontend_type[appear]'], [name='review_frontend_type[comfort]'], [name='review_frontend_type[gear]']")};ReviewView.prototype.renderSuccess=function(content){var _this=this;this.$successBlock.html(content);this.$successBlock.fadeIn();setTimeout(function(){_this.$successBlock.fadeOut("slow")},5e3)};ReviewView.prototype.setVariant=function(variantId){this.setVariantId(variantId);this.updatePopupTitle()};ReviewView.prototype.getVariantSelect=function(){return this.find('[name="review_frontend_type[variant]"]')};ReviewView.prototype.setVariantId=function(id){this.getVariantSelect().val(id)};ReviewView.prototype.getVariantName=function(){return this.getVariantSelect().find("option:selected").text()};ReviewView.prototype.updatePopupTitle=function(){var variantName=this.getVariantName();this.getPopupVariantName().html(variantName)};ReviewView.prototype.getPopupVariantName=function(){return $(this.popup.getContainer()).find("[data-review-variant-name]")};ReviewView.prototype.getUserName=function(){return this.$form.find('[name="review_frontend_type[userName]"]').val()};ReviewView.prototype.getUserEmail=function(){return this.$form.find('[name="review_frontend_type[userEmail]"]').val()};ReviewView.prototype.setUserName=function(value){return this.$form.find('[name="review_frontend_type[userName]"]').val(value)};ReviewView.prototype.setUserEmail=function(value){return this.$form.find('[name="review_frontend_type[userEmail]"]').val(value)};return ReviewView}(General.FormView);Reviews.ReviewView=ReviewView})(Reviews||(Reviews={}));;